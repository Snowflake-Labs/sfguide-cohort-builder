gASV2x4AAAAAAAB9lCiMBG1haW6UfZSMB0hvbWUucHmUQhseAABpbXBvcnQgc3RyZWFtbGl0IGFz
IHN0CmZyb20gc25vd2ZsYWtlLnNub3dwYXJrIGltcG9ydCBTZXNzaW9uCmltcG9ydCBwYW5kYXMg
YXMgcGQKaW1wb3J0IG9zCgpkZWYgaW5pdGlhbGl6ZV9zZXNzaW9uX3N0YXRlKCk6CiAgICBzdC5z
ZXNzaW9uX3N0YXRlLmNhcmRfYmdfY29sb3IgPSAiI2VjZWZmMSIKICAgIHN0LnNlc3Npb25fc3Rh
dGUuaGVhZGVyX2JnX2NvbG9yID0gIiMzNzQ3NGYiCiAgICAKICAgIGlmICdidWlsZF9jb2hvcnRf
c2VsZWN0ZWRfdGFiJyBub3QgaW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNzaW9u
X3N0YXRlLmJ1aWxkX2NvaG9ydF9zZWxlY3RlZF90YWIgPSAxCiAgICAKICAgIGlmICdzZWxlY3Rl
ZF9kYXRhYmFzZScgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9z
dGF0ZS5zZWxlY3RlZF9kYXRhYmFzZSA9ICcnCiAgICBpZiAnc2VsZWN0ZWRfc2NoZW1hJyBub3Qg
aW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3Nj
aGVtYSA9ICcnCiAgICBpZiAnc2VsZWN0ZWRfdGFibGUnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRl
OgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFibGUgPSAnJwogICAgaWYgJ3By
ZXZfc2VsZWN0ZWRfZGF0YWJhc2UnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0
LnNlc3Npb25fc3RhdGUucHJldl9zZWxlY3RlZF9kYXRhYmFzZSA9ICcnCiAgICBpZiAncHJldl9z
ZWxlY3RlZF9zY2hlbWEnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Np
b25fc3RhdGUucHJldl9zZWxlY3RlZF9zY2hlbWEgPSAnJwogICAgaWYgJ3ByZXZfc2VsZWN0ZWRf
dGFibGUnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
cHJldl9zZWxlY3RlZF90YWJsZSA9ICcnCiAgICBpZiAndGFibGVfZGF0YScgbm90IGluIHN0LnNl
c3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS50YWJsZV9kYXRhID0gTm9uZQog
ICAgaWYgJ21ldGFkYXRhX3Jhdycgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YV9yYXcgPSBOb25lCiAgICBpZiAnZGF0YXNldCcgbm90IGlu
IHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5kYXRhc2V0ID0gTm9u
ZQogICAgaWYgJ3Jvd19jb3VudCcgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5yb3dfY291bnQgPSBOb25lCiAgICBpZiAndGFibGVfc2l6ZV9tYicgbm90
IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS50YWJsZV9zaXpl
X21iID0gTm9uZQogICAgaWYgJ2R5bmFtaWNfcm93X2NvdW50JyBub3QgaW4gc3Quc2Vzc2lvbl9z
dGF0ZToKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmR5bmFtaWNfcm93X2NvdW50ID0gTm9uZQog
ICAgaWYgJ3NhdmVfY2hhbmdlc19wcmVzc2VkJyBub3QgaW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAg
ICAgICBzdC5zZXNzaW9uX3N0YXRlLnNhdmVfY2hhbmdlc19wcmVzc2VkID0gRmFsc2UKICAgIGlm
ICdsbG1fZGF0YV9kaWN0JyBub3QgaW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNz
aW9uX3N0YXRlLmxsbV9kYXRhX2RpY3QgPSBGYWxzZQogICAgaWYgJ2lzX2NvaG9ydF9zYXZlZCcg
bm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5pc19jb2hv
cnRfc2F2ZWQgPSBGYWxzZQogICAgaWYgJ2V4cGFuZGVyX29wZW4nIG5vdCBpbiBzdC5zZXNzaW9u
X3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZXhwYW5kZXJfb3BlbiA9IFRydWUKICAg
IGlmICdwcm9jZXNzX21ldGFkYXRhX2NsaWNrZWQnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgog
ICAgICAgIHN0LnNlc3Npb25fc3RhdGUucHJvY2Vzc19tZXRhZGF0YV9jbGlja2VkID0gRmFsc2UK
ICAgIGlmICdtZXRhZGF0YScgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vz
c2lvbl9zdGF0ZS5tZXRhZGF0YSA9IE5vbmUKICAgIGlmICdwcmltYXJ5X2ZpbHRlcnNfZGYnIG5v
dCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV9m
aWx0ZXJzX2RmID0gTm9uZQogICAgaWYgJ3NlY29uZGFyeV9maWx0ZXJzX2RmJyBub3QgaW4gc3Qu
c2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJz
X2RmID0gTm9uZQogICAgaWYgJ2ZpbHRlcl92YWx1ZXMnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRl
OgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmlsdGVyX3ZhbHVlcyA9IHt9CiAgICBpZiAncHJp
bWFyeV93aGVyZV9jbGF1c2UnIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNl
c3Npb25fc3RhdGUucHJpbWFyeV93aGVyZV9jbGF1c2UgPSAnJwogICAgaWYgJ2ZpbmFsX3doZXJl
X2NsYXVzZScgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0
ZS5maW5hbF93aGVyZV9jbGF1c2UgPSAnJwogICAgaWYgJ3RleHRfZmlsdGVyX2NvbmRpdGlvbnMn
IG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUudGV4dF9m
aWx0ZXJfY29uZGl0aW9ucyA9IHt9CiAgICBpZiAnc2Vjb25kYXJ5X2ZpbHRlcl92YWx1ZXMnIG5v
dCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5
X2ZpbHRlcl92YWx1ZXMgPSB7fQogICAgaWYgJ2NvaG9ydF9yb3dfY291bnQnIG5vdCBpbiBzdC5z
ZXNzaW9uX3N0YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X3Jvd19jb3VudCA9
IE5vbmUKICAgIGlmICdiYXNlX2ZpbHRlcl9xdWVyeScgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6
CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5iYXNlX2ZpbHRlcl9xdWVyeSA9ICcnCiAgICBpZiAn
c2VsZWN0ZWRfdGFibGVfZnVsbCcgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF90YWJsZV9mdWxsID0gJycKICAgIGlmICdzYXZlX2NoYW5n
ZXNfcHJlc3NlZCcgbm90IGluIHN0LnNlc3Npb25fc3RhdGU6CiAgICAgICAgc3Quc2Vzc2lvbl9z
dGF0ZS5zYXZlX2NoYW5nZXNfcHJlc3NlZCA9ICcnCiAgICBpZiAnY29ob3J0X3F1ZXJ5JyBub3Qg
aW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmNvaG9ydF9xdWVy
eSA9ICcnCiAgICBpZiAnZmluYWxfcXVlcnknIG5vdCBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAg
ICAgIHN0LnNlc3Npb25fc3RhdGUuZmluYWxfcXVlcnkgPSAnJwogICAgaWYgJ2NvaG9ydF9uYW1l
JyBub3QgaW4gc3Quc2Vzc2lvbl9zdGF0ZToKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmNvaG9y
dF9uYW1lID0gJycKICAgIGlmICdwcmV2aWV3X2RhdGFzZXQnIG5vdCBpbiBzdC5zZXNzaW9uX3N0
YXRlOgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUucHJldmlld19kYXRhc2V0ID0gcGQuRGF0YUZy
YW1lKCkKCmNsYXNzIENvaG9ydEJ1aWxkZXI6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAg
ICAgIyBTZXQgdGhlIHBhZ2UgY29uZmlnIGluIHRoZSBjb25zdHJ1Y3RvciB0byBlbnN1cmUgaXQg
aXMgY2FsbGVkIG9ubHkgb25jZQogICAgICAgIHN0LnNldF9wYWdlX2NvbmZpZygKICAgICAgICAg
ICAgcGFnZV90aXRsZT0iSG9tZSBwYWdlIiwKICAgICAgICAgICAgcGFnZV9pY29uPSLwn4+gIiwK
ICAgICAgICAgICAgbGF5b3V0PSJ3aWRlIiwKICAgICAgICAgICAgaW5pdGlhbF9zaWRlYmFyX3N0
YXRlPSJleHBhbmRlZCIKICAgICAgICApCiAgICAKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAg
aW5pdGlhbGl6ZV9zZXNzaW9uX3N0YXRlKCkKICAgICAgICBzZWxmLmhvbWUoKQoKICAgIGRlZiBj
b25uZWN0X3RvX3Nub3dmbGFrZShzZWxmKToKICAgICAgICBpZiAnc2Vzc2lvbicgaW4gc3Quc2Vz
c2lvbl9zdGF0ZToKICAgICAgICAgICAgcmV0dXJuIHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbgog
ICAgICAgIHRyeToKICAgICAgICAgICAgc2Vzc2lvbiA9IFNlc3Npb24uYnVpbGRlci5nZXRPckNy
ZWF0ZSgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlMToKICAgICAgICAgICAgdHJ5Ogog
ICAgICAgICAgICAgICAgY29ubmVjdGlvbl9wYXJhbWV0ZXJzID0gZGljdChzdC5zZWNyZXRzWyJh
Y2NvdW50Il0pCiAgICAgICAgICAgICAgICBzZXNzaW9uID0gU2Vzc2lvbi5idWlsZGVyLmNvbmZp
Z3MoY29ubmVjdGlvbl9wYXJhbWV0ZXJzKS5jcmVhdGUoKQogICAgICAgICAgICBleGNlcHQgRXhj
ZXB0aW9uIGFzIGUyOgogICAgICAgICAgICAgICAgc3QuZXJyb3IoZiJGYWlsZWQgdG8gY29ubmVj
dCB0byBTbm93Zmxha2UuIEluaXRpYWwgZXJyb3I6IHtlMX0uIFNlY29uZGFyeSBlcnJvcjoge2Uy
fSIpCiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
c2Vzc2lvbiA9IHNlc3Npb24KICAgICAgICByZXR1cm4gc2Vzc2lvbgoKICAgIGRlZiBob21lKHNl
bGYpOgogICAgICAgIHdpdGggc3Quc3Bpbm5lcignQ29ubmVjdGluZyB0byBTbm93Zmxha2UuLi4n
KToKICAgICAgICAgICAgc2Vzc2lvbiA9IHNlbGYuY29ubmVjdF90b19zbm93Zmxha2UoKQogICAg
ICAgICAgICBpZiBzZXNzaW9uOgogICAgICAgICAgICAgICAgc3Quc3VjY2VzcygiQ29ubmVjdGVk
IHRvIFNub3dmbGFrZSBzdWNjZXNzZnVsbHkhIikKICAgICAgICAgICAgICAgIHNlbGYuaW50cm9k
dWN0aW9uKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHN0LmVycm9yKCJGYWls
ZWQgdG8gY29ubmVjdCB0byBTbm93Zmxha2UuIikKCiAgICBkZWYgaW50cm9kdWN0aW9uKHNlbGYp
OgoKICAgICAgICAjIFRpdGxlCiAgICAgICAgc3QudGl0bGUoIldlbGNvbWUgdG8gdGhlIENvaG9y
dCBNYW5hZ2VtZW50IEFwcCEg8J+SuyIpCgogICAgICAgICMgSW50cm9kdWN0aW9uCiAgICAgICAg
c3QubWFya2Rvd24oIiIiCiAgICAgICAgIyMgSG93IHRvIFVzZSBUaGlzIEFwcCDwn6eR4oCN8J+S
uwoKICAgICAgICBUaGlzIGFwcCBpcyBkZXNpZ25lZCB0byBoZWxwIHlvdSBtYW5hZ2UgY29ob3J0
cyBlZmZpY2llbnRseS4gWW91IGNhbiBidWlsZCBuZXcgY29ob3J0cywgdmlldyBleGlzdGluZyBv
bmVzLCBhbmQgc2NoZWR1bGUgdGhlbSBhcyBuZWVkZWQuIEhlcmXigJlzIGEgcXVpY2sgZ3VpZGUg
dG8gZ2V0IHlvdSBzdGFydGVkOgoKICAgICAgICAxLiAqKkJ1aWxkIENvaG9ydDoqKiBDcmVhdGUg
bmV3IGNvaG9ydHMgYnkgZGVmaW5pbmcgdGhlaXIgcGFyYW1ldGVycy4KICAgICAgICAyLiAqKkV4
aXN0aW5nIENvaG9ydHM6KiogVmlldyBhbmQgbWFuYWdlIGFsbCBleGlzdGluZyBjb2hvcnRzLgog
ICAgICAgIDMuICoqU2NoZWR1bGUgQ29ob3J0czoqKiBTZXQgdXAgc2NoZWR1bGVzIGZvciB5b3Vy
IGNvaG9ydHMgYmFzZWQgb24gdmFyaW91cyBjcml0ZXJpYS4KCiAgICAgICAgIyMjIE5hdmlnYXRp
b24g8J+Xuu+4jwogICAgICAgIFVzZSB0aGUgc2lkZWJhciBvbiB0aGUgbGVmdCB0byBuYXZpZ2F0
ZSBiZXR3ZWVuIGRpZmZlcmVudCBwYWdlcyBvZiB0aGUgYXBwLgogICAgICAgICIiIikKCiAgICAg
ICAgIyBTdW1tYXJ5IG9mIEVhY2ggUGFnZQogICAgICAgIHN0Lm1hcmtkb3duKCIiIgogICAgICAg
ICMjIFBhZ2UgU3VtbWFyaWVzIPCfk4QKCiAgICAgICAgIyMjIDEuIEJ1aWxkIENvaG9ydAogICAg
ICAgIE9uIHRoaXMgcGFnZSwgeW91IGNhbiBmb2xsb3cgdGhlc2UgZm91ciBzdGVwcyB0byBjcmVh
dGUgYW5kIG1hbmFnZSBjb2hvcnRzOgoKICAgICAgICAxLiAqKlNlbGVjdCBEYXRhc2V0OioqCiAg
ICAgICAgLSBDaG9vc2UgdGhlIGRhdGFiYXNlLCBzY2hlbWEsIGFuZCB0YWJsZSBmcm9tIHdoaWNo
IHRvIGJ1aWxkIHlvdXIgY29ob3J0LgogICAgICAgIC0gUmV0cmlldmUgYW5kIGRpc3BsYXkgdGFi
bGUgZGF0YSBmb3IgZnVydGhlciBwcm9jZXNzaW5nLgoKICAgICAgICAyLiAqKkRhdGEgRGljdGlv
bmFyeToqKgogICAgICAgIC0gUHJvY2VzcyBhbmQgZGlzcGxheSBtZXRhZGF0YSByZWxhdGVkIHRv
IHlvdXIgc2VsZWN0ZWQgZGF0YXNldC4KICAgICAgICAtIFVzZSBtZXRhZGF0YSB0byB1bmRlcnN0
YW5kIGFuZCByZWZpbmUgeW91ciBkYXRhc2V0IGZvciBjb2hvcnQgYnVpbGRpbmcuCgogICAgICAg
IDMuICoqQnVpbGQgQ29ob3J0OioqCiAgICAgICAgLSBBcHBseSBmaWx0ZXJzIGFuZCBjcml0ZXJp
YSB0byBjcmVhdGUgc3BlY2lmaWMgY29ob3J0cy4KICAgICAgICAtIFV0aWxpemUgbWV0YWRhdGEg
YW5kIHRhYmxlIGRhdGEgdG8gZGVmaW5lIHlvdXIgY29ob3J0cyBhY2N1cmF0ZWx5LgoKICAgICAg
ICA0LiAqKlNjaGVkdWxlIENvaG9ydDoqKgogICAgICAgIC0gKipTdG9yYWdlIE9wdGlvbnM6Kiog
Q2hvb3NlIGhvdyB0byBzdG9yZSB0aGUgY29ob3J0IGRhdGE6CiAgICAgICAgICAgIC0gKipEeW5h
bWljIFRhYmxlOioqIENvbnRpbnVvdXNseSB1cGRhdGVzIHdpdGggbmV3IGRhdGEuCiAgICAgICAg
ICAgIC0gKipTbmFwc2hvdCBUYWJsZToqKiBDYXB0dXJlcyBkYXRhIGF0IHNwZWNpZmljIGludGVy
dmFscy4KICAgICAgICAgICAgLSAqKk9uZS1UaW1lIFRhYmxlOioqIENhcHR1cmVzIGRhdGEgYXQg
YSBzaW5nbGUgcG9pbnQgaW4gdGltZS4KICAgICAgICAtICoqRHluYW1pYyBUYWJsZSBPcHRpb25z
OioqIERlZmluZSBwYXJhbWV0ZXJzIGxpa2UgbGFnIHRpbWUgYW5kIHJlZnJlc2ggbW9kZS4KICAg
ICAgICAtICoqU25hcHNob3QgVGFibGUgT3B0aW9uczoqKiBTZXQgdGhlIGNhZGVuY2UgKGRhaWx5
LCB3ZWVrbHksIG1vbnRobHkpIGZvciB1cGRhdGVzLgogICAgICAgIC0gKipPbmUtVGltZSBUYWJs
ZToqKiBDcmVhdGVzIGEgc3RhdGljIHRhYmxlIHdpdGggY3VycmVudCBkYXRhLgoKICAgICAgICAj
IyMgMi4gRXhpc3RpbmcgQ29ob3J0cwogICAgICAgIFRoaXMgc2VjdGlvbiBhbGxvd3MgeW91IHRv
OgogICAgICAgIC0gVmlldyBhIGNvbXByZWhlbnNpdmUgbGlzdCBvZiBhbGwgeW91ciBjb2hvcnRz
CiAgICAgICAgLSBFZGl0IGFuZCBtYW5hZ2UgY29ob3J0IGRldGFpbHMKCiAgICAgICAgSXQncyB5
b3VyIGdvLXRvIHBsYWNlIGZvciBtYWludGFpbmluZyBhbmQgdXBkYXRpbmcgdGhlIGNvaG9ydHMg
eW91J3ZlIGNyZWF0ZWQuCgogICAgICAgICMjIyAzLiBTY2hlZHVsZSBDb2hvcnRzCiAgICAgICAg
SGVyZSwgeW91IGNhbjoKICAgICAgICAtIFNjaGVkdWxlIHlvdXIgY29ob3J0cyBiYXNlZCBvbiBw
cmVkZWZpbmVkIGNyaXRlcmlhCiAgICAgICAgLSBFbnN1cmUgdGltZWx5IGFuZCB3ZWxsLW9yZ2Fu
aXplZCBjb2hvcnQgYWN0aXZpdGllcwoKICAgICAgICBUaGlzIHBhZ2UgaGVscHMgeW91IGtlZXAg
eW91ciBjb2hvcnRzIG9uIHRyYWNrIHdpdGggbWluaW1hbCBlZmZvcnQuCiAgICAgICAgIiIiKQoK
ICAgICAgICAjIEZvb3RlcgogICAgICAgIHN0Lm1hcmtkb3duKCIiIgogICAgICAgIC0tLQogICAg
ICAgIEhhcHB5IENvaG9ydGluZyEg8J+agAogICAgICAgICIiIikKCmlmIF9fbmFtZV9fID09ICJf
X21haW5fXyI6CiAgICBhcHAgPSBDb2hvcnRCdWlsZGVyKCkKICAgIGFwcC5ydW4oKQqUc4wEeWFt
bJR9lIwPZW52aXJvbm1lbnQueW1slENnbmFtZTogc2ZfZW52CmNoYW5uZWxzOgotIHNub3dmbGFr
ZQpkZXBlbmRlbmNpZXM6CiAgLSBzdHJlYW1saXQKICAtIHNjaWtpdC1sZWFybgogIC0gcGFuZGFz
CiAgLSBzcWxwYXJzZZRzjAVwYWdlc5R9lCiMD0J1aWxkX0NvaG9ydC5weZRCBT0BAGltcG9ydCBz
dHJlYW1saXQgYXMgc3QKaW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgbWF0aAppbXBvcnQgdGlt
ZQppbXBvcnQganNvbgppbXBvcnQgc3FscGFyc2UKCmRlZiByZWFkX3NxbChxdWVyeSwgc2Vzc2lv
biwgaW5kZXgpOgogICAgIiIiCiAgICBFeGVjdXRlIGEgU1FMIHF1ZXJ5IGFuZCByZXR1cm4gYSBz
cGVjaWZpYyBjb2x1bW4gZnJvbSB0aGUgcmVzdWx0LgoKICAgIFBhcmFtZXRlcnM6CiAgICBxdWVy
eSAoc3RyKTogVGhlIFNRTCBxdWVyeSB0byBiZSBleGVjdXRlZC4KICAgIHNlc3Npb24gKG9iamVj
dCk6IFRoZSBzZXNzaW9uIG9iamVjdCB0byBpbnRlcmFjdCB3aXRoIHRoZSBkYXRhYmFzZS4KICAg
IGluZGV4IChpbnQpOiBUaGUgaW5kZXggb2YgdGhlIGNvbHVtbiB0byBiZSByZXR1cm5lZCBmcm9t
IHRoZSBxdWVyeSByZXN1bHQuCgogICAgUmV0dXJuczoKICAgIGxpc3Q6IEEgbGlzdCBjb250YWlu
aW5nIHRoZSB2YWx1ZXMgb2YgdGhlIHNwZWNpZmllZCBjb2x1bW4gZnJvbSB0aGUgcXVlcnkgcmVz
dWx0LgogICAgIiIiCiAgICByZXN1bHQgPSBzZXNzaW9uLnNxbChxdWVyeSkuY29sbGVjdCgpCiAg
ICByZXR1cm4gW3Jvd1tpbmRleF0gZm9yIHJvdyBpbiByZXN1bHRdCgpkZWYgY2hlY2tfaGFzX2Rh
dGEodmFyaWFibGUpOgogICAgIiIiCiAgICBDaGVjayBpZiBhIHZhcmlhYmxlIGhhcyBkYXRhLCBp
LmUuLCBpdCBpcyBub3QgYW4gZW1wdHkgc3RyaW5nIGFuZCBub3QgTm9uZS4KCiAgICBQYXJhbWV0
ZXJzOgogICAgdmFyaWFibGU6IFRoZSB2YXJpYWJsZSB0byBjaGVjay4KCiAgICBSZXR1cm5zOgog
ICAgYm9vbDogVHJ1ZSBpZiB0aGUgdmFyaWFibGUgaGFzIGRhdGEgKGlzIG5vdCBhbiBlbXB0eSBz
dHJpbmcgYW5kIG5vdCBOb25lKSwgRmFsc2Ugb3RoZXJ3aXNlLgogICAgIiIiCiAgICByZXR1cm4g
dmFyaWFibGUgIT0gJycgYW5kIHZhcmlhYmxlIGlzIG5vdCBOb25lCgoKZGVmIHJlYWRfdGFibGUo
cXVlcnksIHNlc3Npb24pOgogICAgIiIiCiAgICBFeGVjdXRlIGEgU1FMIHF1ZXJ5IGFuZCByZXR1
cm4gdGhlIHJlc3VsdCBhcyBhIHBhbmRhcyBEYXRhRnJhbWUuCgogICAgUGFyYW1ldGVyczoKICAg
IHF1ZXJ5IChzdHIpOiBUaGUgU1FMIHF1ZXJ5IHRvIGJlIGV4ZWN1dGVkLgogICAgc2Vzc2lvbiAo
b2JqZWN0KTogVGhlIHNlc3Npb24gb2JqZWN0IHRvIGludGVyYWN0IHdpdGggdGhlIGRhdGFiYXNl
LgoKICAgIFJldHVybnM6CiAgICBwYW5kYXMuRGF0YUZyYW1lOiBUaGUgcXVlcnkgcmVzdWx0IGFz
IGEgcGFuZGFzIERhdGFGcmFtZS4KICAgICIiIgogICAgcmV0dXJuIHNlc3Npb24uc3FsKHF1ZXJ5
KS50b19wYW5kYXMoKQoKZGVmIGdldF9kYXRhYmFzZXMoc2Vzc2lvbik6CiAgICAiIiIKICAgIFJl
dHJpZXZlIHRoZSBsaXN0IG9mIGRhdGFiYXNlcyBmcm9tIHRoZSBzZXNzaW9uLgoKICAgIFBhcmFt
ZXRlcnM6CiAgICBzZXNzaW9uIChvYmplY3QpOiBUaGUgc2Vzc2lvbiBvYmplY3QgdG8gaW50ZXJh
Y3Qgd2l0aCB0aGUgZGF0YWJhc2UuCgogICAgUmV0dXJuczoKICAgIGxpc3Q6IEEgbGlzdCBvZiBk
YXRhYmFzZSBuYW1lcy4KICAgICIiIgogICAgcXVlcnkgPSAiU0hPVyBEQVRBQkFTRVMiCiAgICBy
ZXR1cm4gcmVhZF9zcWwocXVlcnksIHNlc3Npb24sIDEpCgpkZWYgZ2V0X3NjaGVtYXMoc2Vzc2lv
biwgZGF0YWJhc2UpOgogICAgIiIiCiAgICBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBzY2hlbWFzIHdp
dGhpbiBhIHNwZWNpZmljIGRhdGFiYXNlLgoKICAgIFBhcmFtZXRlcnM6CiAgICBzZXNzaW9uIChv
YmplY3QpOiBUaGUgc2Vzc2lvbiBvYmplY3QgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0YWJhc2Uu
CiAgICBkYXRhYmFzZSAoc3RyKTogVGhlIG5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIHJldHJpZXZl
IHNjaGVtYXMgZnJvbS4KCiAgICBSZXR1cm5zOgogICAgbGlzdDogQSBsaXN0IG9mIHNjaGVtYSBu
YW1lcyB3aXRoaW4gdGhlIHNwZWNpZmllZCBkYXRhYmFzZS4KICAgICIiIgogICAgcXVlcnkgPSBm
IlNIT1cgU0NIRU1BUyBJTiBEQVRBQkFTRSB7ZGF0YWJhc2V9IgogICAgcmV0dXJuIHJlYWRfc3Fs
KHF1ZXJ5LCBzZXNzaW9uLCAxKQoKZGVmIGNvbnZlcnRfdG9fa19tKHZhbHVlKToKICAgICIiIgog
ICAgQ29udmVydCBhIG51bWVyaWNhbCB2YWx1ZSBpbnRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9u
IHdpdGggJ0snIGZvciB0aG91c2FuZHMgYW5kICdNJyBmb3IgbWlsbGlvbnMuCgogICAgUGFyYW1l
dGVyczoKICAgIHZhbHVlIChpbnQgb3IgZmxvYXQpOiBUaGUgbnVtZXJpY2FsIHZhbHVlIHRvIGJl
IGNvbnZlcnRlZC4gQ2FuIGJlIE5vbmUuCgogICAgUmV0dXJuczoKICAgIHN0cjogVGhlIHZhbHVl
IGNvbnZlcnRlZCB0byBhIHN0cmluZyB3aXRoICdLJyBmb3IgdGhvdXNhbmRzIG9yICdNJyBmb3Ig
bWlsbGlvbnMuIElmIHRoZSB2YWx1ZSBpcyBOb25lLCByZXR1cm5zICdOL0EnLgogICAgIiIiCiAg
ICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgIHJldHVybiAnTi9BJwogICAgCiAgICBpZiB2YWx1
ZSA+PSAxXzAwMF8wMDA6CiAgICAgICAgIyBJZiB0aGUgdmFsdWUgaXMgMSwwMDAsMDAwIG9yIGdy
ZWF0ZXIsIGNvbnZlcnQgdG8gbWlsbGlvbnMgYW5kIGFwcGVuZCAnTScKICAgICAgICByZXR1cm4g
ZiJ7dmFsdWUgLyAxXzAwMF8wMDA6LjFmfU0iCiAgICBlbGlmIHZhbHVlID49IDFfMDAwOgogICAg
ICAgICMgSWYgdGhlIHZhbHVlIGlzIDEsMDAwIG9yIGdyZWF0ZXIsIGJ1dCBsZXNzIHRoYW4gMSww
MDAsMDAwLCBjb252ZXJ0IHRvIHRob3VzYW5kcyBhbmQgYXBwZW5kICdLJwogICAgICAgIHJldHVy
biBmInt2YWx1ZSAvIDFfMDAwOi4xZn1LIgogICAgZWxzZToKICAgICAgICAjIElmIHRoZSB2YWx1
ZSBpcyBsZXNzIHRoYW4gMSwwMDAsIHJldHVybiBpdCBhcyBhIHN0cmluZwogICAgICAgIHJldHVy
biBzdHIodmFsdWUpCiAgICAKZGVmIGdldF90YWJsZXMoc2Vzc2lvbiwgZGF0YWJhc2UsIHNjaGVt
YSk6CiAgICAiIiIKICAgIFJldHJpZXZlIHRoZSBsaXN0IG9mIHRhYmxlcyB3aXRoaW4gYSBzcGVj
aWZpYyBzY2hlbWEgb2YgYSBkYXRhYmFzZS4KCiAgICBQYXJhbWV0ZXJzOgogICAgc2Vzc2lvbiAo
b2JqZWN0KTogVGhlIHNlc3Npb24gb2JqZWN0IHVzZWQgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0
YWJhc2UuCiAgICBkYXRhYmFzZSAoc3RyKTogVGhlIG5hbWUgb2YgdGhlIGRhdGFiYXNlIGNvbnRh
aW5pbmcgdGhlIHNjaGVtYS4KICAgIHNjaGVtYSAoc3RyKTogVGhlIG5hbWUgb2YgdGhlIHNjaGVt
YSBmcm9tIHdoaWNoIHRvIHJldHJpZXZlIHRhYmxlcy4KCiAgICBSZXR1cm5zOgogICAgbGlzdDog
QSBsaXN0IG9mIHRhYmxlIG5hbWVzIHdpdGhpbiB0aGUgc3BlY2lmaWVkIHNjaGVtYS4KICAgICIi
IgogICAgIyBTUUwgcXVlcnkgdG8gc2hvdyBhbGwgdGFibGVzIGluIHRoZSBzcGVjaWZpZWQgc2No
ZW1hCiAgICBxdWVyeSA9IGYiIiIKICAgIFNFTEVDVCBUQUJMRV9OQU1FLCBUQUJMRV9UWVBFIEZS
T00ge2RhdGFiYXNlfS5JTkZPUk1BVElPTl9TQ0hFTUEuVEFCTEVTIFdIRVJFIFRBQkxFX1NDSEVN
QSA9ICd7c2NoZW1hfScKICAgICIiIgogICAgCiAgICAjIEV4ZWN1dGUgdGhlIHF1ZXJ5IGFuZCBy
ZXR1cm4gdGhlIGxpc3Qgb2YgdGFibGUgbmFtZXMgKGZpcnN0IGNvbHVtbiBpbiB0aGUgcmVzdWx0
KQogICAgcmV0dXJuIHJlYWRfc3FsKHF1ZXJ5LCBzZXNzaW9uLCAwKQoKZGVmIHJlc2V0X3Nlc3Np
b25fc3RhdGVfb25fc2VsZWN0aW9uX2NoYW5nZSgpOgogICAgIiIiCiAgICBSZXNldCBzZXNzaW9u
IHN0YXRlIHZhbHVlcyB3aGVuIHRoZSBzZWxlY3RlZCB0YWJsZSBjaGFuZ2VzLgogICAgIiIiCiAg
ICBrZXlzX3RvX3Jlc2V0ID0gWwogICAgICAgICd0YWJsZV9kYXRhJywgJ21ldGFkYXRhX3Jhdycs
ICdkYXRhc2V0JywgJ3Jvd19jb3VudCcsICd0YWJsZV9zaXplX21iJywKICAgICAgICAnZHluYW1p
Y19yb3dfY291bnQnLCAnbWV0YWRhdGEnLCAncHJpbWFyeV9maWx0ZXJzX2RmJywgJ3NlY29uZGFy
eV9maWx0ZXJzX2RmJywKICAgICAgICAnZmlsdGVyX3ZhbHVlcycsICdwcmltYXJ5X3doZXJlX2Ns
YXVzZScsICdmaW5hbF93aGVyZV9jbGF1c2UnLCAndGV4dF9maWx0ZXJfY29uZGl0aW9ucycsCiAg
ICAgICAgJ3NlY29uZGFyeV9maWx0ZXJfdmFsdWVzJywgJ2NvaG9ydF9yb3dfY291bnQnLCAnYmFz
ZV9maWx0ZXJfcXVlcnknLCAnc2VsZWN0ZWRfdGFibGVfZnVsbCcsIAogICAgICAgICdzYXZlX2No
YW5nZXNfcHJlc3NlZCcKICAgIF0KICAgIAogICAgZm9yIGtleSBpbiBrZXlzX3RvX3Jlc2V0Ogog
ICAgICAgIHN0LnNlc3Npb25fc3RhdGUucG9wKGtleSwgTm9uZSkKCmRlZiBjcmVhdGVfbWV0YWRh
dGFjYXJkX2h0bWwoaGVhZGVyPSJIZWFkZXIiLCB2YWx1ZT0iVmFsdWUiLCBkZXNjcmlwdGlvbj0i
RGVzY3JpcHRpb24iLCBjYXJkX2JnX2NvbG9yPSIjZmZmZmZmIiwgaGVhZGVyX2JnX2NvbG9yPSIj
MDAwMDAwIik6CiAgICAiIiIKICAgIENyZWF0ZSBhbiBIVE1MIHN0cmluZyBmb3IgYSBzdHlsZWQg
Y2FyZCBjb21wb25lbnQuCgogICAgUGFyYW1ldGVyczoKICAgIGhlYWRlciAoc3RyKTogVGhlIHRl
eHQgdG8gZGlzcGxheSBpbiB0aGUgY2FyZCBoZWFkZXIuIERlZmF1bHQgaXMgIkhlYWRlciIuCiAg
ICB2YWx1ZSAoc3RyKTogVGhlIG1haW4gdmFsdWUgdG8gZGlzcGxheSBpbiB0aGUgY2FyZC4gRGVm
YXVsdCBpcyAiVmFsdWUiLgogICAgZGVzY3JpcHRpb24gKHN0cik6IEEgZGVzY3JpcHRpb24gdG8g
ZGlzcGxheSBiZWxvdyB0aGUgbWFpbiB2YWx1ZS4gRGVmYXVsdCBpcyAiRGVzY3JpcHRpb24iLgog
ICAgY2FyZF9iZ19jb2xvciAoc3RyKTogVGhlIGJhY2tncm91bmQgY29sb3IgZm9yIHRoZSBjYXJk
LiBEZWZhdWx0IGlzICIjZmZmZmZmIi4KICAgIGhlYWRlcl9iZ19jb2xvciAoc3RyKTogVGhlIGJh
Y2tncm91bmQgY29sb3IgZm9yIHRoZSBjYXJkIGhlYWRlci4gRGVmYXVsdCBpcyAiIzAwMDAwMCIu
CgogICAgUmV0dXJuczoKICAgIHN0cjogQW4gSFRNTCBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBz
dHlsZWQgY2FyZC4KICAgICIiIgogICAgcmV0dXJuIGYiIiIKICAgIDxkaXYgc3R5bGU9ImJhY2tn
cm91bmQtY29sb3I6IHtjYXJkX2JnX2NvbG9yfTsgYm9yZGVyLXJhZGl1czogMTBweDsgcGFkZGlu
ZzogMTBweDsgYm94LXNoYWRvdzogMCA0cHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xKTsgbWFyZ2lu
OiAxMHB4OyB3aWR0aDogMTgwcHg7IGhlaWdodDogMTUwcHg7Ij4KICAgICAgICA8ZGl2IHN0eWxl
PSJiYWNrZ3JvdW5kLWNvbG9yOiB7aGVhZGVyX2JnX2NvbG9yfTsgY29sb3I6IHdoaXRlOyBwYWRk
aW5nOiA1cHggNXB4IDE1cHg7IGJvcmRlci1yYWRpdXM6IDVweCA1cHggMCAwOyB0ZXh0LWFsaWdu
OiBjZW50ZXI7IGhlaWdodDogMzBweDsiPgogICAgICAgICAgICA8aDUgc3R5bGU9Im1hcmdpbjog
MDsgY29sb3I6d2hpdGU7IGZvbnQtc2l6ZTogMC45ZW07IGxpbmUtaGVpZ2h0OiAzMHB4OyI+e2hl
YWRlcn08L2g1PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6IDEw
cHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPgogICAgICAgICAgICA8aDQgc3R5bGU9Im1hcmdpbjog
MDsgY29sb3I6IGJsYWNrOyBmb250LXNpemU6IDJlbTsiPnt2YWx1ZX08L2g0PgogICAgICAgICAg
ICA8cCBzdHlsZT0ibWFyZ2luOiAwOyBjb2xvcjogZ3JheTsgZm9udC1zaXplOiAwLjhlbTsiPntk
ZXNjcmlwdGlvbn08L3A+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgICIiIgoKQHN0LmNh
Y2hlX2RhdGEKZGVmIGZldGNoX3RhYmxlX2RhdGEoX3Nlc3Npb24sIHRhYmxlX25hbWUpOgogICAg
IiIiCiAgICBGZXRjaCBkYXRhIGZyb20gdGhlIHNwZWNpZmllZCB0YWJsZSB1c2luZyB0aGUgcHJv
dmlkZWQgc2Vzc2lvbiBvYmplY3QuCgogICAgUGFyYW1ldGVyczoKICAgIF9zZXNzaW9uIChvYmpl
Y3QpOiBUaGUgc2Vzc2lvbiBvYmplY3QgdXNlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBkYXRhYmFz
ZS4KICAgIHRhYmxlX25hbWUgKHN0cik6IFRoZSBuYW1lIG9mIHRoZSB0YWJsZSBmcm9tIHdoaWNo
IHRvIGZldGNoIGRhdGEuCgogICAgUmV0dXJuczoKICAgIHBkLkRhdGFGcmFtZTogQSBwYW5kYXMg
RGF0YUZyYW1lIGNvbnRhaW5pbmcgdGhlIGRhdGEgZnJvbSB0aGUgc3BlY2lmaWVkIHRhYmxlLgog
ICAgIiIiCiAgICByZXR1cm4gbG9hZF90YWJsZV9kYXRhKF9zZXNzaW9uLCB0YWJsZV9uYW1lKQoK
ZGVmIGxvYWRfdGFibGVfZGF0YShzZXNzaW9uLCB0YWJsZSk6CiAgICAiIiIKICAgIExvYWQgZGF0
YSBmcm9tIHRoZSBzcGVjaWZpZWQgdGFibGUgdXNpbmcgdGhlIHByb3ZpZGVkIHNlc3Npb24gb2Jq
ZWN0LgoKICAgIFBhcmFtZXRlcnM6CiAgICBzZXNzaW9uIChvYmplY3QpOiBUaGUgc2Vzc2lvbiBv
YmplY3QgdXNlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBkYXRhYmFzZS4KICAgIHRhYmxlIChzdHIp
OiBUaGUgbmFtZSBvZiB0aGUgdGFibGUgZnJvbSB3aGljaCB0byBsb2FkIGRhdGEuCgogICAgUmV0
dXJuczoKICAgIHR1cGxlOiBBIHR1cGxlIGNvbnRhaW5pbmc6CiAgICAgICAgLSBwZC5EYXRhRnJh
bWU6IEEgcGFuZGFzIERhdGFGcmFtZSBjb250YWluaW5nIGEgc2FtcGxlIG9mIHJvd3MgZnJvbSB0
aGUgc3BlY2lmaWVkIHRhYmxlLgogICAgICAgIC0gaW50OiBUaGUgdG90YWwgbnVtYmVyIG9mIHJv
d3MgaW4gdGhlIHNwZWNpZmllZCB0YWJsZS4KICAgICIiIgogICAgIyBTUUwgcXVlcnkgdG8gZmV0
Y2ggYSBzYW1wbGUgb2Ygcm93cyBmcm9tIHRoZSB0YWJsZQogICAgcXVlcnkgPSBmIlNFTEVDVCAq
IEZST00ge3RhYmxlfSBTQU1QTEUgKDEwIFJPV1MpIgogICAgCiAgICAjIFNRTCBxdWVyeSB0byBj
b3VudCB0aGUgdG90YWwgbnVtYmVyIG9mIHJvd3MgaW4gdGhlIHRhYmxlCiAgICByb3dfY291bnRf
cXVlcnkgPSBmIlNFTEVDVCBjb3VudCgqKSBGUk9NIHt0YWJsZX0iCiAgICAKICAgICMgRXhlY3V0
ZSB0aGUgcXVlcmllcyBhbmQgcmV0dXJuIHRoZSByZXN1bHRzIGFzIGEgdHVwbGUKICAgIHJldHVy
biByZWFkX3RhYmxlKHF1ZXJ5LCBzZXNzaW9uKSwgcmVhZF9zcWwocm93X2NvdW50X3F1ZXJ5LCBz
ZXNzaW9uLCAwKQoKZGVmIGdldF90YWJsZV9tZXRhZGF0YShzZXNzaW9uLCB0YWJsZV9uYW1lKToK
ICAgICIiIgogICAgUmV0cmlldmUgbWV0YWRhdGEgZm9yIGNvbHVtbnMgaW4gdGhlIHNwZWNpZmll
ZCB0YWJsZS4KCiAgICBQYXJhbWV0ZXJzOgogICAgc2Vzc2lvbiAob2JqZWN0KTogVGhlIHNlc3Np
b24gb2JqZWN0IHVzZWQgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0YWJhc2UuCiAgICB0YWJsZV9u
YW1lIChzdHIpOiBUaGUgZnVsbHkgcXVhbGlmaWVkIG5hbWUgb2YgdGhlIHRhYmxlIChpbiB0aGUg
Zm9ybWF0ICdkYXRhYmFzZS5zY2hlbWEudGFibGUnKS4KCiAgICBSZXR1cm5zOgogICAgcGQuRGF0
YUZyYW1lOiBBIHBhbmRhcyBEYXRhRnJhbWUgY29udGFpbmluZyBtZXRhZGF0YSBmb3IgdGhlIGNv
bHVtbnMgaW4gdGhlIHNwZWNpZmllZCB0YWJsZS4KICAgICIiIgogICAgIyBTcGxpdCB0aGUgZnVs
bHkgcXVhbGlmaWVkIHRhYmxlIG5hbWUgaW50byBkYXRhYmFzZSwgc2NoZW1hLCBhbmQgdGFibGUg
cGFydHMKICAgIHBhcnRzID0gdGFibGVfbmFtZS5zcGxpdCgiLiIpCiAgICBpZiBsZW4ocGFydHMp
ID09IDM6CiAgICAgICAgZGF0YWJhc2VfbmFtZSwgc2NoZW1hX25hbWUsIHRhYmxlX25hbWUgPSBw
YXJ0cwoKICAgICMgU1FMIHF1ZXJ5IHRvIHJldHJpZXZlIGNvbHVtbiBtZXRhZGF0YSBmcm9tIHRo
ZSBpbmZvcm1hdGlvbiBzY2hlbWEKICAgIHF1ZXJ5ID0gZiIiIgogICAgICAgIFNFTEVDVCBDT0xV
TU5fTkFNRSwKICAgICAgICAgICAgICAgREFUQV9UWVBFLAogICAgICAgICAgICAgICBJRk5VTEwo
Q09NTUVOVCwgJycpIEFTIERFU0NSSVBUSU9OLAogICAgICAgICAgICAgICAnJyBBUyBGSUxURVJf
VFlQRSAKICAgICAgICBGUk9NIHtkYXRhYmFzZV9uYW1lfS5JTkZPUk1BVElPTl9TQ0hFTUEuQ09M
VU1OUwogICAgICAgIFdIRVJFIFRBQkxFX05BTUUgPSAne3RhYmxlX25hbWV9JyBBTkQgVEFCTEVf
U0NIRU1BID0gJ3tzY2hlbWFfbmFtZX0nCiAgICAiIiIKICAgIAogICAgIyBFeGVjdXRlIHRoZSBx
dWVyeSBhbmQgcmV0dXJuIHRoZSByZXN1bHQgYXMgYSBwYW5kYXMgRGF0YUZyYW1lCiAgICByZXR1
cm4gcmVhZF90YWJsZShxdWVyeSwgc2Vzc2lvbikKCmRlZiBmZXRjaF90YWJsZV9zaXplKHNlc3Np
b24sIGRhdGFiYXNlLCBzY2hlbWEsIHRhYmxlKToKICAgICIiIgogICAgRmV0Y2ggdGhlIHNpemUg
b2YgdGhlIHNwZWNpZmllZCB0YWJsZSBpbiBhIGh1bWFuLXJlYWRhYmxlIGZvcm1hdC4KCiAgICBQ
YXJhbWV0ZXJzOgogICAgc2Vzc2lvbiAob2JqZWN0KTogVGhlIHNlc3Npb24gb2JqZWN0IHVzZWQg
dG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0YWJhc2UuCiAgICBkYXRhYmFzZSAoc3RyKTogVGhlIG5h
bWUgb2YgdGhlIGRhdGFiYXNlIGNvbnRhaW5pbmcgdGhlIHRhYmxlLgogICAgc2NoZW1hIChzdHIp
OiBUaGUgbmFtZSBvZiB0aGUgc2NoZW1hIGNvbnRhaW5pbmcgdGhlIHRhYmxlLgogICAgdGFibGUg
KHN0cik6IFRoZSBuYW1lIG9mIHRoZSB0YWJsZSBmb3Igd2hpY2ggdG8gZmV0Y2ggdGhlIHNpemUu
CgogICAgUmV0dXJuczoKICAgIHN0cjogVGhlIHNpemUgb2YgdGhlIHRhYmxlIGluIGEgaHVtYW4t
cmVhZGFibGUgZm9ybWF0IChCLCBLQiwgTUIsIEdCLCBUQikuCiAgICAiIiIKICAgIHRyeToKICAg
ICAgICAjIFNRTCBxdWVyeSB0byBmZXRjaCB0aGUgYWN0aXZlIGJ5dGVzIG9mIHRoZSBzcGVjaWZp
ZWQgdGFibGUgZnJvbSB0aGUgaW5mb3JtYXRpb24gc2NoZW1hCiAgICAgICAgcXVlcnkgPSBmIiIi
CiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgIkFDVElWRV9CWVRFUyIKICAgICAg
ICAgICAgRlJPTSB7ZGF0YWJhc2V9LklORk9STUFUSU9OX1NDSEVNQS5UQUJMRV9TVE9SQUdFX01F
VFJJQ1MKICAgICAgICAgICAgV0hFUkUgdGFibGVfY2F0YWxvZyA9ICd7ZGF0YWJhc2V9JwogICAg
ICAgICAgICBBTkQgdGFibGVfc2NoZW1hID0gJ3tzY2hlbWF9JwogICAgICAgICAgICBBTkQgdGFi
bGVfbmFtZSA9ICd7dGFibGV9JwogICAgICAgICIiIgogICAgICAgIAogICAgICAgICMgRXhlY3V0
ZSB0aGUgcXVlcnkgYW5kIGdldCB0aGUgcmVzdWx0CiAgICAgICAgcmVzdWx0ID0gcmVhZF9zcWwo
cXVlcnksIHNlc3Npb24sIDApWzBdCgogICAgICAgICMgSWYgdGhlIHJlc3VsdCBpcyAwLCByZXR1
cm4gIjBCIgogICAgICAgIGlmIHJlc3VsdCA9PSAwOgogICAgICAgICAgICByZXR1cm4gIjBCIgog
ICAgICAgIAogICAgICAgICMgRGVmaW5lIHNpemUgdW5pdHMKICAgICAgICBzaXplX3VuaXRzID0g
KCJCIiwgIktCIiwgIk1CIiwgIkdCIiwgIlRCIikKICAgICAgICAKICAgICAgICAjIENhbGN1bGF0
ZSB0aGUgYXBwcm9wcmlhdGUgdW5pdAogICAgICAgIGkgPSBpbnQobWF0aC5mbG9vcihtYXRoLmxv
ZyhmbG9hdChyZXN1bHQpLCAxMDI0KSkpCiAgICAgICAgcCA9IG1hdGgucG93KDEwMjQsIGkpCiAg
ICAgICAgcyA9IHJvdW5kKGZsb2F0KHJlc3VsdCkgLyBwLCAwKQogICAgICAgIAogICAgICAgICMg
UmV0dXJuIHRoZSBzaXplIGluIGEgaHVtYW4tcmVhZGFibGUgZm9ybWF0CiAgICAgICAgcmV0dXJu
IGYie3N9IHtzaXplX3VuaXRzW2ldfSIKICAgIAogICAgZXhjZXB0OgoKICAgICAgICByZXR1cm4g
ZiIwIE1CIgogICAgCmRlZiBnZW5lcmF0ZV9jb2x1bW5zX2luZm9fanNvbih0YWJsZV9kZiwgdGFi
bGVfbWV0YWRhdGFfZGYsIHNlc3Npb24sIG51bV9zYW1wbGVzPTMpOgogICAgIiIiCiAgICBHZW5l
cmF0ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgY29sdW1ucyBpbmZvIHVzaW5nIHNhbXBsZSB2
YWx1ZXMgZnJvbSB0aGUgZGF0YXNldC4KCiAgICBQYXJhbWV0ZXJzOgogICAgLSB0YWJsZV9kZiAo
cGQuRGF0YUZyYW1lKTogRGF0YWZyYW1lIGNvbnRhaW5pbmcgdGhlIHRhYmxlIGRhdGEuCiAgICAt
IHRhYmxlX21ldGFkYXRhX2RmIChwZC5EYXRhRnJhbWUpOiBEYXRhZnJhbWUgY29udGFpbmluZyBt
ZXRhZGF0YSBvZiB0aGUgdGFibGUuCiAgICAtIHNlc3Npb246IERhdGFiYXNlIHNlc3Npb24uCiAg
ICAtIG51bV9zYW1wbGVzIChpbnQpOiBOdW1iZXIgb2Ygc2FtcGxlIHZhbHVlcyB0byBleHRyYWN0
LgoKICAgIFJldHVybnM6CiAgICAtIHBkLkRhdGFGcmFtZTogRGF0YWZyYW1lIHdpdGggZW5yaWNo
ZWQgbWV0YWRhdGEgaW5jbHVkaW5nIExMTSBkZXNjcmlwdGlvbnMuCiAgICAiIiIKICAgICMgQ29u
dmVydCBkYXRldGltZSBjb2x1bW5zIHRvIHN0cmluZyBmb3JtYXQKICAgIGZvciBjb2wgaW4gdGFi
bGVfZGYuY29sdW1uczoKICAgICAgICBpZiBwZC5hcGkudHlwZXMuaXNfZGF0ZXRpbWU2NF9hbnlf
ZHR5cGUodGFibGVfZGZbY29sXSk6CiAgICAgICAgICAgIHRhYmxlX2RmW2NvbF0gPSB0YWJsZV9k
Zltjb2xdLmR0LnN0cmZ0aW1lKCclWS0lbS0lZCAlSDolTTolUycpCiAgICAgICAgZWxzZToKICAg
ICAgICAgICAgdGFibGVfZGZbY29sXSA9IHRhYmxlX2RmW2NvbF0uYXN0eXBlKHN0cikKCiAgICAj
IEV4dHJhY3Qgc2FtcGxlIHZhbHVlcyBmcm9tIHRoZSBkYXRhZnJhbWUKICAgIHNhbXBsZV92YWx1
ZXMgPSB0YWJsZV9kZi5oZWFkKG51bV9zYW1wbGVzKS50cmFuc3Bvc2UoKS5yZXNldF9pbmRleCgp
CiAgICBzYW1wbGVfdmFsdWVzLmNvbHVtbnMgPSBbJ0NPTFVNTl9OQU1FJ10gKyBbZidTYW1wbGUg
VmFsdWUge2krMX0nIGZvciBpIGluIHJhbmdlKHNhbXBsZV92YWx1ZXMuc2hhcGVbMV0gLSAxKV0K
ICAgIHNhbXBsZV92YWx1ZXMgPSBzYW1wbGVfdmFsdWVzLmFwcGx5bWFwKHN0cikKICAgIHNhbXBs
ZV92YWx1ZXNbJ1NBTVBMRV9WQUxVRVMnXSA9IHNhbXBsZV92YWx1ZXMuYXBwbHkobGFtYmRhIHJv
dzogcm93WzE6XS52YWx1ZXMudG9saXN0KCksIGF4aXM9MSkKICAgIAogICAgIyBNZXJnZSBzYW1w
bGUgdmFsdWVzIHdpdGggdGhlIG1ldGFkYXRhCiAgICBtZXJnZWRfZGYgPSBwZC5tZXJnZSh0YWJs
ZV9tZXRhZGF0YV9kZiwgc2FtcGxlX3ZhbHVlc1tbJ0NPTFVNTl9OQU1FJywgJ1NBTVBMRV9WQUxV
RVMnXV0sIG9uPSdDT0xVTU5fTkFNRScpCgogICAgIyBDb25zdHJ1Y3QgSlNPTiBvdXRwdXQgZm9y
IExMTSBwcm9jZXNzaW5nCiAgICBjb2x1bW5zX2luZm8gPSBbCiAgICAgICAgewogICAgICAgICAg
ICAnQ09MVU1OX05BTUUnOiByb3dbJ0NPTFVNTl9OQU1FJ10sCiAgICAgICAgICAgICdEQVRBX1RZ
UEUnOiByb3dbJ0RBVEFfVFlQRSddLAogICAgICAgICAgICAnU0FNUExFX1ZBTFVFUyc6IHJvd1sn
U0FNUExFX1ZBTFVFUyddCiAgICAgICAgfQogICAgICAgIGZvciBpbmRleCwgcm93IGluIG1lcmdl
ZF9kZi5pdGVycm93cygpCiAgICBdCgogICAganNvbl9vdXRwdXQgPSBqc29uLmR1bXBzKGNvbHVt
bnNfaW5mbywgaW5kZW50PTQpCiAgICBkZiA9IGdldF9sbG1fZGF0YV9kaWN0KGpzb25fb3V0cHV0
LCBzZXNzaW9uKQoKICAgICMgTWVyZ2UgTExNIG91dHB1dCB3aXRoIHRoZSBvcmlnaW5hbCBtZXRh
ZGF0YQogICAgcmV0dXJuIHBkLm1lcmdlKGRmLCB0YWJsZV9tZXRhZGF0YV9kZltbJ0NPTFVNTl9O
QU1FJywgJ0RBVEFfVFlQRSddXSwgb249J0NPTFVNTl9OQU1FJykKCmRlZiBnZXRfbGxtX2RhdGFf
ZGljdChkYXRhX2pzb24sIHNlc3Npb24pOgogICAgIiIiCiAgICBHZXQgY29sdW1uIGRlc2NyaXB0
aW9ucyBhbmQgbWV0YWRhdGEgdXNpbmcgYW4gTExNIG1vZGVsLgoKICAgIFBhcmFtZXRlcnM6CiAg
ICAtIGRhdGFfanNvbiAoc3RyKTogSlNPTiBzdHJpbmcgb2YgY29sdW1uIGRhdGEuCiAgICAtIHNl
c3Npb246IERhdGFiYXNlIHNlc3Npb24uCgogICAgUmV0dXJuczoKICAgIC0gcGQuRGF0YUZyYW1l
OiBEYXRhZnJhbWUgd2l0aCBMTE0tZW5yaWNoZWQgbWV0YWRhdGEuCiAgICAiIiIKICAgIGRhdGFf
anNvbiA9IGpzb24uZHVtcHMoZGF0YV9qc29uKS5yZXBsYWNlKCInIiwgIicnIikKICAgIGRhdGFk
aWN0X3F1ZXJ5ID0gZiIiIgogICAgICAgIFNFTEVDVAogICAgICAgICAgICBTTk9XRkxBS0UuQ09S
VEVYLkNPTVBMRVRFKAogICAgICAgICAgICAnbWlzdHJhbC1sYXJnZScsCiAgICAgICAgICAgIFsK
ICAgICAgICAgICAgICAgIHt7CiAgICAgICAgICAgICAgICAgICAgJ3JvbGUnOiAnc3lzdGVtJywg
J2NvbnRlbnQnOiAnCiAgICAgICAgICAgICAgICAgICAgWW91IGFyZSBhbiBBSSBCdXNpbmVzcyBJ
bnRlbGxpZ2VuY2UgQXNzaXN0YW50LiBHaXZlbiBhIEpTT04gaW5wdXQsIHByb2Nlc3MgaXQgYW5k
IHJldHVybiBhIEpTT04gb3V0cHV0IHdpdGggdGhlIGZvbGxvd2luZyBhdHRyaWJ1dGVzIGZvciBl
YWNoIGNvbHVtbjoKCiAgICAgICAgICAgICAgICAgICAgLSBDT0xVTU5fTkFNRTogVGhlIGNvbHVt
biBuYW1lIGZyb20gdGhlIEpTT04gaW5wdXQuCiAgICAgICAgICAgICAgICAgICAgLSBERVNDUklQ
VElPTjogQSBicmllZiBleHBsYW5hdGlvbiBvZiB0aGUgY29sdW1uIHB1cnBvc2UsIGV4Y2x1ZGlu
ZyBkYXRhIHR5cGUuCiAgICAgICAgICAgICAgICAgICAgLSBDT0xVTU5fVFlQRTogU3BlY2lmeSBp
ZiB0aGUgY29sdW1uIGlzIGEgRmFjdCBvciBEaW1lbnNpb24uCiAgICAgICAgICAgICAgICAgICAg
LSBGSUxURVJfVFlQRTogQXBwbGljYWJsZSBmaWx0ZXIgdHlwZSAoZS5nLiwgZHJvcGRvd24sIHRl
eHQsIG11bHRpLXNlbGVjdCwgYm9vbGVhbiwgc2xpZGVyLCB0b3AgTiwgcmFuZ2UsIGRhdGUpLiBM
YWJlbCBhcyBVbmtub3duIGlmIHVuY2xlYXIuCiAgICAgICAgICAgICAgICAgICAgLSBQUklNQVJZ
X0ZJTFRFUjogSWRlbnRpZnkgMiBwcmltYXJ5IGZpbHRlcnMgYW1vbmcgdGhlIGNvbHVtbnMgYW5k
IHNldCB0aGlzIGF0dHJpYnV0ZSB0byBUcnVlIGZvciB0aGVtLiBTZXQgdG8gRmFsc2UgZm9yIG90
aGVycy4KCiAgICAgICAgICAgICAgICAgICAgJwogICAgICAgICAgICAgICAgfX0sCiAgICAgICAg
ICAgICAgICB7ewogICAgICAgICAgICAgICAgICAgICdyb2xlJzogJ3VzZXInLAogICAgICAgICAg
ICAgICAgICAgICdjb250ZW50JzogJwogICAgICAgICAgICAgICAgICAgICAgICBIZXJlIGlzIGEg
SnNvbi4gUHJvY2VzcyBpdCBhbmQgcmV0dXJuIGEgSlNPTiB3aXRoIENPTFVNTl9OQU1FLCBERVND
UklQVElPTiwgQ09MVU1OX1RZUEUgYW5kIEZJTFRFUl9UWVBFIGF0dHJpYnV0ZXMgZmlsbGVkLgog
ICAgICAgICAgICAgICAgICAgICAgICA8anNvbj57ZGF0YV9qc29ufTwvanNvbj4nCiAgICAgICAg
ICAgICAgICB9fQogICAgICAgICAgICBdLAogICAgICAgICAgICB7ewogICAgICAgICAgICAgICAg
J3RlbXBlcmF0dXJlJzogMSwKICAgICAgICAgICAgICAgICdtYXhfdG9rZW5zJzogMTAwMDAwMAog
ICAgICAgICAgICB9fQogICAgICAgICkgYXMgb3V0cHV0LAogICAgICAgIHRyeV9wYXJzZV9qc29u
KHBhcnNlX2pzb24ob3V0cHV0OmNob2ljZXMpWzBdKTptZXNzYWdlcyBhcyByZXNwb25zZSwKICAg
ICAgICBjaGFyaW5kZXgoJ1snLCByZXNwb25zZSwxKSBhcyBzdGFydF9pbmRleCwKICAgICAgICBj
aGFyaW5kZXgoJ10nLCByZXNwb25zZSwxKSBhcyBlbmRfaW5kZXgsCiAgICAgICAgdHJ5X3BhcnNl
X2pzb24oU1VCU1RSSU5HKHJlc3BvbnNlLCBzdGFydF9pbmRleCwgZW5kX2luZGV4IC0gc3RhcnRf
aW5kZXggKzIpKSBhcyByZXNwb25zZV9qc29uOwogICAgIiIiCiAgICAKICAgIHdpdGggc3Quc3Bp
bm5lcigiUGxlYXNlIHdhaXQuLi4iKToKICAgICAgICAjIEV4ZWN1dGUgdGhlIHF1ZXJ5IGFuZCBn
ZXQgdGhlIHJlc3BvbnNlIEpTT04KICAgICAgICByZXNwb25zZV9qc29uID0gcmVhZF90YWJsZShk
YXRhZGljdF9xdWVyeSwgc2Vzc2lvbilbJ1JFU1BPTlNFX0pTT04nXVswXQoKICAgIGRmID0gcGQu
RGF0YUZyYW1lKGpzb24ubG9hZHMocmVzcG9uc2VfanNvbikpCgogICAgcmV0dXJuIGRmCgpkZWYg
cHJvY2Vzc19jb2x1bW5zKHNlc3Npb24sIGRmLCB3aGVyZV9jbGF1c2U9JycpOgogICAgIiIiCiAg
ICBQcm9jZXNzIGNvbHVtbnMgdG8gZ2VuZXJhdGUgbWluLCBtYXgsIGFuZCBkaXN0aW5jdCB2YWx1
ZXMgZm9yIHByaW1hcnkgZmlsdGVycy4KCiAgICBQYXJhbWV0ZXJzOgogICAgLSBzZXNzaW9uOiBE
YXRhYmFzZSBzZXNzaW9uLgogICAgLSBkZiAocGQuRGF0YUZyYW1lKTogRGF0YWZyYW1lIHdpdGgg
Y29sdW1uIG1ldGFkYXRhLgogICAgLSB3aGVyZV9jbGF1c2UgKHN0cik6IEFkZGl0aW9uYWwgU1FM
IHdoZXJlIGNsYXVzZS4KCiAgICBSZXR1cm5zOgogICAgLSBwZC5EYXRhRnJhbWU6IERhdGFmcmFt
ZSB3aXRoIHByb2Nlc3NlZCBjb2x1bW4gdmFsdWVzLgogICAgIiIiCiAgICB0YWJsZV9uYW1lID0g
c3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF90YWJsZV9mdWxsCgogICAgIyBJbml0aWFsaXplIGFu
IGVtcHR5IGxpc3QgdG8gc3RvcmUgdGhlIHJlc3VsdHMKICAgIHJlc3VsdF9kZnMgPSBbXQoKICAg
IGZvciBpbmRleCwgcm93IGluIGRmLml0ZXJyb3dzKCk6CiAgICAgICAgY29sdW1uX25hbWUgPSBy
b3dbJ0NPTFVNTl9OQU1FJ10KICAgICAgICBkYXRhX3R5cGUgPSByb3dbJ0RBVEFfVFlQRSddCiAg
ICAgICAgZmlsdGVyX3R5cGUgPSByb3dbJ0ZJTFRFUl9UWVBFJ10KCiAgICAgICAgIyBDYWxsIHRo
ZSBzdG9yZWQgcHJvY2VkdXJlIGZvciBlYWNoIGNvbHVtbiBhbmQgZ2V0IHRoZSByZXN1bHQKICAg
ICAgICByZXN1bHRfZGYgPSBzZXNzaW9uLmNhbGwoJ2NvaG9ydF9idWlsZGVyX2Zvcl9zbm93Zmxh
a2UuYXBwLmdldF9jb2x1bW5fc3RhdHMnLCBjb2x1bW5fbmFtZSwgZGF0YV90eXBlLCBmaWx0ZXJf
dHlwZSwgdGFibGVfbmFtZSwgd2hlcmVfY2xhdXNlKQogICAgICAgIAogICAgICAgICMgQ29udmVy
dCB0aGUgcmVzdWx0IHRvIGEgcGFuZGFzIERhdGFGcmFtZSBhbmQgYXBwZW5kIHRvIHRoZSBsaXN0
CiAgICAgICAgcmVzdWx0X2Rmcy5hcHBlbmQocmVzdWx0X2RmLnRvX3BhbmRhcygpKQoKICAgICMg
Q29uY2F0ZW5hdGUgYWxsIHRoZSByZXN1bHQgRGF0YUZyYW1lcwogICAgY29tYmluZWRfZGYgPSBw
ZC5jb25jYXQocmVzdWx0X2RmcywgaWdub3JlX2luZGV4PVRydWUpCgogICAgIyBNZXJnZSB0aGUg
cmVzdWx0IHdpdGggdGhlIG9yaWdpbmFsIGRhdGFmcmFtZQogICAgY29tYmluZWRfZGYgPSBwZC5t
ZXJnZShkZiwgY29tYmluZWRfZGYsIG9uPVsnQ09MVU1OX05BTUUnLCAnREFUQV9UWVBFJywgJ0ZJ
TFRFUl9UWVBFJ10sIGhvdz0naW5uZXInKQoKICAgIHJldHVybiBjb21iaW5lZF9kZgoKZGVmIHJl
bmRlcl9oZWFkZXIodGl0bGUsIGRlc2NyaXB0aW9uKToKICAgICAgICAiIiIKICAgICAgICBSZW5k
ZXIgdGhlIGhlYWRlciBzZWN0aW9uIG9mIHRoZSBhcHAgd2l0aCBjdXN0b20gc3R5bGluZy4KICAg
ICAgICAiIiIKICAgICAgICBzdC5tYXJrZG93bigiIiIKICAgICAgICAgICAgPHN0eWxlPgogICAg
ICAgICAgICAuaGVhZGVyIHsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMzJweDsKICAgICAg
ICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgICAgICAgICBjb2xvcjogIzg3Y2Vl
YjsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgICAgICBhbGlnbi1p
dGVtczogY2VudGVyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5oZWFkZXIgaW1nIHsKICAg
ICAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgICAgICAgICAgfQogICAgICAgICAg
ICAuZGVzY3JpcHRpb24gewogICAgICAgICAgICAgICAgY29sb3I6ICNlZGU4ZTg7CiAgICAgICAg
ICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9s
ZDsKICAgICAgICAgICAgfQogICAgICAgICAgICAuaG9yaXpvbnRhbC1saW5lIHsKICAgICAgICAg
ICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgICAgICAgIGhlaWdodDogNTBweDsKICAgICAg
ICAgICAgICAgIGJhY2tncm91bmQ6ICNlNmU2ZmE7CiAgICAgICAgICAgICAgICBtYXJnaW4tdG9w
OiAwcHg7CiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICAgICAgICB9
CiAgICAgICAgICAgIGRpdltkYXRhLXRlc3RpZD0ic3RFeHBhbmRlciJdICB7CiAgICAgICAgICAg
ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjI2ODY4OyAgCiAgICAgICAgICAgICAgICBjb2xvcjog
I0Y5RjdGMzsgIAogICAgICAgICAgICAgICAgYm9yZGVyOiBub25lOyAgCiAgICAgICAgICAgIH0K
ICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAgICAgIiIiLCB1bnNhZmVfYWxsb3dfaHRtbD1U
cnVlKQoKICAgICAgICBzdC5tYXJrZG93bihmIiIiCiAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhl
YWRlciI+CiAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT1mb250LXdlaWdodDogYm9sZDsiPnt0
aXRsZX08L3NwYW4+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8aHIgY2xhc3M9Imhv
cml6b250YWwtbGluZSIvPgogICAgICAgICAgICA8cCBjbGFzcz0iZGVzY3JpcHRpb24iPgogICAg
ICAgICAgICAgICAge2Rlc2NyaXB0aW9ufQogICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICIi
IiwgdW5zYWZlX2FsbG93X2h0bWw9VHJ1ZSkKCmRlZiBnZW5fd2hlcmVfY2xhdXNlX2Zvcl9ub25f
dGV4dF9maWx0ZXJzKGRmLCBmaWx0ZXJfdmFsdWVzKToKICAgICIiIgogICAgR2VuZXJhdGUgV0hF
UkUgY2xhdXNlIGZvciBub24tdGV4dCBmaWx0ZXJzLgoKICAgIFBhcmFtZXRlcnM6CiAgICAtIGRm
IChwZC5EYXRhRnJhbWUpOiBEYXRhRnJhbWUgY29udGFpbmluZyBjb2x1bW4gbWV0YWRhdGEuCiAg
ICAtIGZpbHRlcl92YWx1ZXMgKGRpY3QpOiBEaWN0aW9uYXJ5IHdpdGggZmlsdGVyIHZhbHVlcyBm
b3IgY29sdW1ucy4KCiAgICBSZXR1cm5zOgogICAgLSBzdHI6IFdIRVJFIGNsYXVzZSBmb3Igbm9u
LXRleHQgZmlsdGVycy4KICAgICIiIgogICAgY2xhdXNlcyA9IFtdCiAgICBzdC53cml0ZShmaWx0
ZXJfdmFsdWVzKQogICAgZm9yIGNvbHVtbl9uYW1lLCB2YWx1ZSBpbiBmaWx0ZXJfdmFsdWVzLml0
ZW1zKCk6CgogICAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgICAgIGNvbnRpbnVlCgog
ICAgICAgICMgR2V0dGluZyB0aGUgY29sdW1uIGZyb20gdGhlIGRhdGFmcmFtZQogICAgICAgIGNv
bHVtbl9kZiA9IGRmW2RmWydDT0xVTU5fTkFNRSddID09IGNvbHVtbl9uYW1lXQoKICAgICAgICBp
ZiBub3QgY29sdW1uX2RmLmVtcHR5OgogICAgICAgICAgICByb3cgPSBjb2x1bW5fZGYuaWxvY1sw
XQogICAgICAgICAgICBmaWx0ZXJfdHlwZSA9IHJvd1snRklMVEVSX1RZUEUnXQoKICAgICAgICAg
ICAgaWYgZmlsdGVyX3R5cGUgPT0gImRyb3Bkb3duIjoKICAgICAgICAgICAgICAgIGlmIHZhbHVl
ICE9ICIiOgogICAgICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbl9uYW1l
fSA9ICd7dmFsdWV9JyIpCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09ICJtdWx0aS1z
ZWxlY3QgZHJvcGRvd24iOgogICAgICAgICAgICAgICAgaWYgdmFsdWU6CiAgICAgICAgICAgICAg
ICAgICAgIyBGaWx0ZXIgb3V0IGVtcHR5IHN0cmluZ3MKICAgICAgICAgICAgICAgICAgICBmaWx0
ZXJlZF92YWx1ZXMgPSBbdiBmb3IgdiBpbiB2YWx1ZSBpZiB2ICE9ICIiXQogICAgICAgICAgICAg
ICAgICAgIGlmIGZpbHRlcmVkX3ZhbHVlczoKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVz
X3N0ciA9ICcsICcuam9pbihbZiIne3Z9JyIgZm9yIHYgaW4gZmlsdGVyZWRfdmFsdWVzXSkKICAg
ICAgICAgICAgICAgICAgICAgICAgY2xhdXNlID0gZiJ7Y29sdW1uX25hbWV9IElOICh7dmFsdWVz
X3N0cn0pIgogICAgICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChjbGF1c2UpCgog
ICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09ICJib29sZWFuIGZpbHRlciI6CiAgICAgICAg
ICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0gPSB7dmFsdWV9IikKCiAgICAg
ICAgICAgIGVsaWYgZmlsdGVyX3R5cGUgPT0gInNsaWRlciIgb3IgZmlsdGVyX3R5cGUgPT0gInJh
bmdlIGZpbHRlciI6CiAgICAgICAgICAgICAgICBtaW5fdmFsLCBtYXhfdmFsID0gdmFsdWUKICAg
ICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbl9uYW1lfSBCRVRXRUVOIHttaW5f
dmFsfSBBTkQge21heF92YWx9IikKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5cGUgPT0gImFk
dmFuY2VkIGRhdGUgZmlsdGVyIjoKICAgICAgICAgICAgICAgIGNvbmRpdGlvbiA9IHZhbHVlLmdl
dCgiY29uZGl0aW9uIikKICAgICAgICAgICAgICAgIGlmIGNvbmRpdGlvbiA9PSAiYmV0d2VlbiI6
CiAgICAgICAgICAgICAgICAgICAgc3RhcnRfZGF0ZSwgZW5kX2RhdGUgPSB2YWx1ZS5nZXQoInZh
bHVlMSIpLCB2YWx1ZS5nZXQoInZhbHVlMiIpCiAgICAgICAgICAgICAgICAgICAgY2xhdXNlcy5h
cHBlbmQoZiJ7Y29sdW1uX25hbWV9IEJFVFdFRU4gJ3tzdGFydF9kYXRlfScgQU5EICd7ZW5kX2Rh
dGV9JyIpCiAgICAgICAgICAgICAgICBlbGlmIGNvbmRpdGlvbiA9PSAiZ3JlYXRlciB0aGFuIG9y
IGVxdWFsIjoKICAgICAgICAgICAgICAgICAgICBkYXRlX3ZhbCA9IHZhbHVlLmdldCgidmFsdWUi
KQogICAgICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbl9uYW1lfSA+PSAn
e2RhdGVfdmFsfSciKQogICAgICAgICAgICAgICAgZWxpZiBjb25kaXRpb24gPT0gImxlc3MgdGhh
biBvciBlcXVhbCI6CiAgICAgICAgICAgICAgICAgICAgZGF0ZV92YWwgPSB2YWx1ZS5nZXQoInZh
bHVlIikKICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0g
PD0gJ3tkYXRlX3ZhbH0nIikKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5cGUgPT0gJ2RhdGUg
ZmlsdGVyJzoKICAgICAgICAgICAgICAgIG1pbl9kYXRlLCBtYXhfZGF0ZSA9IHZhbHVlCiAgICAg
ICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0gQkVUV0VFTiAne21pbl9k
YXRlfScgQU5EICd7bWF4X2RhdGV9JyIpCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09
ICJhZHZhbmNlZCBudW1lcmljIGZpbHRlciI6CiAgICAgICAgICAgICAgICBjb25kaXRpb24gPSB2
YWx1ZS5nZXQoImNvbmRpdGlvbiIpCiAgICAgICAgICAgICAgICBpZiBjb25kaXRpb24gPT0gImJl
dHdlZW4iOgogICAgICAgICAgICAgICAgICAgIG1pbl92YWwsIG1heF92YWwgPSB2YWx1ZS5nZXQo
InZhbHVlMSIpLCB2YWx1ZS5nZXQoInZhbHVlMiIpCiAgICAgICAgICAgICAgICAgICAgY2xhdXNl
cy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9IEJFVFdFRU4ge21pbl92YWx9IEFORCB7bWF4X3ZhbH0i
KQogICAgICAgICAgICAgICAgZWxpZiBjb25kaXRpb24gPT0gImdyZWF0ZXIgdGhhbiI6CiAgICAg
ICAgICAgICAgICAgICAgdmFsID0gdmFsdWUuZ2V0KCJ2YWx1ZSIpCiAgICAgICAgICAgICAgICAg
ICAgY2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9ID4ge3ZhbH0iKQogICAgICAgICAgICAg
ICAgZWxpZiBjb25kaXRpb24gPT0gImxlc3MgdGhhbiI6CiAgICAgICAgICAgICAgICAgICAgdmFs
ID0gdmFsdWUuZ2V0KCJ2YWx1ZSIpCiAgICAgICAgICAgICAgICAgICAgY2xhdXNlcy5hcHBlbmQo
ZiJ7Y29sdW1uX25hbWV9IDwge3ZhbH0iKQogICAgICAgICAgICAgICAgZWxpZiBjb25kaXRpb24g
PT0gImVxdWFsIHRvIjoKICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZS5nZXQoInZhbHVl
IikKICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0gPSB7
dmFsfSIpCgogICAgcmV0dXJuICIgQU5EICIuam9pbihjbGF1c2VzKQoKCgpkZWYgZ2VuX3doZXJl
X2NsYXVzZV9mb3JfdGV4dF9maWx0ZXIoY29uZGl0aW9ucyk6CiAgICAiIiIKICAgIEdlbmVyYXRl
IFdIRVJFIGNsYXVzZSBmb3IgdGV4dCBmaWx0ZXJzLgoKICAgIFBhcmFtZXRlcnM6CiAgICAtIGNv
bmRpdGlvbnMgKGRpY3QpOiBEaWN0aW9uYXJ5IHdpdGggdGV4dCBmaWx0ZXIgY29uZGl0aW9ucy4K
CiAgICBSZXR1cm5zOgogICAgLSBzdHI6IFdIRVJFIGNsYXVzZSBmb3IgdGV4dCBmaWx0ZXJzLgog
ICAgIiIiCiAgICB3aGVyZV9jbGF1c2VzID0gW10KICAgIGZvciBjb2x1bW4sIChjb25kaXRpb25f
dHVwbGVzLCBsb2dpY2FsX29wZXJhdG9yKSBpbiBjb25kaXRpb25zLml0ZW1zKCk6CiAgICAgICAg
Y2xhdXNlcyA9IFtdCiAgICAgICAgZm9yIGNvbmRpdGlvbl90eXBlLCBjb25kaXRpb25fdmFsdWUg
aW4gY29uZGl0aW9uX3R1cGxlczoKICAgICAgICAgICAgaWYgY29uZGl0aW9uX3R5cGUgPT0gIkNv
bnRhaW5zIjoKICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbn0gTElLRSAn
JXtjb25kaXRpb25fdmFsdWV9JSciKQogICAgICAgICAgICBlbGlmIGNvbmRpdGlvbl90eXBlID09
ICJEb2VzIG5vdCBjb250YWluIjoKICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2Nv
bHVtbn0gTk9UIExJS0UgJyV7Y29uZGl0aW9uX3ZhbHVlfSUnIikKICAgICAgICAgICAgZWxpZiBj
b25kaXRpb25fdHlwZSA9PSAiRXF1YWxzIjoKICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5k
KGYie2NvbHVtbn0gPSAne2NvbmRpdGlvbl92YWx1ZX0nIikKICAgICAgICAgICAgZWxpZiBjb25k
aXRpb25fdHlwZSA9PSAiRG9lcyBub3QgZXF1YWwiOgogICAgICAgICAgICAgICAgY2xhdXNlcy5h
cHBlbmQoZiJ7Y29sdW1ufSAhPSAne2NvbmRpdGlvbl92YWx1ZX0nIikKICAgICAgICAgICAgZWxp
ZiBjb25kaXRpb25fdHlwZSA9PSAiQmVnaW5zIHdpdGgiOgogICAgICAgICAgICAgICAgY2xhdXNl
cy5hcHBlbmQoZiJ7Y29sdW1ufSBMSUtFICd7Y29uZGl0aW9uX3ZhbHVlfSUnIikKICAgICAgICAg
ICAgZWxpZiBjb25kaXRpb25fdHlwZSA9PSAiRW5kcyB3aXRoIjoKICAgICAgICAgICAgICAgIGNs
YXVzZXMuYXBwZW5kKGYie2NvbHVtbn0gTElLRSAnJXtjb25kaXRpb25fdmFsdWV9JSciKQogICAg
ICAgICAgICBlbGlmIGNvbmRpdGlvbl90eXBlID09ICJCbGFuayI6CiAgICAgICAgICAgICAgICBj
bGF1c2VzLmFwcGVuZChmIntjb2x1bW59IElTIE5VTEwiKQogICAgICAgICAgICBlbGlmIGNvbmRp
dGlvbl90eXBlID09ICJOb3QgYmxhbmsiOgogICAgICAgICAgICAgICAgY2xhdXNlcy5hcHBlbmQo
ZiJ7Y29sdW1ufSBJUyBOT1QgTlVMTCIpCgogICAgICAgIGlmIGNsYXVzZXM6CiAgICAgICAgICAg
IHdoZXJlX2NsYXVzZXMuYXBwZW5kKGYiICh7Zicge2xvZ2ljYWxfb3BlcmF0b3J9ICcuam9pbihj
bGF1c2VzKX0pICIpCgogICAgd2hlcmVfY2xhdXNlID0gICIgQU5EICIuam9pbih3aGVyZV9jbGF1
c2VzKSBpZiB3aGVyZV9jbGF1c2VzIGVsc2UgIiIKICAgIAogICAgcmV0dXJuIHdoZXJlX2NsYXVz
ZSBpZiB3aGVyZV9jbGF1c2UgZWxzZSAidHJ1ZSIKCgpkZWYgY2FsbF91cHNlcnRfY29ob3J0cyhz
ZXNzaW9uLCBjb2hvcnRfbmFtZSwgdGFibGVfbmFtZSwgY29sdW1uX2xpc3QsIGNvaG9ydF9zZWxl
Y3Rpb25zX2pzb24pOgogICAgIiIiCiAgICBDYWxsIHRoZSBVUFNFUlRfQ09IT1JUUyBzdG9yZWQg
cHJvY2VkdXJlIHVzaW5nIGFuIGV4aXN0aW5nIFNub3dwYXJrIHNlc3Npb24uCgogICAgOnBhcmFt
IHNlc3Npb246IFNub3dwYXJrIHNlc3Npb24gb2JqZWN0CiAgICA6cGFyYW0gY29ob3J0X25hbWU6
IE5hbWUgb2YgdGhlIGNvaG9ydAogICAgOnBhcmFtIHRhYmxlX25hbWU6IE5hbWUgb2YgdGhlIHRh
YmxlCiAgICA6cGFyYW0gY29sdW1uX2xpc3Q6IExpc3Qgb2YgY29sdW1ucyBvciBwYW5kYXMgU2Vy
aWVzCiAgICA6cGFyYW0gY29ob3J0X3NlbGVjdGlvbnNfanNvbjogSlNPTiBzdHJpbmcgb2YgZmls
dGVyIHZhbHVlcwogICAgOnJldHVybjogVGhlIHJlc3VsdCBvZiB0aGUgcHJvY2VkdXJlIGNhbGwK
ICAgICIiIgogICAgdHJ5OgogICAgICAgICMgUHJlcGFyZSB0aGUgY2FsbCB0byB0aGUgc3RvcmVk
IHByb2NlZHVyZQogICAgICAgIHByb2NfbmFtZSA9ICJDT0hPUlRfQlVJTERFUl9GT1JfU05PV0ZM
QUtFLkFQUC5VUFNFUlRfQ09IT1JUUyIKICAgICAgICAKICAgICAgICAjIEVuc3VyZSBjb2x1bW5f
bGlzdCBpcyBhIGxpc3QKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShjb2x1bW5fbGlzdCwgbGlz
dCk6CiAgICAgICAgICAgIGNvbHVtbl9saXN0ID0gY29sdW1uX2xpc3QudG9saXN0KCkKCiAgICAg
ICAgIyBDYWxsIHRoZSBzdG9yZWQgcHJvY2VkdXJlCiAgICAgICAgcmVzdWx0ID0gc2Vzc2lvbi5j
YWxsKHByb2NfbmFtZSwgY29ob3J0X25hbWUsIHRhYmxlX25hbWUsIGNvbHVtbl9saXN0LCBjb2hv
cnRfc2VsZWN0aW9uc19qc29uKQoKICAgICAgICAjIFByaW50IHRoZSByZXN1bHQKICAgICAgICBy
ZXR1cm4gcmVzdWx0CgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICMgSGFuZGxl
IGFueSBleGNlcHRpb25zIHRoYXQgbWF5IG9jY3VyCiAgICAgICAgc3Qud2FybmluZyhlKQogICAg
ICAgIHJldHVybiBOb25lCgogICAgCmRlZiBmb3JtYXRfc3FsKHNxbF9zdGF0ZW1lbnQpOgogICAg
IiIiCiAgICBGb3JtYXRzIGEgU1FMIHN0YXRlbWVudCB1c2luZyBzcWxwYXJzZSBhbmQgcmV0dXJu
cyB0aGUgZm9ybWF0dGVkIFNRTC4KCiAgICBBcmdzOgogICAgc3FsX3N0YXRlbWVudCAoc3RyKTog
VGhlIFNRTCBzdGF0ZW1lbnQgdG8gZm9ybWF0LgoKICAgIFJldHVybnM6CiAgICBzdHI6IFRoZSBm
b3JtYXR0ZWQgU1FMIHN0YXRlbWVudC4KICAgICIiIgogICAgZm9ybWF0dGVkX3NxbCA9IHNxbHBh
cnNlLmZvcm1hdChzcWxfc3RhdGVtZW50LCByZWluZGVudD1UcnVlLCBrZXl3b3JkX2Nhc2U9J3Vw
cGVyJykKICAgIHJldHVybiBmb3JtYXR0ZWRfc3FsCgpjbGFzcyBCdWlsZENvaG9ydDoKICAgIGRl
ZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAjIEluaXRpYWxpemUgc2Vzc2lvbiBzdGF0ZSB2YXJp
YWJsZXMKICAgICAgICBzZWxmLmhlYWRlcl9iZ19jb2xvciA9IHN0LnNlc3Npb25fc3RhdGUuaGVh
ZGVyX2JnX2NvbG9yCiAgICAgICAgc2VsZi5jYXJkX2JnX2NvbG9yID0gc3Quc2Vzc2lvbl9zdGF0
ZS5jYXJkX2JnX2NvbG9yCgogICAgZGVmIHNldF9wYWdlX2NvbmZpZyhzZWxmKToKICAgICAgICAi
IiIKICAgICAgICBTZXQgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBTdHJlYW1saXQgcGFnZS4K
ICAgICAgICAiIiIKICAgICAgICBzdC5zZXRfcGFnZV9jb25maWcoCiAgICAgICAgICAgIHBhZ2Vf
dGl0bGU9IkJ1aWxkIENvaG9ydCIsCiAgICAgICAgICAgIHBhZ2VfaWNvbj0i8J+RqOKAjfCfkani
gI3wn5GmIiwKICAgICAgICAgICAgbGF5b3V0PSJ3aWRlIiwKICAgICAgICAgICAgaW5pdGlhbF9z
aWRlYmFyX3N0YXRlPSJleHBhbmRlZCIKICAgICAgICApCgogICAgZGVmIHJ1bihzZWxmKToKICAg
ICAgICAiIiIKICAgICAgICBNYWluIG1ldGhvZCB0byBydW4gdGhlIGFwcGxpY2F0aW9uLgogICAg
ICAgICIiIgogICAgICAgIHNlbGYuc2V0X3BhZ2VfY29uZmlnKCkKICAgICAgICBjb2wxLCBjb2wy
LCBjb2wzLCBjb2w0ID0gc3QuY29sdW1ucyhbMSwxLDEsMV0pCgogICAgICAgIHNlbGVjdF9kYXRh
c2V0ID0gU2VsZWN0RGF0YXNldCgpCiAgICAgICAgZGF0YV9kaWN0aW9uYXJ5ID0gRGF0YURpY3Rp
b25hcnkoKQogICAgICAgIGZpbmFsaXplX2NvaG9ydCA9IEZpbmFsaXplQ29ob3J0KCkKICAgICAg
ICBzY2hlZHVsZV9jb2hvcnQgPSBTY2hlZHVsZUNvaG9ydHMoKQoKICAgICAgICBpZiBjb2wxLmJ1
dHRvbigiU2VsZWN0IERhdGFzZXQiLCB1c2VfY29udGFpbmVyX3dpZHRoID0gVHJ1ZSwgdHlwZSA9
ICJwcmltYXJ5IiBpZiBzdC5zZXNzaW9uX3N0YXRlLmJ1aWxkX2NvaG9ydF9zZWxlY3RlZF90YWIg
PT0gMSBlbHNlICJzZWNvbmRhcnkiKToKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5idWls
ZF9jb2hvcnRfc2VsZWN0ZWRfdGFiID0gMQogICAgICAgICAgICBzdC5yZXJ1bigpCiAgICAgICAg
aWYgY29sMi5idXR0b24oIkRhdGEgRGljdGlvbmFyeSIsIHVzZV9jb250YWluZXJfd2lkdGggPSBU
cnVlLCB0eXBlID0gInByaW1hcnkiIGlmIHN0LnNlc3Npb25fc3RhdGUuYnVpbGRfY29ob3J0X3Nl
bGVjdGVkX3RhYiA9PSAyIGVsc2UgInNlY29uZGFyeSIpOgogICAgICAgICAgICBzdC5zZXNzaW9u
X3N0YXRlLmJ1aWxkX2NvaG9ydF9zZWxlY3RlZF90YWIgPSAyCiAgICAgICAgICAgIHN0LnJlcnVu
KCkKICAgICAgICBpZiBjb2wzLmJ1dHRvbigiQnVpbGQgQ29ob3J0IiwgdXNlX2NvbnRhaW5lcl93
aWR0aCA9IFRydWUsIHR5cGUgPSAicHJpbWFyeSIgaWYgc3Quc2Vzc2lvbl9zdGF0ZS5idWlsZF9j
b2hvcnRfc2VsZWN0ZWRfdGFiID09IDMgZWxzZSAic2Vjb25kYXJ5Iik6CiAgICAgICAgICAgIHN0
LnNlc3Npb25fc3RhdGUuYnVpbGRfY29ob3J0X3NlbGVjdGVkX3RhYiA9IDMKICAgICAgICAgICAg
c3QucmVydW4oKQogICAgICAgIGlmIGNvbDQuYnV0dG9uKCJTY2hlZHVsZSBDb2hvcnQiLCB1c2Vf
Y29udGFpbmVyX3dpZHRoID0gVHJ1ZSwgdHlwZSA9ICJwcmltYXJ5IiBpZiBzdC5zZXNzaW9uX3N0
YXRlLmJ1aWxkX2NvaG9ydF9zZWxlY3RlZF90YWIgPT0gNCBlbHNlICJzZWNvbmRhcnkiKToKICAg
ICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5idWlsZF9jb2hvcnRfc2VsZWN0ZWRfdGFiID0gNAog
ICAgICAgICAgICBzdC5yZXJ1bigpCgogICAgICAgIGlmIHN0LnNlc3Npb25fc3RhdGUuYnVpbGRf
Y29ob3J0X3NlbGVjdGVkX3RhYiA9PSAxOgogICAgICAgICAgICByZW5kZXJfaGVhZGVyKCdEYXRh
IE1vZGVsJywgJycpCiAgICAgICAgICAgIHNlbGVjdF9kYXRhc2V0LnJ1bigpCgogICAgICAgIGlm
IHN0LnNlc3Npb25fc3RhdGUuYnVpbGRfY29ob3J0X3NlbGVjdGVkX3RhYiA9PSAyOgogICAgICAg
ICAgICByZW5kZXJfaGVhZGVyKCdEYXRhIERpY3Rpb25hcnknLCAKICAgICAgICAgICAgICAgICAg
ICAgICAgICAnQ2hvb3NlIHByaW1hcnkgYW5kIHNlY29uZGFyeSBmaWx0ZXJzIGZyb20gdGhlIGNv
bHVtbnMgYmVsb3cuIFByaW1hcnkgZmlsdGVycyB3aWxsIGJlIGFwcGxpZWQgZmlyc3QgdG8gcmVk
dWNlIHRoZSBkYXRhc2V0IHNpemUsIGZvbGxvd2VkIGJ5IHNlY29uZGFyeSBmaWx0ZXJzIHRvIGZp
bmFsaXplIHlvdXIgY29ob3J0LiBDbGljayAnJ1Byb2Nlc3MgTWV0YWRhdGEnJyB0byBzdGFydCBw
cm9jZXNzaW5nIHRoZSBkYXRhLicKICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgIGRhdGFfZGljdGlvbmFyeS5ydW4oKSAgIAoKICAgICAgICBpZiBzdC5zZXNzaW9uX3N0YXRl
LmJ1aWxkX2NvaG9ydF9zZWxlY3RlZF90YWIgPT0gMzoKICAgICAgICAgICAgc3Quc2Vzc2lvbl9z
dGF0ZS5zaG93X2RpYWxvZyA9IEZhbHNlCiAgICAgICAgICAgIHJlbmRlcl9oZWFkZXIoJ0J1aWxk
IENvaG9ydCcsICdGaXJzdCB1c2UgdGhlIFByaW1hcnkgRmlsdGVycyBvbiB0aGUgc2lkZWJhciB0
byBmaWx0ZXIgZG93biB0aGUgZGF0YXNldC4gVGhlIFNlY29uZGFyeSBGaWx0ZXJzIGFyZSB0aGVu
IHBvcHVsYXRlZCBmb3IgeW91IHRvIGJ1aWxkIHlvdXIgQ29ob3J0LicpCiAgICAgICAgICAgIGZp
bmFsaXplX2NvaG9ydC5ydW4oKSAgCgogICAgICAgIGlmIHN0LnNlc3Npb25fc3RhdGUuYnVpbGRf
Y29ob3J0X3NlbGVjdGVkX3RhYiA9PSA0OgogICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNo
b3dfZGlhbG9nID0gRmFsc2UKICAgICAgICAgICAgcmVuZGVyX2hlYWRlcignU2NoZWR1bGUgQ29o
b3J0JywgJ0ZpcnN0IHVzZSB0aGUgUHJpbWFyeSBGaWx0ZXJzIG9uIHRoZSBzaWRlYmFyIHRvIGZp
bHRlciBkb3duIHRoZSBkYXRhc2V0LiBUaGUgU2Vjb25kYXJ5IEZpbHRlcnMgYXJlIHRoZW4gcG9w
dWxhdGVkIGZvciB5b3UgdG8gYnVpbGQgeW91ciBDb2hvcnQuJykKICAgICAgICAgICAgc2NoZWR1
bGVfY29ob3J0LnJ1bigpICAKCgpjbGFzcyBTZWxlY3REYXRhc2V0OgoKICAgIGRlZiByZW5kZXJf
dGFibGVfc2VsZWN0aW9uKHNlbGYpOgoKICAgICAgICBkYXRhYmFzZV9saXN0ID0gWycnXQogICAg
ICAgIHNjaGVtYV9saXN0ID0gWycnXQogICAgICAgIHRhYmxlX2xpc3QgPSBbJyddCgogICAgICAg
IGRhdGFiYXNlX2xpc3RbMTpdID0gZ2V0X2RhdGFiYXNlcyhzdC5zZXNzaW9uX3N0YXRlLnNlc3Np
b24pCgogICAgICAgIGRlZiBvbl9kYXRhYmFzZV9zZWxlY3Rpb24oKToKICAgICAgICAgICAgIiIi
CiAgICAgICAgICAgIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGhhbmRsZSBkYXRhYmFzZSBzZWxlY3Rp
b24gY2hhbmdlLgogICAgICAgICAgICAiIiIKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5z
ZWxlY3RlZF9kYXRhYmFzZSA9IHN0LnNlc3Npb25fc3RhdGUuZGF0YWJhc2VzCiAgICAgICAgICAg
IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfc2NoZW1hID0gJycKICAgICAgICAgICAgc3Quc2Vz
c2lvbl9zdGF0ZS5zZWxlY3RlZF90YWJsZSA9ICcnCiAgICAgICAgICAgIHNjaGVtYV9saXN0LmNs
ZWFyKCkKICAgICAgICAgICAgdGFibGVfbGlzdC5jbGVhcigpCgogICAgICAgICMgRGF0YWJhc2Ug
c2VsZWN0aW9uCiAgICAgICAgZGJfaW5kID0gZGF0YWJhc2VfbGlzdC5pbmRleChzdC5zZXNzaW9u
X3N0YXRlLnNlbGVjdGVkX2RhdGFiYXNlKSBpZiBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2Rh
dGFiYXNlIGluIGRhdGFiYXNlX2xpc3QgZWxzZSAwCiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5z
ZWxlY3RlZF9kYXRhYmFzZSA9IHN0LnNlbGVjdGJveCgKICAgICAgICAgICAgJ0RhdGFiYXNlOics
IAogICAgICAgICAgICBkYXRhYmFzZV9saXN0LCAKICAgICAgICAgICAgaW5kZXg9ZGJfaW5kLAog
ICAgICAgICAgICBrZXk9ImRhdGFiYXNlcyIsCiAgICAgICAgICAgIG9uX2NoYW5nZT1vbl9kYXRh
YmFzZV9zZWxlY3Rpb24KICAgICAgICApCgogICAgICAgICMgRmV0Y2ggc2NoZW1hcyBpZiBhIGRh
dGFiYXNlIGlzIHNlbGVjdGVkCiAgICAgICAgaWYgY2hlY2tfaGFzX2RhdGEoc3Quc2Vzc2lvbl9z
dGF0ZS5zZWxlY3RlZF9kYXRhYmFzZSk6CiAgICAgICAgICAgIHNjaGVtYV9saXN0WzE6XSA9IGdl
dF9zY2hlbWFzKHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbiwgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxl
Y3RlZF9kYXRhYmFzZSkKCiAgICAgICAgICAgIGRlZiBvbl9zY2hlbWFfc2VsZWN0aW9uKCk6CiAg
ICAgICAgICAgICAgICAiIiIKICAgICAgICAgICAgICAgIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGhh
bmRsZSBzY2hlbWEgc2VsZWN0aW9uIGNoYW5nZS4KICAgICAgICAgICAgICAgICIiIgogICAgICAg
ICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9zY2hlbWEgPSBzdC5zZXNzaW9uX3N0
YXRlLnNjaGVtYXMKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFi
bGUgPSAnJwogICAgICAgICAgICAgICAgdGFibGVfbGlzdC5jbGVhcigpCgogICAgICAgICAgICAj
IFNjaGVtYSBzZWxlY3Rpb24KICAgICAgICAgICAgc2NoX2luZCA9IHNjaGVtYV9saXN0LmluZGV4
KHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfc2NoZW1hKSBpZiBzdC5zZXNzaW9uX3N0YXRlLnNl
bGVjdGVkX3NjaGVtYSBpbiBzY2hlbWFfbGlzdCBlbHNlIDAKICAgICAgICAgICAgc3Quc2Vzc2lv
bl9zdGF0ZS5zZWxlY3RlZF9zY2hlbWEgPSBzdC5zZWxlY3Rib3goCiAgICAgICAgICAgICAgICAn
U2NoZW1hOicsIAogICAgICAgICAgICAgICAgc2NoZW1hX2xpc3QsIAogICAgICAgICAgICAgICAg
a2V5PSJzY2hlbWFzIiwKICAgICAgICAgICAgICAgIGluZGV4PXNjaF9pbmQsCiAgICAgICAgICAg
ICAgICBvbl9jaGFuZ2U9b25fc2NoZW1hX3NlbGVjdGlvbgogICAgICAgICAgICApCgogICAgICAg
ICAgICAjIEZldGNoIHRhYmxlcyBpZiBhIHNjaGVtYSBpcyBzZWxlY3RlZAogICAgICAgICAgICBp
ZiBjaGVja19oYXNfZGF0YShzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3NjaGVtYSk6CiAgICAg
ICAgICAgICAgICB0YWJsZV9saXN0WzE6XSA9IGdldF90YWJsZXMoc3Quc2Vzc2lvbl9zdGF0ZS5z
ZXNzaW9uLCBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2RhdGFiYXNlLCBzdC5zZXNzaW9uX3N0
YXRlLnNlbGVjdGVkX3NjaGVtYSkKCiAgICAgICAgICAgICAgICBkZWYgb25fdGFibGVfc2VsZWN0
aW9uKCk6CiAgICAgICAgICAgICAgICAgICAgIiIiCiAgICAgICAgICAgICAgICAgICAgQ2FsbGJh
Y2sgZnVuY3Rpb24gdG8gaGFuZGxlIHRhYmxlIHNlbGVjdGlvbiBjaGFuZ2UuCiAgICAgICAgICAg
ICAgICAgICAgIiIiCiAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3Rl
ZF90YWJsZSA9IHN0LnNlc3Npb25fc3RhdGUudGFibGVzCgogICAgICAgICAgICAgICAgIyBUYWJs
ZSBzZWxlY3Rpb24KICAgICAgICAgICAgICAgIHRibF9pbmQgPSB0YWJsZV9saXN0LmluZGV4KHN0
LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFibGUpIGlmIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfdGFibGUgaW4gdGFibGVfbGlzdCBlbHNlIDAKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25f
c3RhdGUuc2VsZWN0ZWRfdGFibGUgPSBzdC5zZWxlY3Rib3goCiAgICAgICAgICAgICAgICAgICAg
J1RhYmxlOicsIAogICAgICAgICAgICAgICAgICAgIHRhYmxlX2xpc3QsIAogICAgICAgICAgICAg
ICAgICAgIGtleT0idGFibGVzIiwKICAgICAgICAgICAgICAgICAgICBpbmRleD10YmxfaW5kLAog
ICAgICAgICAgICAgICAgICAgIG9uX2NoYW5nZT1vbl90YWJsZV9zZWxlY3Rpb24KICAgICAgICAg
ICAgICAgICkKCiAgICBkZWYgZGlzcGxheV9kYXRhKHNlbGYpOgogICAgICAgICIiIgogICAgICAg
IERpc3BsYXkgdGhlIGRhdGEgYW5kIG1ldGFkYXRhIG9mIHRoZSBzZWxlY3RlZCB0YWJsZSwgaW5j
bHVkaW5nIHN1bW1hcnkgY2FyZHMuCiAgICAgICAgIiIiCiAgICAgICAgd2l0aCBzdC5jb250YWlu
ZXIoKToKICAgICAgICAgICAgIyBIZWFkZXIgd2l0aCBpY29uCiAgICAgICAgICAgIGMgPSBzdC5j
b250YWluZXIoKQoKICAgICAgICAgICAgIyBHZW5lcmF0ZSBjYXJkcwogICAgICAgICAgICByb3df
Y2FyZCA9IGNyZWF0ZV9tZXRhZGF0YWNhcmRfaHRtbCgKICAgICAgICAgICAgICAgIGhlYWRlcj0i
Um93cyIsCiAgICAgICAgICAgICAgICB2YWx1ZT1jb252ZXJ0X3RvX2tfbShzdC5zZXNzaW9uX3N0
YXRlLnJvd19jb3VudCksCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0iUm93cyIsCiAgICAg
ICAgICAgICAgICBjYXJkX2JnX2NvbG9yPXN0LnNlc3Npb25fc3RhdGUuY2FyZF9iZ19jb2xvciwK
ICAgICAgICAgICAgICAgIGhlYWRlcl9iZ19jb2xvcj1zdC5zZXNzaW9uX3N0YXRlLmhlYWRlcl9i
Z19jb2xvcgogICAgICAgICAgICApCgogICAgICAgICAgICBtZW1vcnlfY2FyZCA9IGNyZWF0ZV9t
ZXRhZGF0YWNhcmRfaHRtbCgKICAgICAgICAgICAgICAgIGhlYWRlcj0iTWVtb3J5IiwKICAgICAg
ICAgICAgICAgIHZhbHVlPWYie3N0LnNlc3Npb25fc3RhdGUudGFibGVfc2l6ZV9tYn0iIGlmIHN0
LnNlc3Npb25fc3RhdGUudGFibGVfc2l6ZV9tYiBpcyBub3QgTm9uZSBlbHNlICJOL0EiLAogICAg
ICAgICAgICAgICAgZGVzY3JpcHRpb249Ik1lbW9yeSIsCiAgICAgICAgICAgICAgICBjYXJkX2Jn
X2NvbG9yPXN0LnNlc3Npb25fc3RhdGUuY2FyZF9iZ19jb2xvciwKICAgICAgICAgICAgICAgIGhl
YWRlcl9iZ19jb2xvcj1zdC5zZXNzaW9uX3N0YXRlLmhlYWRlcl9iZ19jb2xvcgogICAgICAgICAg
ICApCgogICAgICAgICAgICBjb2x1bW5fY2FyZCA9IGNyZWF0ZV9tZXRhZGF0YWNhcmRfaHRtbCgK
ICAgICAgICAgICAgICAgIGhlYWRlcj0iQ29sdW1ucyIsCiAgICAgICAgICAgICAgICB2YWx1ZT1z
dC5zZXNzaW9uX3N0YXRlLmRhdGFzZXQuc2hhcGVbMV0gaWYgc3Quc2Vzc2lvbl9zdGF0ZS5kYXRh
c2V0IGlzIG5vdCBOb25lIGVsc2UgIk4vQSIsCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0i
Q29sdW1ucyIsCiAgICAgICAgICAgICAgICBjYXJkX2JnX2NvbG9yPXN0LnNlc3Npb25fc3RhdGUu
Y2FyZF9iZ19jb2xvciwKICAgICAgICAgICAgICAgIGhlYWRlcl9iZ19jb2xvcj1zdC5zZXNzaW9u
X3N0YXRlLmhlYWRlcl9iZ19jb2xvcgogICAgICAgICAgICApCgogICAgICAgICAgICAjIERpc3Bs
YXkgdGhlIGNhcmRzCiAgICAgICAgICAgIGNvbDEsIGNvbDIsIGNvbDMgPSBjLmNvbHVtbnMoMykK
ICAgICAgICAgICAgY29sMS5tYXJrZG93bihyb3dfY2FyZCwgdW5zYWZlX2FsbG93X2h0bWw9VHJ1
ZSkKICAgICAgICAgICAgY29sMi5tYXJrZG93bihtZW1vcnlfY2FyZCwgdW5zYWZlX2FsbG93X2h0
bWw9VHJ1ZSkKICAgICAgICAgICAgY29sMy5tYXJrZG93bihjb2x1bW5fY2FyZCwgdW5zYWZlX2Fs
bG93X2h0bWw9VHJ1ZSkKCiAgICAgICAgICAgIHN0Lm1hcmtkb3duKCIiIi0tLSIiIikgCiAgICAg
ICAgICAgICMgRGlzcGxheSB0aGUgZGF0YXNldAogICAgICAgICAgICBpZiBzdC5zZXNzaW9uX3N0
YXRlLmRhdGFzZXQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzdC5kYXRhZnJhbWUoc3Qu
c2Vzc2lvbl9zdGF0ZS5kYXRhc2V0LCBoaWRlX2luZGV4PVRydWUpCgogICAgZGVmIGNoZWNrX2Rh
dGFzZXRfc2VsZWN0aW9uKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENoZWNrIGlmIHRoZSBz
ZWxlY3RlZCBkYXRhc2V0IGhhcyBjaGFuZ2VkIGFuZCBmZXRjaCB0aGUgY29ycmVzcG9uZGluZyBk
YXRhIGlmIGl0IGhhcy4KICAgICAgICAiIiIKICAgICAgICBkYXRhc2V0X3NlbGVjdGlvbl9jaGFu
Z2VkID0gKAogICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2RhdGFiYXNlICE9
IHN0LnNlc3Npb25fc3RhdGUucHJldl9zZWxlY3RlZF9kYXRhYmFzZSBvcgogICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3NjaGVtYSAhPSBzdC5zZXNzaW9uX3N0YXRlLnByZXZf
c2VsZWN0ZWRfc2NoZW1hIG9yCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRf
dGFibGUgIT0gc3Quc2Vzc2lvbl9zdGF0ZS5wcmV2X3NlbGVjdGVkX3RhYmxlCiAgICAgICAgKQoK
ICAgICAgICBpZiBkYXRhc2V0X3NlbGVjdGlvbl9jaGFuZ2VkOgoKICAgICAgICAgICAgcmVzZXRf
c2Vzc2lvbl9zdGF0ZV9vbl9zZWxlY3Rpb25fY2hhbmdlKCkKCiAgICAgICAgICAgIHN0LnNlc3Np
b25fc3RhdGUucHJldl9zZWxlY3RlZF9kYXRhYmFzZSA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfZGF0YWJhc2UKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5wcmV2X3NlbGVjdGVkX3Nj
aGVtYSA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfc2NoZW1hCiAgICAgICAgICAgIHN0LnNl
c3Npb25fc3RhdGUucHJldl9zZWxlY3RlZF90YWJsZSA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfdGFibGUKCiAgICAgICAgICAgIGlmIGNoZWNrX2hhc19kYXRhKHN0LnNlc3Npb25fc3RhdGUu
c2VsZWN0ZWRfdGFibGUpOgogICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3Rl
ZF90YWJsZV9mdWxsID0gZiJ7c3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9kYXRhYmFzZX0ue3N0
LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfc2NoZW1hfS57c3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3Rl
ZF90YWJsZX0iCiAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnRhYmxlX2RhdGEgPSBm
ZXRjaF90YWJsZV9kYXRhKHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbiwgc3Quc2Vzc2lvbl9zdGF0
ZS5zZWxlY3RlZF90YWJsZV9mdWxsKQogICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5t
ZXRhZGF0YV9yYXcgPSBnZXRfdGFibGVfbWV0YWRhdGEoc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9u
LCBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3RhYmxlX2Z1bGwpCiAgICAgICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRhX3Jhd1snSVNfUFJJTUFSWSddID0gRmFsc2UKICAgICAg
ICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUubWV0YWRhdGFfcmF3WydJU19TRUNPTkRBUlknXSA9
IEZhbHNlICAgICAgICAKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZGF0YXNldCA9
IHN0LnNlc3Npb25fc3RhdGUudGFibGVfZGF0YVswXQogICAgICAgICAgICAgICAgc3Quc2Vzc2lv
bl9zdGF0ZS5yb3dfY291bnQgPSBzdC5zZXNzaW9uX3N0YXRlLnRhYmxlX2RhdGFbMV1bMF0KICAg
ICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUudGFibGVfc2l6ZV9tYiA9IGZldGNoX3RhYmxl
X3NpemUoc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9uLCBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVk
X2RhdGFiYXNlLCBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3NjaGVtYSwgc3Quc2Vzc2lvbl9z
dGF0ZS5zZWxlY3RlZF90YWJsZSkKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZHlu
YW1pY19yb3dfY291bnQgPSBzdC5zZXNzaW9uX3N0YXRlLnJvd19jb3VudAoKICAgICAgICAgICAg
ICAgIHN0LnNlc3Npb25fc3RhdGUubWV0YWRhdGEgPSBzdC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRh
X3JhdwogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiAg
ICBkZWYgcnVuKHNlbGYpOgoKICAgICAgICBzZWxmLnJlbmRlcl90YWJsZV9zZWxlY3Rpb24oKQog
ICAgICAgIGlmIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFibGU6CiAgICAgICAgICAgIGlm
IHNlbGYuY2hlY2tfZGF0YXNldF9zZWxlY3Rpb24oKToKICAgICAgICAgICAgICAgIHNlbGYuZGlz
cGxheV9kYXRhKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmICdkYXRhc2V0
JyBpbiBzdC5zZXNzaW9uX3N0YXRlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9k
YXRhKCkgICAgICAgIAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN0LndyaXRlKCJQbGVhc2Ug
c2VsZWN0IGEgZGF0YWJhc2UsIHNjaGVtYSwgYW5kIHRhYmxlIGZyb20gdGhlIHNpZGViYXIgdG8g
dmlldyBkYXRhLiIpCgoKY2xhc3MgRGF0YURpY3Rpb25hcnk6CgogICAgZGVmIGRpc3BsYXlfc2lk
ZWJhcihzZWxmKToKICAgICAgICAiIiIKICAgICAgICBEaXNwbGF5IHRoZSBzaWRlYmFyIGZvciBM
TE0gdG9nZ2xlIGFuZCBmb3JtIHN1Ym1pc3Npb24uCiAgICAgICAgIiIiCiAgICAgICAgd2l0aCBz
dC5zaWRlYmFyOgogICAgICAgICAgICB3aXRoIHN0LmZvcm0oImxsbV90b2dnbGVfZm9ybSIpOgog
ICAgICAgICAgICAgICAgbGxtX2RhdGFfZGljdCA9IHN0LmNoZWNrYm94KAogICAgICAgICAgICAg
ICAgICAgICJVc2UgTExNIGZvciBEYXRhIERpY3Rpb25hcnk/IiwKICAgICAgICAgICAgICAgICAg
ICB2YWx1ZT1zdC5zZXNzaW9uX3N0YXRlLmxsbV9kYXRhX2RpY3QsCiAgICAgICAgICAgICAgICAg
ICAgaGVscD0iU2VsZWN0aW5nIHRoaXMgb3B0aW9uIHdpbGwgdXRpbGl6ZSB0aGUgKiptaXN0cmFs
LWxhcmdlKiogTExNIG1vZGVsIHRvIGlkZW50aWZ5IGNvbHVtbiB0eXBlcyBhbmQgZmlsdGVyIHR5
cGVzIGZvciBhbGwgY29sdW1ucyBpbiB0aGUgZGF0YXNldC4gSXQgd2lsbCBhbHNvIHBvcHVsYXRl
IHRoZSBkZXNjcmlwdGlvbnMgdXNpbmcgdGhlIExMTS4gVGhpcyBwcm9jZXNzIHRha2VzIGFwcHJv
eGltYXRlbHkgb25lIG1pbnV0ZS4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBs
bG1fdG9nZ2xlX3N1Ym1pdCA9IHN0LmZvcm1fc3VibWl0X2J1dHRvbigiVXBkYXRlIERpY3Rpb25h
cnkiKQoKICAgICAgICAgICAgICAgIGlmIGxsbV90b2dnbGVfc3VibWl0OgogICAgICAgICAgICAg
ICAgICAgIHN0LnNlc3Npb25fc3RhdGUubGxtX2RhdGFfZGljdCA9IGxsbV9kYXRhX2RpY3QgICMg
VXBkYXRlIHNlc3Npb24gc3RhdGUgd2l0aCB0aGUgY2hlY2tib3ggdmFsdWUKICAgICAgICAgICAg
ICAgICAgICBpZiBsbG1fZGF0YV9kaWN0OgogICAgICAgICAgICAgICAgICAgICAgICBzdGFydF90
aW1lID0gdGltZS50aW1lKCkKICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3JldHJpZXMgPSAy
CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJ5X2F0dGVtcHRzID0gMAoKICAgICAgICAgICAg
ICAgICAgICAgICAgd2hpbGUgcmV0cnlfYXR0ZW1wdHMgPD0gbWF4X3JldHJpZXM6CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YSA9IGdlbmVyYXRlX2NvbHVtbnNfaW5mb19qc29uKAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZV9kZj1zdC5zZXNzaW9uX3N0
YXRlLmRhdGFzZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX21l
dGFkYXRhX2RmPXN0LnNlc3Npb25fc3RhdGUubWV0YWRhdGFfcmF3LAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzZXNzaW9uPXN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdC5zdWNjZXNzKCJNZXRhZGF0YSBzdWNjZXNzZnVsbHkgdXBkYXRlZCB1c2luZyB0aGUg
KiptaXN0cmFsLWxhcmdlKiogTExNIG1vZGVsLiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWsgICMgRXhpdCBsb29wIGlmIHN1Y2Nlc3NmdWwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdC53YXJuaW5nKGYiQXR0ZW1wdCB7cmV0cnlfYXR0ZW1wdHMgKyAxfSBmYWlsZWQ6
IHtlfSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnlfYXR0ZW1wdHMgKz0g
MQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsYXBzZWRfdGltZSA9IHRpbWUudGlt
ZSgpIC0gc3RhcnRfdGltZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGVsYXBz
ZWRfdGltZSA+PSAxODA6ICAjIDMgbWludXRlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdC5lcnJvcigiRXhjZWVkZWQgbWF4aW11bSBhbGxvd2VkIHRpbWUgZm9yIHByb2Nl
c3NpbmcuIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAg
ICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0
YXRlLm1ldGFkYXRhID0gc3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YV9yYXcKICAgICAgICAgICAg
ICAgICAgICAgICAgc3Quc3VjY2VzcygiTWV0YWRhdGEgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgd2l0
aG91dCB1c2luZyB0aGUgTExNIG1vZGVsLiIpCgogICAgZGVmIGRpc3BsYXlfZXhwYW5kZXIoc2Vs
Zik6CiAgICAgICAgIiIiCiAgICAgICAgRGlzcGxheSB0aGUgZXhwYW5kZXIgc2VjdGlvbiBmb3Ig
ZmlsdGVyIHNlbGVjdGlvbiBhbmQgZGF0YSBlZGl0aW5nLgogICAgICAgICIiIgogICAgICAgIGRm
ID0gc3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YQogICAgICAgICMgRW5zdXJlIGFsbCBleHBlY3Rl
ZCBjb2x1bW5zIGFyZSBwcmVzZW50CiAgICAgICAgZXhwZWN0ZWRfY29sdW1ucyA9IFsnQ09MVU1O
X05BTUUnLCAnREFUQV9UWVBFJywgJ0RFU0NSSVBUSU9OJywgJ0ZJTFRFUl9UWVBFJ10KICAgICAg
ICBmb3IgY29sIGluIGV4cGVjdGVkX2NvbHVtbnM6CiAgICAgICAgICAgIGlmIGNvbCBub3QgaW4g
ZGYuY29sdW1uczoKICAgICAgICAgICAgICAgIGRmW2NvbF0gPSBOb25lCgogICAgICAgICMgQWRk
IFBSSU1BUllfRklMVEVSIGFuZCBTRUNPTkRBUllfRklMVEVSIGNvbHVtbnMgaWYgdGhleSBkbyBu
b3QgZXhpc3QKICAgICAgICBpZiAnSVNfUFJJTUFSWScgbm90IGluIGRmLmNvbHVtbnM6CiAgICAg
ICAgICAgIGRmWydJU19QUklNQVJZJ10gPSBGYWxzZQogICAgICAgIGlmICdJU19TRUNPTkRBUlkn
IG5vdCBpbiBkZi5jb2x1bW5zOgogICAgICAgICAgICBkZlsnSVNfU0VDT05EQVJZJ10gPSBGYWxz
ZQoKICAgICAgICAjIFJlb3JkZXIgdGhlIGNvbHVtbnMgYXMgc3BlY2lmaWVkCiAgICAgICAgZGYg
PSBkZltbJ0NPTFVNTl9OQU1FJywgJ0RBVEFfVFlQRScsICdERVNDUklQVElPTicsICdGSUxURVJf
VFlQRScsICdJU19QUklNQVJZJywgJ0lTX1NFQ09OREFSWSddXQoKICAgICAgICBzdC5zdWJoZWFk
ZXIoIlNlbGVjdCBGaWx0ZXJzIikKICAgICAgICB3aXRoIHN0LmNvbnRhaW5lcigpOgogICAgICAg
ICAgICAjIERpc3BsYXkgZWRpdGFibGUgRGF0YSBFZGl0b3IKICAgICAgICAgICAgZWRpdGVkX2Rm
ID0gc3QuZGF0YV9lZGl0b3IoCiAgICAgICAgICAgICAgICBkZiwKICAgICAgICAgICAgICAgIGNv
bHVtbl9jb25maWc9ewogICAgICAgICAgICAgICAgICAgICJDT0xVTU5fTkFNRSI6IHN0LmNvbHVt
bl9jb25maWcuVGV4dENvbHVtbigiQ29sdW1uIE5hbWUiLCBkaXNhYmxlZD1UcnVlKSwKICAgICAg
ICAgICAgICAgICAgICAiREFUQV9UWVBFIjogc3QuY29sdW1uX2NvbmZpZy5UZXh0Q29sdW1uKCJE
YXRhIFR5cGUiLCB3aWR0aD0ic21hbGwiLCBkaXNhYmxlZD1UcnVlKSwKICAgICAgICAgICAgICAg
ICAgICAiREVTQ1JJUFRJT04iOiBzdC5jb2x1bW5fY29uZmlnLlRleHRDb2x1bW4oIkRlc2NyaXB0
aW9uIiwgd2lkdGg9Im1lZGl1bSIpLAogICAgICAgICAgICAgICAgICAgICJGSUxURVJfVFlQRSI6
IHN0LmNvbHVtbl9jb25maWcuU2VsZWN0Ym94Q29sdW1uKCJGaWx0ZXIgVHlwZSIsIG9wdGlvbnM9
WyJkcm9wZG93biIsICJ0ZXh0IGZpbHRlciIsICJtdWx0aS1zZWxlY3QgZHJvcGRvd24iLCAiYm9v
bGVhbiBmaWx0ZXIiLCAicmFuZ2UgZmlsdGVyIiwgImFkdmFuY2VkIG51bWVyaWMgZmlsdGVyIiwg
ImFkdmFuY2VkIGRhdGUgZmlsdGVyIiwgImRhdGUgZmlsdGVyIl0pLAogICAgICAgICAgICAgICAg
ICAgICJJU19QUklNQVJZIjogc3QuY29sdW1uX2NvbmZpZy5DaGVja2JveENvbHVtbigiUHJpbWFy
eSBGaWx0ZXIiKSwKICAgICAgICAgICAgICAgICAgICAiSVNfU0VDT05EQVJZIjogc3QuY29sdW1u
X2NvbmZpZy5DaGVja2JveENvbHVtbigiU2Vjb25kYXJ5IEZpbHRlciIpLAogICAgICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgICAgIHVzZV9jb250YWluZXJfd2lkdGg9VHJ1ZSwKICAgICAgICAg
ICAgICAgIGhlaWdodD04MDAsCiAgICAgICAgICAgICAgICBoaWRlX2luZGV4PVRydWUKICAgICAg
ICAgICAgKQoKICAgICAgICAgICAgaWYgc3QuYnV0dG9uKCJDb25maXJtIFNlbGVjdGlvbiIpOgog
ICAgICAgICAgICAgICAgIyBTaG93IGEgc3Bpbm5lciB3aGlsZSBwcm9jZXNzaW5nIHRoZSBtZXRh
ZGF0YQogICAgICAgICAgICAgICAgd2l0aCBzdC5zcGlubmVyKCJQcm9jZXNzaW5nIG1ldGFkYXRh
Li4uIik6CiAgICAgICAgICAgICAgICAgICAgIyBTYXZlIHRoZSBlZGl0ZWQgZGF0YWZyYW1lIGJh
Y2sgdG8gc2Vzc2lvbiBzdGF0ZQogICAgICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
bWV0YWRhdGEgPSBlZGl0ZWRfZGYKICAgICAgICAgICAgICAgICAgICAjIFZhbGlkYXRpb24gY2hl
Y2sgZm9yIGZpbHRlciB0eXBlCiAgICAgICAgICAgICAgICAgICAgbWlzc2luZ19maWx0ZXJfdHlw
ZSA9IGVkaXRlZF9kZlsKICAgICAgICAgICAgICAgICAgICAgICAgKChlZGl0ZWRfZGZbIklTX1BS
SU1BUlkiXSA9PSBUcnVlKSB8IChlZGl0ZWRfZGZbIklTX1NFQ09OREFSWSJdID09IFRydWUpKSAm
CiAgICAgICAgICAgICAgICAgICAgICAgIChlZGl0ZWRfZGZbIkZJTFRFUl9UWVBFIl0uaXNudWxs
KCkgfCAoZWRpdGVkX2RmWyJGSUxURVJfVFlQRSJdID09ICIiKSB8IChlZGl0ZWRfZGZbIkZJTFRF
Ul9UWVBFIl0gPT0gIlVua25vd24iKSkKICAgICAgICAgICAgICAgICAgICBdCgogICAgICAgICAg
ICAgICAgICAgIGlmIG5vdCBtaXNzaW5nX2ZpbHRlcl90eXBlLmVtcHR5OgogICAgICAgICAgICAg
ICAgICAgICAgICBzdC5lcnJvcigiUGxlYXNlIHNlbGVjdCBmaWx0ZXIgdHlwZSBmb3IgYWxsIHBy
aW1hcnkgYW5kIHNlY29uZGFyeSBmaWx0ZXJzLiIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToK
ICAgICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5wcmltYXJ5X2ZpbHRlcnNf
ZGYgPSBwcm9jZXNzX2NvbHVtbnMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNz
aW9uX3N0YXRlLnNlc3Npb24sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdGVkX2Rm
W2VkaXRlZF9kZlsiSVNfUFJJTUFSWSJdID09IFRydWVdW1siQ09MVU1OX05BTUUiLCAiREFUQV9U
WVBFIiwgIkZJTFRFUl9UWVBFIl1dCiAgICAgICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAg
ICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV9maWx0ZXJzX2RmWyJJU19Q
UklNQVJZIl0gPSBUcnVlCgogICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRl
LnNlY29uZGFyeV9maWx0ZXJzX2RmID0gZWRpdGVkX2RmWwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKGVkaXRlZF9kZlsiSVNfU0VDT05EQVJZIl0gPT0gVHJ1ZSkgJiAoZWRpdGVkX2RmWyJJ
U19QUklNQVJZIl0gPT0gRmFsc2UpCiAgICAgICAgICAgICAgICAgICAgICAgIF1bWyJDT0xVTU5f
TkFNRSIsICJEQVRBX1RZUEUiLCAiRklMVEVSX1RZUEUiXV0KCiAgICAgICAgICAgICAgICAgICAg
ICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGZbIklTX1BSSU1BUlkiXSA9
IEZhbHNlCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc2V0X3Nlc3Npb25fc3RhdGVz
KCkKCiAgICAgICAgICAgICAgICAgICAgICAgIHN0LnJlcnVuKCkKCgogICAgZGVmIHJlc2V0X3Nl
c3Npb25fc3RhdGVzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJlc2V0IHNlc3Npb24gc3Rh
dGVzIGFmdGVyIHNhdmluZyBjaGFuZ2VzIGFuZCBwcmVwYXJpbmcgZm9yIGEgbmV3IGNvaG9ydCBi
dWlsZC4KICAgICAgICBDbGVhcnMgZXhpc3RpbmcgZGF0YSBhbmQgY29uZmlndXJhdGlvbnMsIGFu
ZCBzZXRzIHVwIG5lY2Vzc2FyeSBkZWZhdWx0cy4KICAgICAgICAiIiIKCiAgICAgICAgIyBJbml0
aWFsaXppbmcgb3IgcmVzZXR0aW5nIHNpbXBsZSBzZXNzaW9uIHN0YXRlcyB0byBkZWZhdWx0IHZh
bHVlcwogICAgICAgIGRlZmF1bHRzID0gewogICAgICAgICAgICAnZmlsdGVyX3ZhbHVlcyc6IHt9
LAogICAgICAgICAgICAncHJpbWFyeV93aGVyZV9jbGF1c2UnOiAnJywKICAgICAgICAgICAgJ2Zp
bmFsX3doZXJlX2NsYXVzZSc6ICcnLAogICAgICAgICAgICAndGV4dF9maWx0ZXJfY29uZGl0aW9u
cyc6IHt9LAogICAgICAgICAgICAnc2Vjb25kYXJ5X2ZpbHRlcl92YWx1ZXMnOiB7fSwKICAgICAg
ICAgICAgJ3Nob3dfc2Vjb25kYXJ5X2ZpbHRlcnMnOiBGYWxzZSwKICAgICAgICAgICAgJ2NvaG9y
dF9yb3dfY291bnQnOiBzdC5zZXNzaW9uX3N0YXRlLnJvd19jb3VudCwKICAgICAgICAgICAgJ2Jh
c2VfZmlsdGVyX3F1ZXJ5JzogZidTRUxFQ1QgQ09VTlQoKikgRlJPTSB7c3Quc2Vzc2lvbl9zdGF0
ZS5zZWxlY3RlZF90YWJsZV9mdWxsfSBXSEVSRSB0cnVlJywKICAgICAgICAgICAgJ2ZpbmFsX3F1
ZXJ5JzogJycsCiAgICAgICAgICAgICdzYXZlX2NoYW5nZXNfcHJlc3NlZCc6IFRydWUsCiAgICAg
ICAgICAgICdjb2xfbGlzdCc6IHN0LnNlc3Npb25fc3RhdGUuZGF0YXNldC5jb2x1bW5zLAogICAg
ICAgICAgICAnc2VsZWN0ZWRfY29sdW1uX2xpc3QnOiBzdC5zZXNzaW9uX3N0YXRlLmRhdGFzZXQu
Y29sdW1ucywKICAgICAgICAgICAgJ2ZpbHRlcl9kZic6IHBkLkRhdGFGcmFtZSgpLAogICAgICAg
ICAgICAnc2VsZWN0ZWRfZmlsdGVycyc6IHt9LCAgIyBBc3N1bWluZyBpbml0aWFsaXphdGlvbiBp
cyBuZWVkZWQKICAgICAgICAgICAgJ3ByZXZpZXdfZGF0YXNldCc6IE5vbmUsCiAgICAgICAgICAg
ICdpc19jb2hvcnRfc2F2ZWQnOiBGYWxzZSwKICAgICAgICAgICAgJ2NvaG9ydF9uYW1lJzogJycK
ICAgICAgICB9CgogICAgICAgICMgQXBwbHkgZGVmYXVsdCB2YWx1ZXMgdG8gc2Vzc2lvbiBzdGF0
ZXMsIGNyZWF0aW5nIHRoZW0gaWYgdGhleSBkb24ndCBleGlzdAogICAgICAgIGZvciBzdGF0ZSwg
dmFsdWUgaW4gZGVmYXVsdHMuaXRlbXMoKToKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZVtz
dGF0ZV0gPSB2YWx1ZQoKICAgICAgICAjIExpc3Qgb2Ygc2Vzc2lvbiBzdGF0ZXMgdG8gcmVtb3Zl
LCBpZiB0aGV5IGV4aXN0CiAgICAgICAgcmVtb3ZhYmxlX3N0YXRlcyA9IFsKICAgICAgICAgICAg
J2FkZGl0aW9uYWxfc3RhdGUxJywgICMgRXhhbXBsZSBzdGF0ZSBuYW1lcyB0aGF0IG1pZ2h0IG5l
ZWQgcmVtb3ZhbAogICAgICAgICAgICAnYWRkaXRpb25hbF9zdGF0ZTInCiAgICAgICAgXQoKICAg
ICAgICAjIFJlbW92ZSBzZXNzaW9uIHN0YXRlcyB0aGF0IGFyZSBubyBsb25nZXIgbmVlZGVkCiAg
ICAgICAgZm9yIHN0YXRlIGluIHJlbW92YWJsZV9zdGF0ZXM6CiAgICAgICAgICAgIHN0LnNlc3Np
b25fc3RhdGUucG9wKHN0YXRlLCBOb25lKSAgIyBVc2UgcG9wIHdpdGggTm9uZSB0byBhdm9pZCBL
ZXlFcnJvciBpZiB0aGUgc3RhdGUgZG9lcyBub3QgZXhpc3QKCgoKICAgIGRlZiBydW4oc2VsZik6
CiAgICAgICAgIyBFbnN1cmUgJ3NlbGVjdGVkX3RhYmxlJyBhbmQgJ2RhdGFzZXQnIGFyZSBzZXQg
aW4gc2Vzc2lvbiBzdGF0ZQogICAgICAgIGlmICdzZWxlY3RlZF90YWJsZScgaW4gc3Quc2Vzc2lv
bl9zdGF0ZSBhbmQgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF90YWJsZToKICAgICAgICAgICAg
c2VsZi5kaXNwbGF5X3NpZGViYXIoKQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfZXhwYW5kZXIo
KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN0Lndhcm5pbmcoIk5vIHRhYmxlIHNlbGVjdGVk
IG9yIGRhdGFzZXQgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGUgc2Vzc2lvbiBzdGF0ZS4iKQoKCmNs
YXNzIEZpbmFsaXplQ29ob3J0OgoKICAgIGRlZiBpbml0aWFsaXplX3Nlc3Npb25fc3RhdGUoc2Vs
Zik6CiAgICAgICAgIyBJbml0aWFsaXplIHNlc3Npb24gc3RhdGUgdmFyaWFibGVzCiAgICAgICAg
c2Vzc2lvbl9zdGF0ZV9kZWZhdWx0cyA9IHsKICAgICAgICAgICAgImZpbHRlcl92YWx1ZXMiOiB7
fSwKICAgICAgICAgICAgInNlbGVjdGVkX2ZpbHRlcnMiOiB7fSwKICAgICAgICAgICAgInByZXZp
ZXdfZGF0YXNldCI6IHBkLkRhdGFGcmFtZSgpLAogICAgICAgICAgICAic2hvd19zZWNvbmRhcnlf
ZmlsdGVycyI6IEZhbHNlLAogICAgICAgICAgICAiaXNfY29ob3J0X3NhdmVkIjogRmFsc2UsCiAg
ICAgICAgICAgICJzaG93X2RpYWxvZyI6IEZhbHNlLAogICAgICAgICAgICAiY29ob3J0X25hbWUi
OiAiIgogICAgICAgIH0KCiAgICAgICAgZm9yIGtleSwgZGVmYXVsdF92YWx1ZSBpbiBzZXNzaW9u
X3N0YXRlX2RlZmF1bHRzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGtleSBub3QgaW4gc3Quc2Vz
c2lvbl9zdGF0ZToKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGVba2V5XSA9IGRlZmF1
bHRfdmFsdWUKCiAgICBkZWYgdXBkYXRlX3NlbGVjdGVkX2ZpbHRlcnMoc2VsZik6CiAgICAgICAg
Zm9yIGtleSwgdmFsdWUgaW4gc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9maWx0ZXJzLml0ZW1z
KCk6CiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmlsdGVyX3ZhbHVlc1trZXldID0gdmFs
dWUKCiAgICBkZWYgcmVtb3ZlX3NlY29uZGFyeV9maWx0ZXJzX2Zyb21fc2Vzc2lvbl9zdGF0ZShz
ZWxmKToKICAgICAgICBjb2x1bW5zX3RvX3JlbW92ZSA9IHN0LnNlc3Npb25fc3RhdGUuc2Vjb25k
YXJ5X2ZpbHRlcnNfZGZbIkNPTFVNTl9OQU1FIl0udG9saXN0KCkKICAgICAgICAKICAgICAgICAj
IFJlbW92ZSBjb2x1bW5zIGZyb20gc2VsZWN0ZWRfZmlsdGVycwogICAgICAgIGZvciBjb2x1bW4g
aW4gY29sdW1uc190b19yZW1vdmU6CiAgICAgICAgICAgIGlmIGNvbHVtbiBpbiBzdC5zZXNzaW9u
X3N0YXRlLmZpbHRlcl92YWx1ZXMgOgogICAgICAgICAgICAgICAgZGVsIHN0LnNlc3Npb25fc3Rh
dGUuZmlsdGVyX3ZhbHVlc1tjb2x1bW5dCgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfZmlsdGVycyA9IHN0LnNlc3Npb25fc3RhdGUuZmlsdGVyX3ZhbHVlcwogICAgICAgIAogICAg
ICAgICMgUmVtb3ZlIGNvbHVtbnMgZnJvbSB0ZXh0X2ZpbHRlcl9jb25kaXRpb25zCiAgICAgICAg
Zm9yIGNvbHVtbiBpbiBjb2x1bW5zX3RvX3JlbW92ZToKICAgICAgICAgICAgaWYgY29sdW1uIGlu
IHN0LnNlc3Npb25fc3RhdGUudGV4dF9maWx0ZXJfY29uZGl0aW9uczoKICAgICAgICAgICAgICAg
IGRlbCBzdC5zZXNzaW9uX3N0YXRlLnRleHRfZmlsdGVyX2NvbmRpdGlvbnNbY29sdW1uXQogICAg
ICAgIAogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIHByZXBhcmVfZmlsdGVyX2RhdGFfZnJh
bWVzKHNlbGYsIGZpbHRlcl90eXBlKToKICAgICAgICBpZiBmaWx0ZXJfdHlwZSA9PSAiUHJpbWFy
eSI6CiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGYgPSBz
dC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmW1siQ09MVU1OX05BTUUiLCAiREFU
QV9UWVBFIiwgIkZJTFRFUl9UWVBFIl1dCiAgICAgICAgICAgIHNlbGYucmVtb3ZlX3NlY29uZGFy
eV9maWx0ZXJzX2Zyb21fc2Vzc2lvbl9zdGF0ZSgpCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3Rh
dGUuZmlsdGVyX2RmID0gc3Quc2Vzc2lvbl9zdGF0ZS5wcmltYXJ5X2ZpbHRlcnNfZGYKICAgICAg
ICBlbHNlOgogICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmZpbHRlcl9kZiA9IHBkLmNvbmNh
dChbc3Quc2Vzc2lvbl9zdGF0ZS5zZWNvbmRhcnlfZmlsdGVyc19kZiwgc3Quc2Vzc2lvbl9zdGF0
ZS5wcmltYXJ5X2ZpbHRlcnNfZGZdLCBpZ25vcmVfaW5kZXg9VHJ1ZSkKICAgIAogICAgZGVmIGdl
bmVyYXRlX2ZpbHRlcl9jbGF1c2Uoc2VsZiwgZmlsdGVyX3R5cGUpOgogICAgICAgIG5vbl90ZXh0
X2ZpbHRlcnNfY2xhdXNlID0gZ2VuX3doZXJlX2NsYXVzZV9mb3Jfbm9uX3RleHRfZmlsdGVycyhz
dC5zZXNzaW9uX3N0YXRlLmZpbHRlcl9kZiwgc3Quc2Vzc2lvbl9zdGF0ZS5maWx0ZXJfdmFsdWVz
KQogICAgICAgIHRleHRfZmlsdGVyc19jbGF1c2UgPSBnZW5fd2hlcmVfY2xhdXNlX2Zvcl90ZXh0
X2ZpbHRlcihzdC5zZXNzaW9uX3N0YXRlLnRleHRfZmlsdGVyX2NvbmRpdGlvbnMpCiAgICAgICAg
cmV0dXJuIGYiIEFORCB7bm9uX3RleHRfZmlsdGVyc19jbGF1c2V9IEFORCB7dGV4dF9maWx0ZXJz
X2NsYXVzZX0iCgoKICAgIGRlZiBhcHBseV9maWx0ZXJzKHNlbGYsIGZpbHRlcl90eXBlKToKICAg
ICAgICBzZWxmLnVwZGF0ZV9zZWxlY3RlZF9maWx0ZXJzKCkKICAgICAgICBzZWxmLnByZXBhcmVf
ZmlsdGVyX2RhdGFfZnJhbWVzKGZpbHRlcl90eXBlKQogICAgICAgIGZpbHRlcl9jbGF1c2UgPSBz
ZWxmLmdlbmVyYXRlX2ZpbHRlcl9jbGF1c2UoZmlsdGVyX3R5cGUpCiAgICAKCiAgICAgICAgaWYg
ZmlsdGVyX3R5cGUgPT0gIlByaW1hcnkiOgogICAgICAgICAgICBpZiBub3Qgc3Quc2Vzc2lvbl9z
dGF0ZS5zZWNvbmRhcnlfZmlsdGVyc19kZi5lbXB0eToKICAgICAgICAgICAgICAgIHN0LnNlc3Np
b25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGYgPSBwcm9jZXNzX2NvbHVtbnMoCiAgICAgICAg
ICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9uLAogICAgICAgICAgICAgICAgICAg
IHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGYsCiAgICAgICAgICAgICAgICAg
ICAgZmlsdGVyX2NsYXVzZQogICAgICAgICAgICAgICAgKQogICAgICAgIHN0LnNlc3Npb25fc3Rh
dGUuZmluYWxfcXVlcnkgPSBzdC5zZXNzaW9uX3N0YXRlLmJhc2VfZmlsdGVyX3F1ZXJ5ICsgZmls
dGVyX2NsYXVzZQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmNvaG9ydF9yb3dfY291bnQgPSBy
ZWFkX3NxbCgKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5maW5hbF9xdWVyeSwKICAgICAg
ICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9uLAogICAgICAgICAgICAwCiAgICAgICAgKVsw
XQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnByZXZpZXdfZGF0YXNldCA9IHJlYWRfdGFibGUo
CiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmluYWxfcXVlcnkucmVwbGFjZSgnQ09VTlQo
KiknLCAnKicpICsgJyBMSU1JVCAxMDAwJywKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5z
ZXNzaW9uCiAgICAgICAgKQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNob3dfc2Vjb25kYXJ5
X2ZpbHRlcnMgPSBUcnVlCiAgICAgICAgc3QucmVydW4oKQoKICAgIGRlZiByZW5kZXJfc2lkZWJh
cihzZWxmKToKICAgICAgICB3aXRoIHN0LmNvbnRhaW5lcigpOgogICAgICAgICAgICB3aXRoIHN0
LnNpZGViYXI6CiAgICAgICAgICAgICAgICBzdC5oZWFkZXIoIlByaW1hcnkgRmlsdGVycyIpCgog
ICAgICAgICAgICAgICAgIyBPYnRhaW4gYW5kIHNvcnQgdGhlIGRhdGFmcmFtZSBvZiBmaWx0ZXJz
CiAgICAgICAgICAgICAgICBwcmltYXJ5X2ZpbHRlcnNfZGYgPSBzdC5zZXNzaW9uX3N0YXRlLnBy
aW1hcnlfZmlsdGVyc19kZi5zb3J0X3ZhbHVlcyhieT0iRklMVEVSX1RZUEUiKQoKICAgICAgICAg
ICAgICAgICMgUmVuZGVyIGZpbHRlcnMgdGhhdCBhcmUgbm90IG51bWVyaWMgb3IgZGF0ZSBhZHZh
bmNlZCBmaWx0ZXJzCiAgICAgICAgICAgICAgICBmb3IgaW5kZXgsIHJvdyBpbiBwcmltYXJ5X2Zp
bHRlcnNfZGYuaXRlcnJvd3MoKToKICAgICAgICAgICAgICAgICAgICBpZiByb3dbIkZJTFRFUl9U
WVBFIl0gbm90IGluIFsnYWR2YW5jZWQgbnVtZXJpYyBmaWx0ZXInLCAnYWR2YW5jZWQgZGF0ZSBm
aWx0ZXInXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW5kZXJfZmlsdGVyKHJvdykK
CiAgICAgICAgICAgICAgICBzdC5kaXZpZGVyKCkKCiAgICAgICAgICAgICAgICAjIFNlY3Rpb24g
Zm9yIEFkdmFuY2VkIE51bWVyaWMgRmlsdGVycwogICAgICAgICAgICAgICAgZm9yIGluZGV4LCBy
b3cgaW4gcHJpbWFyeV9maWx0ZXJzX2RmLml0ZXJyb3dzKCk6CiAgICAgICAgICAgICAgICAgICAg
aWYgcm93WyJGSUxURVJfVFlQRSJdID09ICdhZHZhbmNlZCBudW1lcmljIGZpbHRlcic6CiAgICAg
ICAgICAgICAgICAgICAgICAgIHNlbGYucmVuZGVyX2ZpbHRlcihyb3cpCgogICAgICAgICAgICAg
ICAgc3QuZGl2aWRlcigpCgogICAgICAgICAgICAgICAgIyBTZWN0aW9uIGZvciBBZHZhbmNlZCBE
YXRlIEZpbHRlcnMKICAgICAgICAgICAgICAgIGZvciBpbmRleCwgcm93IGluIHByaW1hcnlfZmls
dGVyc19kZi5pdGVycm93cygpOgogICAgICAgICAgICAgICAgICAgIGlmIHJvd1siRklMVEVSX1RZ
UEUiXSA9PSAnYWR2YW5jZWQgZGF0ZSBmaWx0ZXInOgogICAgICAgICAgICAgICAgICAgICAgICBz
ZWxmLnJlbmRlcl9maWx0ZXIocm93KQoKICAgICAgICAgICAgICAgICMgQnV0dG9uIHRvIGFwcGx5
IHByaW1hcnkgZmlsdGVycwogICAgICAgICAgICAgICAgaWYgc3QuYnV0dG9uKCJBcHBseSAtIFBy
aW1hcnkgRmlsdGVycyIsIHR5cGU9InByaW1hcnkiKToKICAgICAgICAgICAgICAgICAgICBzZWxm
LmFwcGx5X2ZpbHRlcnMoIlByaW1hcnkiKQogICAgICAgICAgICAgICAgICAgIHN0LnNlc3Npb25f
c3RhdGUuZmlsdGVyX2RmID0gc3Quc2Vzc2lvbl9zdGF0ZS5wcmltYXJ5X2ZpbHRlcnNfZGYKICAg
ICAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNob3dfc2Vjb25kYXJ5X2ZpbHRlcnMg
PSBUcnVlCgoKICAgIGRlZiByZW5kZXJfZmlsdGVyKHNlbGYsIHJvdyk6CiAgICAgICAgZmlsdGVy
X3R5cGUgPSByb3dbIkZJTFRFUl9UWVBFIl0KICAgICAgICBjb2x1bW5fbmFtZSA9IHJvd1siQ09M
VU1OX05BTUUiXQogICAgICAgIGRpc3RpbmN0X3ZhbHVlcyA9IGpzb24ubG9hZHMocm93WyJESVNU
SU5DVF9WQUxVRVMiXSkgaWYgcm93LmdldCgiRElTVElOQ1RfVkFMVUVTIikgZWxzZSBbXQogICAg
ICAgIG1pbl92YWx1ZSA9IHJvdy5nZXQoIk1JTl9WQUxVRSIsIE5vbmUpCiAgICAgICAgbWF4X3Zh
bHVlID0gcm93LmdldCgiTUFYX1ZBTFVFIiwgTm9uZSkKICAgICAgICB3aGVyZV9jbGF1c2VzID0g
W10KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBib2xkX2NvbHVtbl9uYW1lID0gZiIqKntjb2x1
bW5fbmFtZX0qKiIKCiAgICAgICAgICAgIGlmIGZpbHRlcl90eXBlID09ICJkcm9wZG93biI6CiAg
ICAgICAgICAgICAgICBjdXJyZW50X3ZhbHVlID0gc3Quc2Vzc2lvbl9zdGF0ZS5maWx0ZXJfdmFs
dWVzLmdldChjb2x1bW5fbmFtZSwgTm9uZSkKICAgICAgICAgICAgICAgIGRlZmF1bHRfaW5kZXgg
PSBkaXN0aW5jdF92YWx1ZXMuaW5kZXgoY3VycmVudF92YWx1ZSkgaWYgY3VycmVudF92YWx1ZSBp
biBkaXN0aW5jdF92YWx1ZXMgZWxzZSBOb25lCgogICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9z
dGF0ZS5zZWxlY3RlZF9maWx0ZXJzW2NvbHVtbl9uYW1lXSA9IHN0LnNlbGVjdGJveCgKICAgICAg
ICAgICAgICAgICAgICBib2xkX2NvbHVtbl9uYW1lLAogICAgICAgICAgICAgICAgICAgIG9wdGlv
bnM9ZGlzdGluY3RfdmFsdWVzLAogICAgICAgICAgICAgICAgICAgIGluZGV4PWRlZmF1bHRfaW5k
ZXgsCiAgICAgICAgICAgICAgICAgICAga2V5PWYie2NvbHVtbl9uYW1lfV9kcm9wZG93biIKICAg
ICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5cGUgPT0gJ211bHRpLXNl
bGVjdCBkcm9wZG93bic6CiAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVk
X2ZpbHRlcnNbY29sdW1uX25hbWVdID0gc3QubXVsdGlzZWxlY3QoCiAgICAgICAgICAgICAgICAg
ICAgYm9sZF9jb2x1bW5fbmFtZSwKICAgICAgICAgICAgICAgICAgICBvcHRpb25zPWRpc3RpbmN0
X3ZhbHVlcywKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0PXN0LnNlc3Npb25fc3RhdGUuZmls
dGVyX3ZhbHVlcy5nZXQoY29sdW1uX25hbWUsIFtdKSwKICAgICAgICAgICAgICAgICAgICBrZXk9
ZiJ7Y29sdW1uX25hbWV9X211bHRpc2VsZWN0IgogICAgICAgICAgICAgICAgKQoKICAgICAgICAg
ICAgZWxpZiBmaWx0ZXJfdHlwZSA9PSAnZGF0ZSBmaWx0ZXInOgogICAgICAgICAgICAgICAgaWYg
bm90IG1pbl92YWx1ZSBvciBub3QgbWF4X3ZhbHVlOgogICAgICAgICAgICAgICAgICAgIHN0Lndh
cm5pbmcoZiJNaW4gb3IgTWF4IGRhdGUgbm90IHNwZWNpZmllZCBmb3Ige2NvbHVtbl9uYW1lfSIp
CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICAgICAgbWluX2RhdGUgPSBw
ZC50b19kYXRldGltZShtaW5fdmFsdWUpLmRhdGUoKQogICAgICAgICAgICAgICAgbWF4X2RhdGUg
PSBwZC50b19kYXRldGltZShtYXhfdmFsdWUpLmRhdGUoKQoKICAgICAgICAgICAgICAgIGNvbHVt
bl9maWx0ZXJzID0gc3Quc2Vzc2lvbl9zdGF0ZS5maWx0ZXJfdmFsdWVzLmdldChjb2x1bW5fbmFt
ZSkKCiAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2ZpbHRlcnNbY29s
dW1uX25hbWVdID0gc3Quc2xpZGVyKAogICAgICAgICAgICAgICAgICAgIGJvbGRfY29sdW1uX25h
bWUsCiAgICAgICAgICAgICAgICAgICAgbWluX3ZhbHVlPW1pbl9kYXRlLAogICAgICAgICAgICAg
ICAgICAgIG1heF92YWx1ZT1tYXhfZGF0ZSwKICAgICAgICAgICAgICAgICAgICB2YWx1ZT0oCiAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbl9maWx0ZXJzWzBdIGlmIGNvbHVtbl9maWx0ZXJz
IGVsc2UgbWluX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbl9maWx0ZXJzWzFd
IGlmIGNvbHVtbl9maWx0ZXJzIGVsc2UgbWF4X2RhdGUKICAgICAgICAgICAgICAgICAgICApLAog
ICAgICAgICAgICAgICAgICAgIGZvcm1hdD0iTU0vREQvWVlZWSIsCiAgICAgICAgICAgICAgICAg
ICAga2V5PWYie2NvbHVtbl9uYW1lfV9kYXRlZmlsdGVyIgogICAgICAgICAgICAgICAgKQoKICAg
ICAgICAgICAgZWxpZiBmaWx0ZXJfdHlwZSA9PSAndGV4dCBmaWx0ZXInOgogICAgICAgICAgICAg
ICAgc3QubWFya2Rvd24oZiIqKntjb2x1bW5fbmFtZX06KioiKQogICAgICAgICAgICAgICAgdGV4
dF9maWx0ZXIgPSBUZXh0RmlsdGVyRGlhbG9nKGNvbHVtbl9uYW1lKQogICAgICAgICAgICAgICAg
dGV4dF9maWx0ZXIuZGlzcGxheSgpCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09ICdi
b29sZWFuIGZpbHRlcic6CiAgICAgICAgICAgICAgICBjdXJyZW50X3ZhbHVlID0gc3Quc2Vzc2lv
bl9zdGF0ZS5maWx0ZXJfdmFsdWVzLmdldChjb2x1bW5fbmFtZSwgRmFsc2UpCiAgICAgICAgICAg
ICAgICBzdC53cml0ZSgiIikKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfZmlsdGVyc1tjb2x1bW5fbmFtZV0gPSBzdC5jaGVja2JveCgKICAgICAgICAgICAgICAgICAg
ICBib2xkX2NvbHVtbl9uYW1lLAogICAgICAgICAgICAgICAgICAgIHZhbHVlPWN1cnJlbnRfdmFs
dWUsCiAgICAgICAgICAgICAgICAgICAga2V5PWYie2NvbHVtbl9uYW1lfV9ib29sZWFuZmlsdGVy
IgogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgZWxpZiBmaWx0ZXJfdHlwZSA9PSAncmFu
Z2UgZmlsdGVyJzoKICAgICAgICAgICAgICAgIGlmIG1pbl92YWx1ZSBpcyBOb25lIG9yIG1heF92
YWx1ZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0Lndhcm5pbmcoZiJNaW4gb3IgTWF4
IHZhbHVlIG5vdCBzcGVjaWZpZWQgZm9yIHtjb2x1bW5fbmFtZX0iKQogICAgICAgICAgICAgICAg
ICAgIHJldHVybgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG1pbl92
YWx1ZSA9IGludChtaW5fdmFsdWUpCiAgICAgICAgICAgICAgICAgICAgbWF4X3ZhbHVlID0gaW50
KG1heF92YWx1ZSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAg
ICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgbWluX3ZhbHVlID0gZmxvYXQo
bWluX3ZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICBtYXhfdmFsdWUgPSBmbG9hdChtYXhf
dmFsdWUpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAg
ICAgICAgICAgICAgIHN0Lndhcm5pbmcoZiJJbnZhbGlkIE1pbiBvciBNYXggdmFsdWUgZm9yIHtj
b2x1bW5fbmFtZX0iKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAg
ICAgICBpZiBtaW5fdmFsdWUgPT0gbWF4X3ZhbHVlOgogICAgICAgICAgICAgICAgICAgIHN0Lm1h
cmtkb3duKGYiKip7Y29sdW1uX25hbWV9OioqIikKICAgICAgICAgICAgICAgICAgICBzdC5tYXJr
ZG93bihmIjpyZWRbSGFzIG9ubHkgb25lIHZhbHVlOiAqKnttaW5fdmFsdWV9KipdIikKICAgICAg
ICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY29sdW1uX2ZpbHRlcnMgPSBzdC5z
ZXNzaW9uX3N0YXRlLmZpbHRlcl92YWx1ZXMuZ2V0KGNvbHVtbl9uYW1lKQogICAgICAgICAgICAg
ICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxl
Y3RlZF9maWx0ZXJzW2NvbHVtbl9uYW1lXSA9IHN0LnNsaWRlcigKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGJvbGRfY29sdW1uX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBt
aW5fdmFsdWU9bWluX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3ZhbHVl
PW1heF92YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSgKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpbnQoY29sdW1uX2ZpbHRlcnNbMF0pIGlmIGNvbHVtbl9m
aWx0ZXJzIGVsc2UgbWluX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu
dChjb2x1bW5fZmlsdGVyc1sxXSkgaWYgY29sdW1uX2ZpbHRlcnMgZWxzZSBtYXhfdmFsdWUKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBr
ZXk9ZiJ7Y29sdW1uX25hbWV9X3JhbmdlZmlsdGVyIgogICAgICAgICAgICAgICAgICAgICAgICAp
CiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBzdC5z
ZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2ZpbHRlcnNbY29sdW1uX25hbWVdID0gc3Quc2xpZGVyKAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9sZF9jb2x1bW5fbmFtZSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG1pbl92YWx1ZT1taW5fdmFsdWUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBtYXhfdmFsdWU9bWF4X3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
dmFsdWU9KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0KGNvbHVtbl9maWx0
ZXJzWzBdKSBpZiBjb2x1bW5fZmlsdGVycyBlbHNlIG1pbl92YWx1ZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmbG9hdChjb2x1bW5fZmlsdGVyc1sxXSkgaWYgY29sdW1uX2ZpbHRl
cnMgZWxzZSBtYXhfdmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBrZXk9ZiJ7Y29sdW1uX25hbWV9X3JhbmdlZmlsdGVyIgogICAg
ICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09ICdh
ZHZhbmNlZCBkYXRlIGZpbHRlcic6CiAgICAgICAgICAgICAgICBkaXN0aW5jdF92YWx1ZXMgPSBb
IiIsICJncmVhdGVyIHRoYW4gb3IgZXF1YWwiLCAibGVzcyB0aGFuIG9yIGVxdWFsIl0KCiAgICAg
ICAgICAgICAgICBzZWxlY3RlZF9maWx0ZXIgPSBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2Zp
bHRlcnMuZ2V0KGNvbHVtbl9uYW1lLCBOb25lKQogICAgICAgICAgICAgICAgaWYgc2VsZWN0ZWRf
ZmlsdGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICMgQ2hlY2sgaWYgc2VsZWN0
ZWRfZmlsdGVyIGlzIGEgUHl0aG9uIGRpY3Rpb25hcnkKICAgICAgICAgICAgICAgICAgICBpZiBp
c2luc3RhbmNlKHNlbGVjdGVkX2ZpbHRlciwgZGljdCk6CiAgICAgICAgICAgICAgICAgICAgICAg
IGN1cnJlbnRfdmFsdWUgPSBzZWxlY3RlZF9maWx0ZXIuZ2V0KCJjb25kaXRpb24iLCBOb25lKQog
ICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHN0LmVycm9y
KGYiU2VsZWN0ZWQgZmlsdGVyIGZvciB7Y29sdW1uX25hbWV9IGlzIG5vdCBhIHZhbGlkIFB5dGhv
biBkaWN0aW9uYXJ5LiIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAg
ICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3ZhbHVlID0gTm9uZQoKICAg
ICAgICAgICAgICAgIGlmIGN1cnJlbnRfdmFsdWUgaXMgbm90IE5vbmUgYW5kIGN1cnJlbnRfdmFs
dWUgaW4gZGlzdGluY3RfdmFsdWVzOgogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRfaW5kZXgg
PSBkaXN0aW5jdF92YWx1ZXMuaW5kZXgoY3VycmVudF92YWx1ZSkKICAgICAgICAgICAgICAgIGVs
c2U6CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF9pbmRleCA9IE5vbmUKCiAgICAgICAgICAg
ICAgICBpZiBub3QgbWluX3ZhbHVlIG9yIG5vdCBtYXhfdmFsdWU6CiAgICAgICAgICAgICAgICAg
ICAgc3Qud2FybmluZyhmIk1pbiBvciBNYXggZGF0ZSBub3Qgc3BlY2lmaWVkIGZvciB7Y29sdW1u
X25hbWV9IikKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIHRyeToK
ICAgICAgICAgICAgICAgICAgICBtaW5fZGF0ZSA9IHBkLnRvX2RhdGV0aW1lKG1pbl92YWx1ZSkK
ICAgICAgICAgICAgICAgICAgICBtYXhfZGF0ZSA9IHBkLnRvX2RhdGV0aW1lKG1heF92YWx1ZSkK
ICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgIHN0
Lndhcm5pbmcoZiJJbnZhbGlkIE1pbiBvciBNYXggZGF0ZSBmb3Ige2NvbHVtbl9uYW1lfSIpCiAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICAgICAgc3QubWFya2Rvd24oYm9s
ZF9jb2x1bW5fbmFtZSkKICAgICAgICAgICAgICAgIGNvbmRpdGlvbiA9IHN0LnNlbGVjdGJveCgK
ICAgICAgICAgICAgICAgICAgICBmIntjb2x1bW5fbmFtZX1fY29uZGl0aW9uIiwKICAgICAgICAg
ICAgICAgICAgICBvcHRpb25zPWRpc3RpbmN0X3ZhbHVlcywKICAgICAgICAgICAgICAgICAgICBr
ZXk9ZiJ7Y29sdW1uX25hbWV9X2NvbmRpdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgaW5kZXgg
PSBkZWZhdWx0X2luZGV4CiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgdHJ5Ogog
ICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX2RhdGUgPSBwZC50b19kYXRldGltZShzdC5zZXNz
aW9uX3N0YXRlLnNlbGVjdGVkX2ZpbHRlcnNbY29sdW1uX25hbWVdLmdldCgidmFsdWUiLCBtaW5f
ZGF0ZSkpCiAgICAgICAgICAgICAgICBleGNlcHQgKEtleUVycm9yLCBUeXBlRXJyb3IsIFZhbHVl
RXJyb3IpOgogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX2RhdGUgPSBtaW5fZGF0ZQoKICAg
ICAgICAgICAgICAgIHNlbGVjdGVkX2RhdGUgPSBzdC5kYXRlX2lucHV0KAogICAgICAgICAgICAg
ICAgICAgIGYie2NvbHVtbl9uYW1lfV92YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAgbWluX3Zh
bHVlPW1pbl9kYXRlLAogICAgICAgICAgICAgICAgICAgIG1heF92YWx1ZT1tYXhfZGF0ZSwKICAg
ICAgICAgICAgICAgICAgICB2YWx1ZT1zZWxlY3RlZF9kYXRlCiAgICAgICAgICAgICAgICApCiAg
ICAgICAgICAgICAgICBkYXRlX3N0cmluZyA9IHNlbGVjdGVkX2RhdGUuc3RyZnRpbWUoJyVZLSVt
LSVkJykKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfZmlsdGVyc1tj
b2x1bW5fbmFtZV0gPSB7ImNvbmRpdGlvbiI6IGNvbmRpdGlvbiwgInZhbHVlIjogZGF0ZV9zdHJp
bmd9CgoKICAgICAgICAgICAgZWxpZiBmaWx0ZXJfdHlwZSA9PSAnYWR2YW5jZWQgbnVtZXJpYyBm
aWx0ZXInOgogICAgICAgICAgICAgICAgaWYgbWluX3ZhbHVlIGlzIE5vbmUgb3IgbWF4X3ZhbHVl
IGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc3Qud2FybmluZyhmIk1pbiBvciBNYXggdmFs
dWUgbm90IHNwZWNpZmllZCBmb3Ige2NvbHVtbl9uYW1lfSIpCiAgICAgICAgICAgICAgICAgICAg
cmV0dXJuCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgbWluX3ZhbHVl
ID0gZmxvYXQobWluX3ZhbHVlKQogICAgICAgICAgICAgICAgICAgIG1heF92YWx1ZSA9IGZsb2F0
KG1heF92YWx1ZSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAg
ICAgICAgICAgIHN0Lndhcm5pbmcoZiJJbnZhbGlkIE1pbiBvciBNYXggdmFsdWUgZm9yIHtjb2x1
bW5fbmFtZX0iKQogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgICAgIGRp
c3RpbmN0X3ZhbHVlcyA9IFsiIiwiZ3JlYXRlciB0aGFuIiwgImxlc3MgdGhhbiIsICJlcXVhbCB0
byIsICJiZXR3ZWVuIl0KCiAgICAgICAgICAgICAgICBzZWxlY3RlZF9maWx0ZXIgPSBzdC5zZXNz
aW9uX3N0YXRlLnNlbGVjdGVkX2ZpbHRlcnMuZ2V0KGNvbHVtbl9uYW1lLCBOb25lKQogICAgICAg
ICAgICAgICAgaWYgc2VsZWN0ZWRfZmlsdGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAg
ICAgIGN1cnJlbnRfdmFsdWUgPSBzZWxlY3RlZF9maWx0ZXIuZ2V0KCJjb25kaXRpb24iLCBOb25l
KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3ZhbHVl
ID0gTm9uZQoKICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRfdmFsdWUgaXMgbm90IE5vbmUgYW5k
IGN1cnJlbnRfdmFsdWUgaW4gZGlzdGluY3RfdmFsdWVzOgogICAgICAgICAgICAgICAgICAgIGRl
ZmF1bHRfaW5kZXggPSBkaXN0aW5jdF92YWx1ZXMuaW5kZXgoY3VycmVudF92YWx1ZSkKICAgICAg
ICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF9pbmRleCA9IE5vbmUK
CiAgICAgICAgICAgICAgICBzdC5tYXJrZG93bihib2xkX2NvbHVtbl9uYW1lKQogICAgICAgICAg
ICAgICAgY29uZGl0aW9uID0gc3Quc2VsZWN0Ym94KAogICAgICAgICAgICAgICAgICAgIGYie2Nv
bHVtbl9uYW1lfV9jb25kaXRpb24iLAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9ZGlzdGlu
Y3RfdmFsdWVzLAogICAgICAgICAgICAgICAgICAgIGtleT1mIntjb2x1bW5fbmFtZX1fY29uZGl0
aW9uIiwKICAgICAgICAgICAgICAgICAgICBpbmRleD1kZWZhdWx0X2luZGV4CiAgICAgICAgICAg
ICAgICApCgogICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uID09ICJiZXR3ZWVuIjoKICAgICAg
ICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHN0LnNl
c3Npb25fc3RhdGUuc2VsZWN0ZWRfZmlsdGVyc1tjb2x1bW5fbmFtZV0KICAgICAgICAgICAgICAg
ICAgICAgICAgdmFsdWUxID0gZmxvYXQodmFsdWVzLmdldCgidmFsdWUxIiwgbWluX3ZhbHVlKSkK
ICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUyID0gZmxvYXQodmFsdWVzLmdldCgidmFsdWUy
IiwgbWF4X3ZhbHVlKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgKEtleUVycm9yLCBUeXBl
RXJyb3IpOgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTEgPSBtaW5fdmFsdWUKICAgICAg
ICAgICAgICAgICAgICAgICAgdmFsdWUyID0gbWF4X3ZhbHVlCgogICAgICAgICAgICAgICAgICAg
IGNvbDEsIGNvbDIgPSBzdC5jb2x1bW5zKDIpCiAgICAgICAgICAgICAgICAgICAgd2l0aCBjb2wx
OgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTEgPSBzdC5udW1iZXJfaW5wdXQoZiJ7Y29s
dW1uX25hbWV9X3ZhbHVlMSIsIG1pbl92YWx1ZT1taW5fdmFsdWUsIG1heF92YWx1ZT1tYXhfdmFs
dWUsIHZhbHVlPXZhbHVlMSkKICAgICAgICAgICAgICAgICAgICB3aXRoIGNvbDI6CiAgICAgICAg
ICAgICAgICAgICAgICAgIHZhbHVlMiA9IHN0Lm51bWJlcl9pbnB1dChmIntjb2x1bW5fbmFtZX1f
dmFsdWUyIiwgbWluX3ZhbHVlPW1pbl92YWx1ZSwgbWF4X3ZhbHVlPW1heF92YWx1ZSwgdmFsdWU9
dmFsdWUyKQogICAgICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfZmls
dGVyc1tjb2x1bW5fbmFtZV0gPSB7ImNvbmRpdGlvbiI6IGNvbmRpdGlvbiwgInZhbHVlMSI6IHZh
bHVlMSwgInZhbHVlMiI6IHZhbHVlMn0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGZsb2F0KHN0LnNl
c3Npb25fc3RhdGUuc2VsZWN0ZWRfZmlsdGVyc1tjb2x1bW5fbmFtZV0uZ2V0KCJ2YWx1ZSIsIG1p
bl92YWx1ZSkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IChLZXlFcnJvciwgVHlwZUVycm9y
KToKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBtaW5fdmFsdWUKCiAgICAgICAgICAg
ICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9maWx0ZXJzW2NvbHVtbl9uYW1lXSA9
IHsiY29uZGl0aW9uIjogY29uZGl0aW9uLCAidmFsdWUiOiBzdC5udW1iZXJfaW5wdXQoZiJ7Y29s
dW1uX25hbWV9X3ZhbHVlIiwgbWluX3ZhbHVlPW1pbl92YWx1ZSwgbWF4X3ZhbHVlPW1heF92YWx1
ZSwgdmFsdWU9dmFsdWUpfQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAg
ICAgIHN0LmVycm9yKGYiRXJyb3IgcHJvY2Vzc2luZyB7Y29sdW1uX25hbWV9OiB7ZX0iKQogICAg
ICAgICAgICBzdC53cml0ZShlKQoKICAgIGRlZiByZW5kZXJfbWFpbl9jb250ZW50KHNlbGYpOgog
ICAgICAgIGNvbDEsIGNvbDIsIGNvbDMgPSBzdC5jb2x1bW5zKFs0LCAxLCAxXSkKCiAgICAgICAg
d2l0aCBjb2wxOgogICAgICAgICAgICAjIEVuc3VyZSBjb2hvcnRfbmFtZSBpcyBpbiBzZXNzaW9u
IHN0YXRlCiAgICAgICAgICAgIGlmICJjb2hvcnRfbmFtZSIgbm90IGluIHN0LnNlc3Npb25fc3Rh
dGU6CiAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmNvaG9ydF9uYW1lID0gIiIKCiAg
ICAgICAgICAgIGNvaG9ydF9uYW1lID0gc3QudGV4dF9pbnB1dCgKICAgICAgICAgICAgICAgICJD
b2hvcnQgTmFtZTogIiwKICAgICAgICAgICAgICAgIHZhbHVlPXN0LnNlc3Npb25fc3RhdGUuY29o
b3J0X25hbWUsCiAgICAgICAgICAgICAgICBkaXNhYmxlZD1zdC5zZXNzaW9uX3N0YXRlLmlzX2Nv
aG9ydF9zYXZlZCwKICAgICAgICAgICAgKQoKICAgICAgICAgICAgIyBVcGRhdGUgdGhlIHNlc3Np
b24gc3RhdGUgd2l0aCB0aGUgY3VycmVudCBjb2hvcnQgbmFtZQogICAgICAgICAgICBzdC5zZXNz
aW9uX3N0YXRlLmNvaG9ydF9uYW1lID0gY29ob3J0X25hbWUKCiAgICAgICAgICAgIGlmIHN0LnNl
c3Npb25fc3RhdGUuaXNfY29ob3J0X3NhdmVkOgogICAgICAgICAgICAgICAgc3QuaW5mbygiSWYg
eW91IHNjaGVkdWxlZCB5b3VyIGNvaG9ydCBhcyBhIER5bmFtaWMgdGFibGUsIHVwZGF0aW5nIHRo
ZSBDb2hvcnQgd2lsbCByZXF1aXJlIHlvdSB0byByZS1jcmVhdGUgeW91ciBzY2hlZHVsZS4iKQog
ICAgICAgICAgICAgICAgc2F2ZV9idXR0b25fdGV4dCA9ICJVcGRhdGUgQ29ob3J0IgogICAgICAg
ICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2F2ZV9idXR0b25fdGV4dCA9ICJTYXZlIENvaG9y
dCIKCiAgICAgICAgICAgIHNjaGVkdWxlX2NvaG9ydCA9IFNjaGVkdWxlQ29ob3J0cygpICAgCgog
ICAgICAgICAgICBpZiBzdC5idXR0b24oc2F2ZV9idXR0b25fdGV4dCk6CgogICAgICAgICAgICAg
ICAgaWYgc2F2ZV9idXR0b25fdGV4dCA9PSAiVXBkYXRlIENvaG9ydCI6CgogICAgICAgICAgICAg
ICAgICAgIHJlc3VsdCA9IHNjaGVkdWxlX2NvaG9ydC5jaGVja19leGlzdGluZ190YWJsZSgpCgog
ICAgICAgICAgICAgICAgICAgIGlmIHJlc3VsdCBhbmQgbGVuKHJlc3VsdCkgPiAwOgogICAgICAg
ICAgICAgICAgICAgICAgICB0YWJsZV90eXBlID0gcmVzdWx0WzBdWyJUWVBFIl0KICAgICAgICAg
ICAgICAgICAgICAgICAgdGFibGVfbmFtZSA9IHJlc3VsdFswXVsiVEFCTEVfTkFNRSJdCiAgICAg
ICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlID0gcmVzdWx0WzBdWyJUQUJMRV9DQVRBTE9HIl0K
ICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hID0gcmVzdWx0WzBdWyJUQUJMRV9TQ0hFTUEi
XQogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gcmVzdWx0WzBdWyJTQ0hFRFVMRV9UWVBF
Il0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHR5cGUgPT0gJ2R5bmFtaWN0YWJsZSc6Cgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBmIkRST1Age3RhYmxlX3R5cGV9IHtk
YXRhYmFzZX0ue3NjaGVtYX0ue3RhYmxlX25hbWV9IgoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJlYWRfc3FsKHF1ZXJ5LCBzdC5zZXNzaW9uX3N0YXRlLnNlc3Npb24sIDApCgogICAgICAg
ICAgICAgICAgICAgICAgICBlbGlmIHR5cGUgPT0gJ3NuYXBzaG90JzoKCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjcmVhdGVfc2NoZWR1bGUgPSBDcmVhdGVTbmFwc2hvdFRhYmxlKCkKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2Fk
ZW5jZSA9IHJlc3VsdFswXVsiQ0FERU5DRSJdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
cmVhdGVfc2NoZWR1bGUuY3JlYXRlX3NuYXBzaG90X3RhYmxlKHRhYmxlX25hbWUsIGNhZGVuY2Us
IHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X25hbWUpCgogICAgICAgICAgICAgICAgICAgICAgICBl
bGlmIHR5cGUgPT0gJ29uZXRpbWUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRl
X3NjaGVkdWxlID0gQ3JlYXRlT25lVGltZVRhYmxlKCkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlX3NjaGVkdWxlLmNyZWF0ZV90
YWJsZSh0YWJsZV9uYW1lLCBzdC5zZXNzaW9uX3N0YXRlLmNvaG9ydF9uYW1lKQoKCiAgICAgICAg
ICAgICAgICBpZiBsZW4oY29ob3J0X25hbWUpIDw9IDI6CgogICAgICAgICAgICAgICAgICAgIHN0
Lm1hcmtkb3duKCI6cmVkW1RoZSBlbnRlcmVkIGNvaG9ydF9uYW1lIGlzIHRvbyBzbWFsbDsgaXQg
aGFzIHRvIGJlIGF0IGxlYXN0IDMgY2hhcmFjdGVycyBsb25nLl0iKQoKICAgICAgICAgICAgICAg
IGVsc2U6IAoKICAgICAgICAgICAgICAgICAgICBzdC5pbmZvKCdTYXZpbmcnKQoKICAgICAgICAg
ICAgICAgICAgICBjb2x1bW5zX2RhdGEgPSBzdC5zZXNzaW9uX3N0YXRlLmZpbHRlcl9kZlsKICAg
ICAgICAgICAgICAgICAgICAgICAgWyJDT0xVTU5fTkFNRSIsIAogICAgICAgICAgICAgICAgICAg
ICAgICAgIklTX1BSSU1BUlkiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICJGSUxURVJfVFlQ
RSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiREFUQV9UWVBFIgogICAgICAgICAgICAgICAg
ICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgIAogICAgICAgICAgICAgICAg
ICAgIGZpbHRlcl92YWx1ZXMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJmaWx0ZXJzIjog
eyoqc3Quc2Vzc2lvbl9zdGF0ZS5maWx0ZXJfdmFsdWVzLCAqKnN0LnNlc3Npb25fc3RhdGUudGV4
dF9maWx0ZXJfY29uZGl0aW9uc30KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
ICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyBQcmVwYXJlIHRoZSBkaWN0aW9uYXJ5IGZyb20g
ZmlsdGVyX3ZhbHVlcyBmb3IgZWFzaWVyIG1hcHBpbmcKICAgICAgICAgICAgICAgICAgICBmaWx0
ZXJfZGljdCA9IGZpbHRlcl92YWx1ZXNbJ2ZpbHRlcnMnXQoKICAgICAgICAgICAgICAgICAgICAj
IERlZmluZSBhIGZ1bmN0aW9uIHRvIGFwcGx5IHRvIHRoZSBDT0xVTU5fTkFNRSBjb2x1bW4gdG8g
ZmV0Y2ggdmFsdWVzIGZyb20gZmlsdGVyX2RpY3QKICAgICAgICAgICAgICAgICAgICBkZWYgYXBw
bHlfZmlsdGVycyhjb2x1bW5fbmFtZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0g
ZmlsdGVyX2RpY3QuZ2V0KGNvbHVtbl9uYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAjIENv
bnZlcnQgdmFsdWUgdG8gYSBzdHJpbmcgaWYgaXQgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIHN0cih2YWx1ZSkgaWYgdmFsdWUgaXMgbm90IE5vbmUgZWxzZSBOb25l
CgogICAgICAgICAgICAgICAgICAgICMgQXBwbHkgdGhlIGZ1bmN0aW9uIHRvIHRoZSAnQ09MVU1O
X05BTUUnIGNvbHVtbgogICAgICAgICAgICAgICAgICAgIGNvbHVtbnNfZGF0YVsnRklMVEVSX1ZB
TFVFUyddID0gY29sdW1uc19kYXRhWydDT0xVTU5fTkFNRSddLmFwcGx5KGFwcGx5X2ZpbHRlcnMp
CgogICAgICAgICAgICAgICAgICAgIHNhdmVfY29ob3J0X3N0YXR1cyA9IGNhbGxfdXBzZXJ0X2Nv
aG9ydHMoCiAgICAgICAgICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbiwg
CiAgICAgICAgICAgICAgICAgICAgICAgIGNvaG9ydF9uYW1lLCAKICAgICAgICAgICAgICAgICAg
ICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF90YWJsZV9mdWxsLCAKICAgICAgICAgICAg
ICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9jb2x1bW5fbGlzdCwgCiAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbHVtbnNfZGF0YS50b19qc29uKG9yaWVudD0ncmVjb3Jkcycs
IGluZGVudD00KQogICAgICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAg
IGlmIHNhdmVfY29ob3J0X3N0YXR1cyAhPSBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLmlzX2NvaG9ydF9zYXZlZCA9IFRydWUKCiAgICAgICAgICAgICAgICAg
ICAgc3QucmVydW4oKQoKICAgICAgICB3aXRoIGNvbDM6CiAgICAgICAgICAgIHJvd19jYXJkID0g
Y3JlYXRlX21ldGFkYXRhY2FyZF9odG1sKAogICAgICAgICAgICAgICAgaGVhZGVyPSJSb3dzIiwK
ICAgICAgICAgICAgICAgIHZhbHVlPWNvbnZlcnRfdG9fa19tKHN0LnNlc3Npb25fc3RhdGUuY29o
b3J0X3Jvd19jb3VudCksCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0iUm93cyIsCiAgICAg
ICAgICAgICAgICBjYXJkX2JnX2NvbG9yPXN0LnNlc3Npb25fc3RhdGUuY2FyZF9iZ19jb2xvciwK
ICAgICAgICAgICAgICAgIGhlYWRlcl9iZ19jb2xvcj1zdC5zZXNzaW9uX3N0YXRlLmhlYWRlcl9i
Z19jb2xvciwKICAgICAgICAgICAgKQoKICAgICAgICAgICAgc3QubWFya2Rvd24ocm93X2NhcmQs
IHVuc2FmZV9hbGxvd19odG1sPVRydWUpCgogICAgICAgIHRhYjEsIHRhYjIgPSBzdC50YWJzKFsi
U2Vjb25kYXJ5IEZpbHRlcnMiLCAiU2VsZWN0IENvbHVtbnMiXSkKCiAgICAgICAgd2l0aCB0YWIx
OgogICAgICAgICAgICBzZWxmLnJlbmRlcl9zZWNvbmRhcnlfZmlsdGVycygpCiAgICAgICAgICAg
IHNlbGYucmVuZGVyX2NvbHVtbl9zZWxlY3QoKQoKICAgICAgICB3aXRoIHRhYjI6CiAgICAgICAg
ICAgIHNlbGYucmVuZGVyX3ByZXZpZXdfY29ob3J0KCkKCiAgICBkZWYgcmVuZGVyX2NvbHVtbl9z
ZWxlY3Qoc2VsZik6CgogICAgICAgIGlmIG5vdCBzdC5zZXNzaW9uX3N0YXRlLnNob3dfc2Vjb25k
YXJ5X2ZpbHRlcnM6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzdC5zdWJoZWFkZXIoIkNv
aG9ydCBRdWVyeSIpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxlY3RlZF9j
b2x1bW5zID0gc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9jb2x1bW5fbGlzdAogICAgICAgICAg
ICBpZiBsZW4oc2VsZWN0ZWRfY29sdW1ucyk+MDoKICAgICAgICAgICAgICAgIGZpbmFsX3F1ZXJ5
ID0gc3Quc2Vzc2lvbl9zdGF0ZS5maW5hbF9xdWVyeS5yZXBsYWNlKAogICAgICAgICAgICAgICAg
ICAgICdDT1VOVCgqKScsCiAgICAgICAgICAgICAgICAgICAgIiwgIi5qb2luKG1hcChzdHIsIHNl
bGVjdGVkX2NvbHVtbnMpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbHNlOgogICAg
ICAgICAgICAgICAgZmluYWxfcXVlcnkgPSBzdC5zZXNzaW9uX3N0YXRlLmZpbmFsX3F1ZXJ5LnJl
cGxhY2UoCiAgICAgICAgICAgICAgICAgICAgJ0NPVU5UKCopJywKICAgICAgICAgICAgICAgICAg
ICAnKicKICAgICAgICAgICAgICAgICkKICAgICAgICBleGNlcHQ6IAogICAgICAgICAgICBmaW5h
bF9xdWVyeSA9IHN0LnNlc3Npb25fc3RhdGUuYmFzZV9maWx0ZXJfcXVlcnkKCiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5jb2hvcnRfcXVlcnkgPSBmaW5hbF9xdWVyeQogICAgICAgIAogICAgICAg
IHN0LmNvZGUoZm9ybWF0X3NxbChmaW5hbF9xdWVyeSkpCgoKICAgIGRlZiByZW5kZXJfcHJldmll
d19jb2hvcnQoc2VsZik6CgogICAgICAgIGlmIG5vdCBzdC5zZXNzaW9uX3N0YXRlLnNob3dfc2Vj
b25kYXJ5X2ZpbHRlcnM6CiAgICAgICAgICAgICAgICBzdC5tYXJrZG93bigiOnJlZFtBcHBseSBw
cmltYXJ5IGZpbHRlcnMgdG8gZGlzcGxheSBzZWNvbmRhcnkgZmlsdGVycy5dIikKICAgICAgICAg
ICAgICAgIHJldHVybgogICAgICAgICAgICAKICAgICAgICB3aXRoIHN0LmZvcm0oInNlbGVjdF9j
b2x1bW5zIik6CiAgICAgICAgICAgIAogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBz
ZWxlY3RlZF9jb2x1bW5fbGlzdCA9IHN0Lm11bHRpc2VsZWN0KAogICAgICAgICAgICAgICAgIlNl
bGVjdCBjb2x1bW5zIHlvdSB3YW50IGluIHlvdXIgY29ob3J0OiIsCiAgICAgICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLmNvbF9saXN0LAogICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0
ZS5zZWxlY3RlZF9jb2x1bW5fbGlzdAogICAgICAgICAgICApCiAgICAgICAgICAgIGV4Y2VwdDoK
ICAgICAgICAgICAgICAgIHNlbGVjdGVkX2NvbHVtbl9saXN0ID0gc3QubXVsdGlzZWxlY3QoCiAg
ICAgICAgICAgICAgICAiU2VsZWN0IGNvbHVtbnMgeW91IHdhbnQgaW4geW91ciBjb2hvcnQ6IiwK
ICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuY29sX2xpc3QsCiAgICAgICAgICAgICAg
ICAjc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9jb2x1bW5fbGlzdAogICAgICAgICAgICApCgog
ICAgICAgICAgICBpZiBzdC5mb3JtX3N1Ym1pdF9idXR0b24oIlNlbGVjdCBDb2x1bW5zIiwgdHlw
ZT0gInByaW1hcnkiKToKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRf
Y29sdW1uX2xpc3QgPSBzZWxlY3RlZF9jb2x1bW5fbGlzdAogICAgICAgICAgICAgICAgc3QucmVy
dW4oKQogICAgICAgIAogICAgICAgIHN0LmRpdmlkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAg
ICAgIHNlbGVjdGVkX2NvbHVtbnMgPSBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2NvbHVtbl9s
aXN0CiAgICAgICAgICAgIGlmIGxlbihzZWxlY3RlZF9jb2x1bW5zKT4wOgogICAgICAgICAgICAg
ICAgZmluYWxfcXVlcnkgPSBzdC5zZXNzaW9uX3N0YXRlLmZpbmFsX3F1ZXJ5LnJlcGxhY2UoCiAg
ICAgICAgICAgICAgICAgICAgJ0NPVU5UKCopJywKICAgICAgICAgICAgICAgICAgICAiLCAiLmpv
aW4obWFwKHN0ciwgc2VsZWN0ZWRfY29sdW1ucykpCiAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmaW5hbF9xdWVyeSA9IHN0LnNlc3Npb25fc3RhdGUu
ZmluYWxfcXVlcnkucmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAnQ09VTlQoKiknLAogICAg
ICAgICAgICAgICAgICAgICcqJwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAg
ICBleGNlcHQ6IAogICAgICAgICAgICBmaW5hbF9xdWVyeSA9IHN0LnNlc3Npb25fc3RhdGUuYmFz
ZV9maWx0ZXJfcXVlcnkKCiAgICAgICAgd2l0aCBzdC5leHBhbmRlcigiQ29ob3J0IFF1ZXJ5Iixl
eHBhbmRlZCA9IEZhbHNlKToKICAgICAgICAgICAgc3QuY29kZShmb3JtYXRfc3FsKGZpbmFsX3F1
ZXJ5KSkKCiAgICAgICAgc2VsZWN0ZWRfY29sdW1ucyA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0
ZWRfY29sdW1uX2xpc3QKICAgICAgICBpZiBsZW4oc2VsZWN0ZWRfY29sdW1ucyk+MDoKICAgICAg
ICAgICAgc3QuZGF0YWZyYW1lKHN0LnNlc3Npb25fc3RhdGUucHJldmlld19kYXRhc2V0W3NlbGVj
dGVkX2NvbHVtbnNdLCAKICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gNTAwLAogICAgICAg
ICAgICAgICAgICAgICB1c2VfY29udGFpbmVyX3dpZHRoID0gVHJ1ZSkKICAgICAgICBlbHNlOgog
ICAgICAgICAgICBzdC5kYXRhZnJhbWUoc3Quc2Vzc2lvbl9zdGF0ZS5wcmV2aWV3X2RhdGFzZXQs
IAogICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSA1MDAsCiAgICAgICAgICAgICAgICAgICAg
IHVzZV9jb250YWluZXJfd2lkdGggPSBUcnVlKQoKICAgIGRlZiByZW5kZXJfc2Vjb25kYXJ5X2Zp
bHRlcnMoc2VsZik6CiAgICAgICAgaWYgbm90IHN0LnNlc3Npb25fc3RhdGUuc2hvd19zZWNvbmRh
cnlfZmlsdGVyczoKICAgICAgICAgICAgc3QubWFya2Rvd24oIjpyZWRbQXBwbHkgcHJpbWFyeSBm
aWx0ZXJzIHRvIGRpc3BsYXkgc2Vjb25kYXJ5IGZpbHRlcnMuXSIpCiAgICAgICAgICAgIHJldHVy
bgoKICAgICAgICBpZiBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmIGlzIE5v
bmUgb3Igc3Quc2Vzc2lvbl9zdGF0ZS5zZWNvbmRhcnlfZmlsdGVyc19kZi5lbXB0eToKICAgICAg
ICAgICAgc3QubWFya2Rvd24oIjpyZWRbTm8gc2Vjb25kYXJ5IGZpbHRlcnMgYXZhaWxhYmxlLl0i
KQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyBDaGVjayBmb3IgdGhlIHByZXNlbmNlIG9m
IHRleHQgZmlsdGVycywgb3RoZXIgZmlsdGVycywgYWR2YW5jZWQgbnVtZXJpYyBmaWx0ZXJzLCBh
bmQgYWR2YW5jZWQgZGF0ZSBmaWx0ZXJzCiAgICAgICAgdGV4dF9maWx0ZXJzX2NvdW50ID0gc3Vt
KDEgZm9yIF8sIHJvdyBpbiBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmLml0
ZXJyb3dzKCkgaWYgcm93WyJGSUxURVJfVFlQRSJdID09ICJ0ZXh0IGZpbHRlciIpCiAgICAgICAg
YWR2YW5jZWRfbnVtZXJpY19maWx0ZXJzX2NvdW50ID0gc3VtKDEgZm9yIF8sIHJvdyBpbiBzdC5z
ZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmLml0ZXJyb3dzKCkgaWYgcm93WyJGSUxU
RVJfVFlQRSJdID09ICJhZHZhbmNlZCBudW1lcmljIGZpbHRlciIpCiAgICAgICAgYWR2YW5jZWRf
ZGF0ZV9maWx0ZXJzX2NvdW50ID0gc3VtKDEgZm9yIF8sIHJvdyBpbiBzdC5zZXNzaW9uX3N0YXRl
LnNlY29uZGFyeV9maWx0ZXJzX2RmLml0ZXJyb3dzKCkgaWYgcm93WyJGSUxURVJfVFlQRSJdID09
ICJhZHZhbmNlZCBkYXRlIGZpbHRlciIpCiAgICAgICAgb3RoZXJfZmlsdGVyc19jb3VudCA9IHN1
bSgxIGZvciBfLCByb3cgaW4gc3Quc2Vzc2lvbl9zdGF0ZS5zZWNvbmRhcnlfZmlsdGVyc19kZi5p
dGVycm93cygpIGlmIHJvd1siRklMVEVSX1RZUEUiXSBub3QgaW4gWyJ0ZXh0IGZpbHRlciIsICJh
ZHZhbmNlZCBudW1lcmljIGZpbHRlciIsICJhZHZhbmNlZCBkYXRlIGZpbHRlciJdKQoKICAgICAg
ICAjIFRleHQgRmlsdGVycyBTZWN0aW9uCiAgICAgICAgaWYgdGV4dF9maWx0ZXJzX2NvdW50ID4g
MDoKICAgICAgICAgICAgd2l0aCBzdC5jb250YWluZXIoKToKICAgICAgICAgICAgICAgIHN0LnN1
YmhlYWRlcigiVGV4dCBGaWx0ZXJzIikKICAgICAgICAgICAgICAgIGNvbHMgPSBzdC5jb2x1bW5z
KDMpICAjIG1haW50YWluIHRoZSAzLWNvbHVtbiBsYXlvdXQgZm9yIHRleHQgZmlsdGVycwogICAg
ICAgICAgICAgICAgY3VycmVudF9maWx0ZXJfY291bnQgPSAwCgogICAgICAgICAgICAgICAgZm9y
IGluZGV4LCByb3cgaW4gc3Quc2Vzc2lvbl9zdGF0ZS5zZWNvbmRhcnlfZmlsdGVyc19kZi5pdGVy
cm93cygpOgogICAgICAgICAgICAgICAgICAgIGlmIHJvd1siRklMVEVSX1RZUEUiXSA9PSAidGV4
dCBmaWx0ZXIiOgogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGNvbHNbY3VycmVudF9maWx0
ZXJfY291bnRdOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW5kZXJfZmlsdGVy
KHJvdykKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9maWx0ZXJfY291bnQgKz0gMQog
ICAgICAgICAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2ZpbHRlcl9jb3VudCA+PSAzOgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9maWx0ZXJfY291bnQgPSAwCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb2xzID0gc3QuY29sdW1ucygzKQogICAgICAgIGVsc2U6CiAg
ICAgICAgICAgIHN0LndyaXRlKCI6b3JhbmdlW05vIFRleHQgRmlsdGVyc10iKQoKICAgICAgICAj
IE90aGVyIEZpbHRlcnMgU2VjdGlvbgogICAgICAgIGlmIG90aGVyX2ZpbHRlcnNfY291bnQgPiAw
OgogICAgICAgICAgICBzdC5zdWJoZWFkZXIoIk90aGVyIEZpbHRlcnMiKQogICAgICAgICAgICB3
aXRoIHN0LmNvbnRhaW5lcihib3JkZXI9VHJ1ZSk6CiAgICAgICAgICAgICAgICBjb2xzID0gc3Qu
Y29sdW1ucygzKSAgIyBtYWludGFpbiB0aGUgMy1jb2x1bW4gbGF5b3V0IGZvciBvdGhlciBmaWx0
ZXJzCiAgICAgICAgICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3VudCA9IDAKCiAgICAgICAgICAg
ICAgICBmb3IgaW5kZXgsIHJvdyBpbiBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJz
X2RmLml0ZXJyb3dzKCk6CiAgICAgICAgICAgICAgICAgICAgaWYgcm93WyJGSUxURVJfVFlQRSJd
IG5vdCBpbiBbInRleHQgZmlsdGVyIiwgImFkdmFuY2VkIG51bWVyaWMgZmlsdGVyIiwgImFkdmFu
Y2VkIGRhdGUgZmlsdGVyIl06CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggY29sc1tjdXJy
ZW50X2ZpbHRlcl9jb3VudF06CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbmRl
cl9maWx0ZXIocm93KQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3Vu
dCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRfZmlsdGVyX2NvdW50ID49
IDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3VudCA9IDAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHMgPSBzdC5jb2x1bW5zKDMpCgogICAgICAg
IGVsc2U6CiAgICAgICAgICAgIHN0LndyaXRlKCJObyBPdGhlciBGaWx0ZXJzIikKCiAgICAgICAg
IyBBZHZhbmNlZCBOdW1lcmljIEZpbHRlcnMgU2VjdGlvbgogICAgICAgIGlmIGFkdmFuY2VkX251
bWVyaWNfZmlsdGVyc19jb3VudCA+IDA6CiAgICAgICAgICAgIHN0LnN1YmhlYWRlcigiQWR2YW5j
ZWQgTnVtZXJpYyBGaWx0ZXJzIikKICAgICAgICAgICAgd2l0aCBzdC5jb250YWluZXIoYm9yZGVy
PVRydWUpOgogICAgICAgICAgICAgICAgY29scyA9IHN0LmNvbHVtbnMoMykgICMgbWFpbnRhaW4g
dGhlIDMtY29sdW1uIGxheW91dCBmb3IgYWR2YW5jZWQgbnVtZXJpYyBmaWx0ZXJzCiAgICAgICAg
ICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3VudCA9IDAKCiAgICAgICAgICAgICAgICBmb3IgaW5k
ZXgsIHJvdyBpbiBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmLml0ZXJyb3dz
KCk6CiAgICAgICAgICAgICAgICAgICAgaWYgcm93WyJGSUxURVJfVFlQRSJdID09ICJhZHZhbmNl
ZCBudW1lcmljIGZpbHRlciI6CiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggY29sc1tjdXJy
ZW50X2ZpbHRlcl9jb3VudF06CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbmRl
cl9maWx0ZXIocm93KQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3Vu
dCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRfZmlsdGVyX2NvdW50ID49
IDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2ZpbHRlcl9jb3VudCA9IDAK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHMgPSBzdC5jb2x1bW5zKDMpCgogICAgICAg
IGVsc2U6CiAgICAgICAgICAgIHN0LndyaXRlKCJObyBBZHZhbmNlZCBOdW1lcmljIEZpbHRlcnMi
KQoKICAgICAgICAjIEFkdmFuY2VkIERhdGUgRmlsdGVycyBTZWN0aW9uCiAgICAgICAgaWYgYWR2
YW5jZWRfZGF0ZV9maWx0ZXJzX2NvdW50ID4gMDoKICAgICAgICAgICAgc3Quc3ViaGVhZGVyKCJB
ZHZhbmNlZCBEYXRlIEZpbHRlcnMiKQogICAgICAgICAgICB3aXRoIHN0LmNvbnRhaW5lcihib3Jk
ZXI9VHJ1ZSk6CiAgICAgICAgICAgICAgICBjb2xzID0gc3QuY29sdW1ucygzKSAgIyBtYWludGFp
biB0aGUgMy1jb2x1bW4gbGF5b3V0IGZvciBhZHZhbmNlZCBkYXRlIGZpbHRlcnMKICAgICAgICAg
ICAgICAgIGN1cnJlbnRfZmlsdGVyX2NvdW50ID0gMAoKICAgICAgICAgICAgICAgIGZvciBpbmRl
eCwgcm93IGluIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGYuaXRlcnJvd3Mo
KToKICAgICAgICAgICAgICAgICAgICBpZiByb3dbIkZJTFRFUl9UWVBFIl0gPT0gImFkdmFuY2Vk
IGRhdGUgZmlsdGVyIjoKICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBjb2xzW2N1cnJlbnRf
ZmlsdGVyX2NvdW50XToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVuZGVyX2Zp
bHRlcihyb3cpCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZmlsdGVyX2NvdW50ICs9
IDEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY3VycmVudF9maWx0ZXJfY291bnQgPj0gMzoK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZmlsdGVyX2NvdW50ID0gMAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29scyA9IHN0LmNvbHVtbnMoMykKCiAgICAgICAgZWxz
ZToKICAgICAgICAgICAgc3Qud3JpdGUoIk5vIEFkdmFuY2VkIERhdGUgRmlsdGVycyIpCgogICAg
ICAgICMgQXBwbHkgYnV0dG9uIGZvciBhbGwgZmlsdGVycwogICAgICAgIHN0LmRpdmlkZXIoKQog
ICAgICAgIGlmIHN0LmJ1dHRvbigiQXBwbHkgLSBTZWNvbmRhcnkgRmlsdGVycyIsIHVzZV9jb250
YWluZXJfd2lkdGg9VHJ1ZSwgdHlwZT0icHJpbWFyeSIpOgogICAgICAgICAgICBzZWxmLmFwcGx5
X2ZpbHRlcnMoIlNlY29uZGFyeSIpCiAgICAgICAgICAgIHN0LnJlcnVuKCkKCgogICAgZGVmIHJ1
bihzZWxmKToKICAgICAgICAKICAgICAgICBpZiBzdC5zZXNzaW9uX3N0YXRlLnByaW1hcnlfZmls
dGVyc19kZiBpcyBub3QgTm9uZSBhbmQgbm90IHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV9maWx0
ZXJzX2RmLmVtcHR5OgoKICAgICAgICAgICAgaWYgc3Quc2Vzc2lvbl9zdGF0ZS5wcmltYXJ5X2Zp
bHRlcnNfZGYuc2hhcGVbMF0gPiAwOgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHNlbGYu
cmVuZGVyX3NpZGViYXIoKQogICAgICAgICAgICAgICAgc2VsZi5yZW5kZXJfbWFpbl9jb250ZW50
KCkgCiAgICAgICAgZWxzZToKCiAgICAgICAgICAgIHN0Lndhcm5pbmcoIlBsZWFzZSBzZWxlY3Qg
dGhlIFByaW1hcnkgJiBTZWNvbmRhcnkgRmlsdGVycyBpbiB0aGUgRGF0YSBEaWN0aW9uYXJ5LiIp
CgoKY2xhc3MgU2NoZWR1bGVDb2hvcnRzOgoKICAgIGRlZiByZW5kZXJfbWFpbl9jb250ZW50KHNl
bGYpOgogICAgICAgIHN0LnN1YmhlYWRlcigiSG93IGRvIHlvdSB3YW50IHRvIHN0b3JlIHRoaXMg
Q29ob3J0PyIpCiAgICAgICAgc3RvcmFnZV9vcHRpb24gPSBzdC5yYWRpbygiIiwgWydEeW5hbWlj
IFRhYmxlJywgJ1NuYXBzaG90IHRhYmxlcycsICdPbmUtdGltZSBUYWJsZSddKQoKICAgICAgICBz
dC5kaXZpZGVyKCkKCiAgICAgICAgaWYgc3RvcmFnZV9vcHRpb24gPT0gJ0R5bmFtaWMgVGFibGUn
OgogICAgICAgICAgICB0YWJsZV9jcmVhdG9yID0gQ3JlYXRlRHluYW1pY1RhYmxlKCkKICAgICAg
ICAgICAgdGFibGVfY3JlYXRvci5keW5hbWljdGFibGVfaW5wdXRzKCkKICAgICAgICBlbGlmIHN0
b3JhZ2Vfb3B0aW9uID09ICdTbmFwc2hvdCB0YWJsZXMnOgogICAgICAgICAgICB0YWJsZV9jcmVh
dG9yID0gQ3JlYXRlU25hcHNob3RUYWJsZSgpCiAgICAgICAgICAgIHRhYmxlX2NyZWF0b3Iuc25h
cHNob3R0YWJsZV9pbnB1dHMoKQogICAgICAgIGVsaWYgc3RvcmFnZV9vcHRpb24gPT0gJ09uZS10
aW1lIFRhYmxlJzoKICAgICAgICAgICAgdGFibGVfY3JlYXRvciA9IENyZWF0ZU9uZVRpbWVUYWJs
ZSgpCiAgICAgICAgICAgIHRhYmxlX2NyZWF0b3Iub25ldGltZXRhYmxlX2lucHV0cygpCgogICAg
ZGVmIGNoZWNrX2V4aXN0aW5nX3RhYmxlKHNlbGYpOgogICAgICAgIHF1ZXJ5ID0gZiIiIgogICAg
ICAgIFNFTEVDVCBUQUJMRV9OQU1FLAogICAgICAgICAgICAgICBUQUJMRV9DQVRBTE9HLAogICAg
ICAgICAgICAgICBUQUJMRV9TQ0hFTUEsCiAgICAgICAgICAgICAgIFBBUlNFX0pTT04oQ09NTUVO
VCkgYXMgQ09NTUVOVF9KU09OLAogICAgICAgICAgICAgICBDT01NRU5UX0pTT046YXR0cmlidXRl
czpjb2hvcnQ6OlNUUklORyBhcyBDT0hPUlRfTkFNRSwKICAgICAgICAgICAgICAgQ09NTUVOVF9K
U09OOmF0dHJpYnV0ZXM6dHlwZTo6U1RSSU5HIGFzIFNDSEVEVUxFX1RZUEUsCiAgICAgICAgICAg
ICAgIENPTU1FTlRfSlNPTjphdHRyaWJ1dGVzOmNhZGVuY2U6OlNUUklORyBhcyBDQURFTkNFLAog
ICAgICAgICAgICAgICBDUkVBVEVELAogICAgICAgICAgICAgICBMQVNUX0FMVEVSRUQsCiAgICAg
ICAgICAgICAgIExBU1RfRERMLAogICAgICAgICAgICAgICBDQVNFIFdIRU4gSVNfRFlOQU1JQyA9
ICdZRVMnCiAgICAgICAgICAgICAgICBUSEVOICdEWU5BTUlDIFRBQkxFJwogICAgICAgICAgICAg
ICAgRUxTRSAnVEFCTEUnCiAgICAgICAgICAgICAgIEVORCBhcyBUWVBFCiAgICAgICAgRlJPTSBD
T0hPUlRfQlVJTERFUl9GT1JfU05PV0ZMQUtFLklORk9STUFUSU9OX1NDSEVNQS5UQUJMRVMKICAg
ICAgICBXSEVSRSBUQUJMRV9TQ0hFTUEgPSAnQVBQJwogICAgICAgIEFORCBUQUJMRV9DQVRBTE9H
ID0gJ0NPSE9SVF9CVUlMREVSX0ZPUl9TTk9XRkxBS0UnCiAgICAgICAgQU5EIENPTU1FTlRfSlNP
TjpuYW1lID0gJ2NvaG9ydC1idWlsZGVyJwogICAgICAgIEFORCBDT01NRU5UX0pTT046YXR0cmli
dXRlczpjb2hvcnQgPSAne3N0LnNlc3Npb25fc3RhdGUuY29ob3J0X25hbWV9JzsKICAgICAgICAi
IiIKICAgICAgICByZXN1bHQgPSBzdC5zZXNzaW9uX3N0YXRlLnNlc3Npb24uc3FsKHF1ZXJ5KS5j
b2xsZWN0KCkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHJ1bihzZWxmKToKICAgICAg
ICBpZiBsZW4oc3Quc2Vzc2lvbl9zdGF0ZS5jb2hvcnRfbmFtZSkgPiAyOgogICAgICAgICAgICBy
ZXN1bHQgPSBzZWxmLmNoZWNrX2V4aXN0aW5nX3RhYmxlKCkKICAgICAgICAgICAgaWYgcmVzdWx0
OgogICAgICAgICAgICAgICAgc3QuaW5mbyhmIkEgdGFibGUgYWxyZWFkeSBleGlzdHMgZm9yIHRo
ZSBjb2hvcnQgJ3tzdC5zZXNzaW9uX3N0YXRlLmNvaG9ydF9uYW1lfScuIikKCiAgICAgICAgICAg
ICAgICAjIENvbnZlcnQgdGhlIHJlc3VsdCB0byBhIERhdGFGcmFtZQogICAgICAgICAgICAgICAg
ZGYgPSBwZC5EYXRhRnJhbWUocmVzdWx0KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg
ICAjIFVucGl2b3QgdGhlIERhdGFGcmFtZQogICAgICAgICAgICAgICAgZGZfdW5waXZvdGVkID0g
ZGYubWVsdCh2YXJfbmFtZT0nQXR0cmlidXRlJywgdmFsdWVfbmFtZT0nVmFsdWUnKQoKICAgICAg
ICAgICAgICAgIGRmID0gZGZfdW5waXZvdGVkW2RmX3VucGl2b3RlZFsiQXR0cmlidXRlIl0gPT0g
IlRBQkxFX05BTUUiXQoKICAgICAgICAgICAgICAgICMgRGlzcGxheSB0aGUgdW5waXZvdGVkIERh
dGFGcmFtZQogICAgICAgICAgICAgICAgc3QuZGF0YWZyYW1lKGRmLHVzZV9jb250YWluZXJfd2lk
dGggPSBUcnVlLCBoaWRlX2luZGV4PSBUcnVlKQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAg
ICAgICAgIHNlbGYucmVuZGVyX21haW5fY29udGVudCgpCiAgICAgICAgZWxzZToKICAgICAgICAg
ICAgc3Qud2FybmluZygiUGxlYXNlIGJ1aWxkIGEgbmV3IENvaG9ydCBhbmQgc2F2ZSBvciBMb2Fk
IGFuIGV4aXN0aW5nIENvaG9ydCIpCgoKY2xhc3MgQ3JlYXRlRHluYW1pY1RhYmxlOgoKICAgIGRl
ZiBkeW5hbWljdGFibGVfaW5wdXRzKHNlbGYpOgogICAgICAgIHN0LnRpdGxlKCdDcmVhdGUgRHlu
YW1pYyBUYWJsZSBpbiBTbm93Zmxha2UnKQogICAgICAgIAogICAgICAgICMgSW5wdXQgZm9yIER5
bmFtaWMgVGFibGUgTmFtZQogICAgICAgIHRhYmxlX25hbWUgPSBzdC50ZXh0X2lucHV0KCdEeW5h
bWljIFRhYmxlIE5hbWUnKQogICAgICAgIAogICAgICAgICMgRGlzcGxheSBMYWcgVmFsdWUgYW5k
IExhZyBVbml0IGluIHR3byBjb2x1bW5zCiAgICAgICAgc3Qud3JpdGUoJ1NwZWNpZnkgTGFnOicp
CiAgICAgICAgY29sMSwgY29sMiA9IHN0LmNvbHVtbnMoMikKICAgICAgICB3aXRoIGNvbDE6CiAg
ICAgICAgICAgIGxhZ192YWx1ZSA9IHN0Lm51bWJlcl9pbnB1dCgnTGFnIFZhbHVlJywgbWluX3Zh
bHVlPTEsIHN0ZXA9MSwgdmFsdWU9MSkKICAgICAgICB3aXRoIGNvbDI6CiAgICAgICAgICAgIGxh
Z191bml0ID0gc3Quc2VsZWN0Ym94KCdMYWcgVW5pdCcsIFsnbWludXRlcycsICdob3VycycsICdk
YXlzJ10pCiAgICAgICAgdGFyZ2V0X2xhZyA9IGYie2xhZ192YWx1ZX0ge2xhZ191bml0fSIKICAg
ICAgICAKICAgICAgICAjIFNlbGVjdGJveCBmb3IgUkVGUkVTSF9NT0RFCiAgICAgICAgcmVmcmVz
aF9tb2RlID0gc3Quc2VsZWN0Ym94KCdSRUZSRVNIX01PREUnLCBbJ0FVVE8nLCAnRlVMTCcsICdJ
TkNSRU1FTlRBTCddKQoKICAgICAgICBpZiBzdC5idXR0b24oJ0NyZWF0ZSBUYWJsZScpOgogICAg
ICAgICAgICBzZWxmLmNyZWF0ZV9keW5hbWljX3RhYmxlKHRhYmxlX25hbWUsIHRhcmdldF9sYWcs
IHJlZnJlc2hfbW9kZSkKCiAgICBkZWYgY3JlYXRlX2R5bmFtaWNfdGFibGUoc2VsZiwgdGFibGVf
bmFtZSwgdGFyZ2V0X2xhZywgcmVmcmVzaF9tb2RlKToKICAgICAgICB0cnk6CiAgICAgICAgICAg
ICMgR2VuZXJhdGUgU1FMIGZvciBjcmVhdGluZyB0aGUgZHluYW1pYyB0YWJsZQogICAgICAgICAg
ICBjb2hvcnRfbmFtZSA9IHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X25hbWUgCgogICAgICAgICAg
ICBjcmVhdGVfdGFibGVfc3FsID0gZiIiIgogICAgICAgICAgICBDUkVBVEUgT1IgUkVQTEFDRSBE
WU5BTUlDIFRBQkxFIENPSE9SVF9CVUlMREVSX0ZPUl9TTk9XRkxBS0UuQVBQLnt0YWJsZV9uYW1l
fQogICAgICAgICAgICBDT01NRU5UID0gJ3t7Im9yaWdpbiI6InNmX3NpdCIsIm5hbWUiOiJjb2hv
cnQtYnVpbGRlciIsInZlcnNpb24iOnt7Im1ham9yIjoxLCAibWlub3IiOjF9fSwiYXR0cmlidXRl
cyI6e3siY29ob3J0Ijoie2NvaG9ydF9uYW1lfSIsICJ0eXBlIjoiZHluYW1pY3RhYmxlIn19fX0n
CiAgICAgICAgICAgIFJFRlJFU0hfTU9ERSA9IHtyZWZyZXNoX21vZGV9CiAgICAgICAgICAgIFRB
UkdFVF9MQUcgPSAne3RhcmdldF9sYWd9JwogICAgICAgICAgICBXQVJFSE9VU0UgPSAnQ09IT1JU
X0JVSUxERVJfTE9BRF9XSCcKICAgICAgICAgICAgQVMKICAgICAgICAgICAge3N0LnNlc3Npb25f
c3RhdGUuY29ob3J0X3F1ZXJ5fTsKICAgICAgICAgICAgIiIiCgogICAgICAgICAgICAjIEV4ZWN1
dGUgdGhlIFNRTCBjb21tYW5kIGluIFNub3dmbGFrZQogICAgICAgICAgICBzdC5zZXNzaW9uX3N0
YXRlLnNlc3Npb24uc3FsKGNyZWF0ZV90YWJsZV9zcWwpLmNvbGxlY3QoKQogICAgICAgICAgICBz
dC5zdWNjZXNzKGYiRHluYW1pYyB0YWJsZSAne3RhYmxlX25hbWV9JyBjcmVhdGVkIHN1Y2Nlc3Nm
dWxseSB3aXRoIHRhcmdldCBsYWcgJ3t0YXJnZXRfbGFnfScgYW5kIHJlZnJlc2ggbW9kZSAne3Jl
ZnJlc2hfbW9kZX0nISIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAg
ICBzdC5lcnJvcihmIkVycm9yIGNyZWF0aW5nIHRhYmxlOiB7ZX0iKQoKY2xhc3MgQ3JlYXRlU25h
cHNob3RUYWJsZToKCiAgICBkZWYgc25hcHNob3R0YWJsZV9pbnB1dHMoc2VsZik6CiAgICAgICAg
c3QudGl0bGUoJ0NyZWF0ZSBTbmFwc2hvdCBUYWJsZSBpbiBTbm93Zmxha2UnKQogICAgICAgIAog
ICAgICAgICMgSW5wdXQgZm9yIFNuYXBzaG90IFRhYmxlIE5hbWUKICAgICAgICB0YWJsZV9uYW1l
ID0gc3QudGV4dF9pbnB1dCgnU25hcHNob3QgVGFibGUgTmFtZScpCiAgICAgICAgCiAgICAgICAg
IyBTZWxlY3Rib3ggZm9yIENhZGVuY2UKICAgICAgICBjYWRlbmNlID0gc3Quc2VsZWN0Ym94KCdT
ZWxlY3QgQ2FkZW5jZScsIFsnRGFpbHknLCAnV2Vla2x5JywgJ01vbnRobHknXSkKICAgICAgICAK
ICAgICAgICBpZiBzdC5idXR0b24oJ0NyZWF0ZSBUYWJsZScpOgogICAgICAgICAgICBzZWxmLmNy
ZWF0ZV9zbmFwc2hvdF90YWJsZSh0YWJsZV9uYW1lLCBjYWRlbmNlLCBzdC5zZXNzaW9uX3N0YXRl
LmNvaG9ydF9uYW1lKQoKICAgIGRlZiBjcmVhdGVfc25hcHNob3RfdGFibGUoc2VsZiwgdGFibGVf
bmFtZSwgY2FkZW5jZSwgY29ob3J0X25hbWUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgIyBN
YXBwaW5nIG9mIGNhZGVuY2VzIHRvIENST04gZXhwcmVzc2lvbnMKICAgICAgICAgICAgY2FkZW5j
ZV90b19jcm9uID0gewogICAgICAgICAgICAgICAgJ0RhaWx5JzogJ1VTSU5HIENST04gMCAwICog
KiAqIFVUQycsICAjIEV2ZXJ5IGRheSBhdCBtaWRuaWdodCBVVEMKICAgICAgICAgICAgICAgICdX
ZWVrbHknOiAnVVNJTkcgQ1JPTiAwIDAgKiAqIDAgVVRDJywgIyBFdmVyeSBTdW5kYXkgYXQgbWlk
bmlnaHQgVVRDCiAgICAgICAgICAgICAgICAnTW9udGhseSc6ICdVU0lORyBDUk9OIDAgMCAxICog
KiBVVEMnICMgRmlyc3QgZGF5IG9mIGV2ZXJ5IG1vbnRoIGF0IG1pZG5pZ2h0IFVUQwogICAgICAg
ICAgICB9CgogICAgICAgICAgICAjIEdldCB0aGUgQ1JPTiBleHByZXNzaW9uIGZyb20gdGhlIG1h
cHBpbmcgYmFzZWQgb24gdGhlIHVzZXItc2VsZWN0ZWQgY2FkZW5jZQogICAgICAgICAgICBjcm9u
X3NjaGVkdWxlID0gY2FkZW5jZV90b19jcm9uLmdldChjYWRlbmNlLCAnVVNJTkcgQ1JPTiAwIDAg
KiAqICogVVRDJykgICMgRGVmYXVsdCB0byBkYWlseSBpZiBub3QgZm91bmQKCiAgICAgICAgICAg
ICMgR2VuZXJhdGUgU1FMIGZvciBjcmVhdGluZyB0aGUgc3RvcmVkIHByb2NlZHVyZQogICAgICAg
ICAgICBxdWVyeSA9IHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X3F1ZXJ5CiAgICAgICAgICAgIGVz
Y2FwZWRfcXVlcnkgPSBxdWVyeS5yZXBsYWNlKCInIiwgIicnIikgICMgUHJvcGVybHkgZXNjYXBl
IHNpbmdsZSBxdW90ZXMKCiAgICAgICAgICAgIGNyZWF0ZV9wcm9jX3NxbCA9IGYiIiIKICAgICAg
ICAgICAgQ1JFQVRFIE9SIFJFUExBQ0UgUFJPQ0VEVVJFIENPSE9SVF9CVUlMREVSX0ZPUl9TTk9X
RkxBS0UuQVBQLnt0YWJsZV9uYW1lfV9zbmFwc2hvdF9wcm9jKCkKICAgICAgICAgICAgUkVUVVJO
UyBTVFJJTkcKICAgICAgICAgICAgTEFOR1VBR0UgU1FMCiAgICAgICAgICAgIENPTU1FTlQgPSAn
e3sib3JpZ2luIjoic2Zfc2l0IiwibmFtZSI6ImNvaG9ydC1idWlsZGVyIiwidmVyc2lvbiI6e3si
bWFqb3IiOjEsICJtaW5vciI6MX19LCJhdHRyaWJ1dGVzIjp7eyJjb2hvcnQiOiJ7Y29ob3J0X25h
bWV9IiwgInR5cGUiOiJzbmFwc2hvdCIsICJjYWRlbmNlIjoie2NhZGVuY2V9In19fX0nCiAgICAg
ICAgICAgIEFTCiAgICAgICAgICAgICQkCiAgICAgICAgICAgIERFQ0xBUkUKICAgICAgICAgICAg
ICAgIGN1cnJlbnRfZGF0ZXRpbWUgVkFSQ0hBUjsKICAgICAgICAgICAgICAgIGNyZWF0ZV90YWJs
ZV9zcWwgVkFSQ0hBUjsKICAgICAgICAgICAgQkVHSU4KICAgICAgICAgICAgICAgIC0tIEdlbmVy
YXRlIGEgZGF0ZXRpbWUgc3RyaW5nIGluIHRoZSBmb3JtYXQgJ1lZWVlNTURESEgyNE1JU1MnCiAg
ICAgICAgICAgICAgICBjdXJyZW50X2RhdGV0aW1lIDo9IFRPX0NIQVIoQ1VSUkVOVF9USU1FU1RB
TVAoKSwgJ1lZWVlNTURESEgyNE1JU1MnKTsKCiAgICAgICAgICAgICAgICAtLSBCdWlsZCB0aGUg
U1FMIHRvIGNyZWF0ZSBhIG5ldyB0YWJsZSB3aXRoIHRoZSBkYXRldGltZSBwb3N0Zml4CiAgICAg
ICAgICAgICAgICBjcmVhdGVfdGFibGVfc3FsIDo9ICdDUkVBVEUgVEFCTEUgQ09IT1JUX0JVSUxE
RVJfRk9SX1NOT1dGTEFLRS5BUFAue3RhYmxlX25hbWV9XycgfHwgY3VycmVudF9kYXRldGltZSB8
fCAnIENPTU1FTlQgPSBcXCd7eyJvcmlnaW4iOiJzZl9zaXQiLCJuYW1lIjoiY29ob3J0LWJ1aWxk
ZXIiLCJ2ZXJzaW9uIjp7eyJtYWpvciI6MSwgIm1pbm9yIjoxfX0sImF0dHJpYnV0ZXMiOnt7ImNv
aG9ydCI6Intjb2hvcnRfbmFtZX0iLCAidHlwZSI6InNuYXBzaG90IiwgImNhZGVuY2UiOiJ7Y2Fk
ZW5jZX0ifX19fVxcJyBBUyB7ZXNjYXBlZF9xdWVyeX0nOwoKICAgICAgICAgICAgICAgIC0tIEV4
ZWN1dGUgdGhlIFNRTCBzdGF0ZW1lbnQKICAgICAgICAgICAgICAgIEVYRUNVVEUgSU1NRURJQVRF
IGNyZWF0ZV90YWJsZV9zcWw7CgogICAgICAgICAgICAgICAgLS0gUmV0dXJuIGEgc3VjY2VzcyBt
ZXNzYWdlCiAgICAgICAgICAgICAgICBSRVRVUk4gJ1RhYmxlIGNyZWF0ZWQgd2l0aCBuYW1lOiBD
T0hPUlRfQlVJTERFUl9GT1JfU05PV0ZMQUtFLkFQUC57dGFibGVfbmFtZX1fJyB8fCBjdXJyZW50
X2RhdGV0aW1lOwogICAgICAgICAgICBFTkQ7CiAgICAgICAgICAgICQkOwogICAgICAgICAgICAi
IiIKICAgICAgICAgICAgIyBFeGVjdXRlIHRoZSBTUUwgY29tbWFuZCB0byBjcmVhdGUgdGhlIHN0
b3JlZCBwcm9jZWR1cmUgaW4gU25vd2ZsYWtlCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
c2Vzc2lvbi5zcWwoY3JlYXRlX3Byb2Nfc3FsKS5jb2xsZWN0KCkKICAgICAgICAgICAgc3Quc3Vj
Y2VzcyhmIlN0b3JlZCBwcm9jZWR1cmUgJ3t0YWJsZV9uYW1lfV9zbmFwc2hvdF9wcm9jJyBjcmVh
dGVkIHN1Y2Nlc3NmdWxseSEiKQoKICAgICAgICAgICAgIyBHZW5lcmF0ZSBTUUwgZm9yIGNyZWF0
aW5nIHRoZSB0YXNrCiAgICAgICAgICAgIGNyZWF0ZV90YXNrX3NxbCA9IGYiIiIKICAgICAgICAg
ICAgQ1JFQVRFIE9SIFJFUExBQ0UgVEFTSyBDT0hPUlRfQlVJTERFUl9GT1JfU05PV0ZMQUtFLkFQ
UC5zbmFwc2hvdF90YXNrX3t0YWJsZV9uYW1lfQogICAgICAgICAgICAgICAgQ09NTUVOVCA9ICd7
eyJvcmlnaW4iOiJzZl9zaXQiLCJuYW1lIjoiY29ob3J0LWJ1aWxkZXIiLCJ2ZXJzaW9uIjp7eyJt
YWpvciI6MSwgIm1pbm9yIjoxfX0sImF0dHJpYnV0ZXMiOnt7ImNvaG9ydCI6Intjb2hvcnRfbmFt
ZX0iLCAidHlwZSI6InNuYXBzaG90IiwgImNhZGVuY2UiOiJ7Y2FkZW5jZX0ifX19fScKICAgICAg
ICAgICAgICAgIFdBUkVIT1VTRSA9ICdDT0hPUlRfQlVJTERFUl9MT0FEX1dIJwogICAgICAgICAg
ICAgICAgU0NIRURVTEUgPSAne2Nyb25fc2NoZWR1bGV9JwogICAgICAgICAgICBBUwogICAgICAg
ICAgICAgICAgQ0FMTCBDT0hPUlRfQlVJTERFUl9GT1JfU05PV0ZMQUtFLkFQUC57dGFibGVfbmFt
ZX1fc25hcHNob3RfcHJvYygpOwogICAgICAgICAgICAiIiIKCiAgICAgICAgICAgICMgRXhlY3V0
ZSB0aGUgU1FMIGNvbW1hbmQgdG8gY3JlYXRlIHRoZSB0YXNrIGluIFNub3dmbGFrZQogICAgICAg
ICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlc3Npb24uc3FsKGNyZWF0ZV90YXNrX3NxbCkuY29sbGVj
dCgpCiAgICAgICAgICAgIHN0LnN1Y2Nlc3MoZiJTbmFwc2hvdCB0YXNrIGZvciAne3RhYmxlX25h
bWV9JyBoYXMgYmVlbiBzZXQgdXAgc3VjY2Vzc2Z1bGx5IHdpdGggYSB7Y2FkZW5jZX0gY2FkZW5j
ZSEiKQoKICAgICAgICAgICAgIyBHZW5lcmF0ZSBTUUwgdG8gcmVzdW1lIHRoZSB0YXNrCiAgICAg
ICAgICAgIHJlc3VtZV90YXNrX3NxbCA9IGYiQUxURVIgVEFTSyBDT0hPUlRfQlVJTERFUl9GT1Jf
U05PV0ZMQUtFLkFQUC5zbmFwc2hvdF90YXNrX3t0YWJsZV9uYW1lfSBSRVNVTUU7IgoKICAgICAg
ICAgICAgIyBFeGVjdXRlIHRoZSBTUUwgY29tbWFuZCB0byByZXN1bWUgdGhlIHRhc2sgaW4gU25v
d2ZsYWtlCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbi5zcWwocmVzdW1lX3Rh
c2tfc3FsKS5jb2xsZWN0KCkKICAgICAgICAgICAgc3Quc3VjY2VzcyhmIlNuYXBzaG90IHRhc2sg
Zm9yICd7dGFibGVfbmFtZX0nIGhhcyBiZWVuIHJlc3VtZWQhIikKCgogICAgICAgICAgICAjIENh
bGwgcHJvY2VkdXJlCiAgICAgICAgICAgIGNhbGxfcHJvY19zcWwgPSBmIkNBTEwgQ09IT1JUX0JV
SUxERVJfRk9SX1NOT1dGTEFLRS5BUFAue3RhYmxlX25hbWV9X3NuYXBzaG90X3Byb2MoKSIKICAg
ICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9uLnNxbChjYWxsX3Byb2Nfc3FsKS5jb2xs
ZWN0KCkKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzdC5lcnJv
cihmIkVycm9yIHNldHRpbmcgdXAgc25hcHNob3QgdGFibGUgYW5kIHRhc2s6IHtlfSIpCgpjbGFz
cyBDcmVhdGVPbmVUaW1lVGFibGU6CgogICAgZGVmIG9uZXRpbWV0YWJsZV9pbnB1dHMoc2VsZik6
CiAgICAgICAgc3QudGl0bGUoJ0NyZWF0ZSBPbmUtVGltZSBUYWJsZSBpbiBTbm93Zmxha2UnKQog
ICAgICAgIAogICAgICAgICMgSW5wdXQgZm9yIE9uZS1UaW1lIFRhYmxlIE5hbWUKICAgICAgICB0
YWJsZV9uYW1lID0gc3QudGV4dF9pbnB1dCgnT25lLVRpbWUgVGFibGUgTmFtZScpCiAgICAgICAg
CiAgICAgICAgaWYgc3QuYnV0dG9uKCdDcmVhdGUgVGFibGUnKToKICAgICAgICAgICAgc2VsZi5j
cmVhdGVfdGFibGUodGFibGVfbmFtZSwgIHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X25hbWUpCgog
ICAgZGVmIGNyZWF0ZV90YWJsZShzZWxmLCB0YWJsZV9uYW1lLCBjb2hvcnRfbmFtZSk6CiAgICAg
ICAgIyBHZW5lcmF0ZSBTUUwgZm9yIG9uZS10aW1lIHRhYmxlIGNyZWF0aW9uCiAgICAgICAgY3Jl
YXRlX3RhYmxlX3NxbCA9IGYiIiIKICAgICAgICBDUkVBVEUgT1IgUkVQTEFDRSBEWU5BTUlDIFRB
QkxFIENPSE9SVF9CVUlMREVSX0ZPUl9TTk9XRkxBS0UuQVBQLnt0YWJsZV9uYW1lfQogICAgICAg
IFRBUkdFVF9MQUcgPSAnZG93bnN0cmVhbScKICAgICAgICBXQVJFSE9VU0UgPSAnQ09IT1JUX0JV
SUxERVJfTE9BRF9XSCcKICAgICAgICBDT01NRU5UID0gJ3t7Im9yaWdpbiI6InNmX3NpdCIsIm5h
bWUiOiJjb2hvcnQtYnVpbGRlciIsInZlcnNpb24iOnt7Im1ham9yIjoxLCAibWlub3IiOjF9fSwi
YXR0cmlidXRlcyI6e3siY29ob3J0Ijoie2NvaG9ydF9uYW1lfSIsICJ0eXBlIjoib25ldGltZSJ9
fX19JwogICAgICAgIEFTCiAgICAgICAge3N0LnNlc3Npb25fc3RhdGUuY29ob3J0X3F1ZXJ5fTsK
ICAgICAgICAiIiIKICAgICAgICAKICAgICAgICAjIEV4ZWN1dGUgdGhlIFNRTCBjb21tYW5kIGlu
IFNub3dmbGFrZQogICAgICAgIHRyeToKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZXNz
aW9uLnNxbChjcmVhdGVfdGFibGVfc3FsKS5jb2xsZWN0KCkKICAgICAgICBleGNlcHQgRXhjZXB0
aW9uIGFzIGU6CiAgICAgICAgICAgIHN0LmVycm9yKGYiRXJyb3IgY3JlYXRpbmcgdGFibGU6IHtl
fSIpCgogICAgICAgIHN1c3BlbmRfcXVlcnkgPSBmIkFMVEVSIERZTkFNSUMgVEFCTEUgQ09IT1JU
X0JVSUxERVJfRk9SX1NOT1dGTEFLRS5BUFAue3RhYmxlX25hbWV9IFNVU1BFTkQiCiAgICAgICAg
CiAgICAgICAgIyBFeGVjdXRlIHRoZSBTUUwgY29tbWFuZCBpbiBTbm93Zmxha2UKICAgICAgICB0
cnk6CiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbi5zcWwoc3VzcGVuZF9xdWVy
eSkuY29sbGVjdCgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBz
dC5lcnJvcihmIkVycm9yIGNyZWF0aW5nIHRhYmxlOiB7ZX0iKQoKICAgICAgICBzdC5zdWNjZXNz
KCJUYWJsZSBjcmVhdGVkIFN1Y2Vzc2Z1bGx5IikKCmNsYXNzIFRleHRGaWx0ZXJEaWFsb2c6CiAg
ICBkZWYgX19pbml0X18oc2VsZiwgY29sdW1uX25hbWUpOgogICAgICAgIHNlbGYuY29sdW1uX25h
bWUgPSBjb2x1bW5fbmFtZQogICAgICAgIHNlbGYuY29uZGl0aW9uX29wdGlvbnMgPSBbIiIsICJD
b250YWlucyIsICJEb2VzIG5vdCBjb250YWluIiwgIkVxdWFscyIsICJEb2VzIG5vdCBlcXVhbCIs
ICJCZWdpbnMgd2l0aCIsICJFbmRzIHdpdGgiLCAiQmxhbmsiLCAiTm90IGJsYW5rIl0KCiAgICAg
ICAgaWYgY29sdW1uX25hbWUgbm90IGluIHN0LnNlc3Npb25fc3RhdGUudGV4dF9maWx0ZXJfY29u
ZGl0aW9ucy5rZXlzKCk6CiAgICAgICAgICAgIGNvbmRpdGlvbl9saXN0ID0gW1siIiwiIl0sWyIi
LCIiXV0KICAgICAgICAgICAgbG9naWNhbF9vcGVyYXRvciA9ICJPUiIKICAgICAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS50ZXh0X2ZpbHRlcl9jb25kaXRpb25zW2NvbHVtbl9uYW1lXSA9IFtjb25k
aXRpb25fbGlzdCwgbG9naWNhbF9vcGVyYXRvcl0KCiAgICBkZWYgZGlzcGxheShzZWxmKToKCiAg
ICAgICAgY29uZGl0aW9uX2xpc3QgPSBzdC5zZXNzaW9uX3N0YXRlLnRleHRfZmlsdGVyX2NvbmRp
dGlvbnNbc2VsZi5jb2x1bW5fbmFtZV1bMF0KICAgICAgICBsb2dpY2FsX29wZXJhdG9yID0gc3Qu
c2Vzc2lvbl9zdGF0ZS50ZXh0X2ZpbHRlcl9jb25kaXRpb25zW3NlbGYuY29sdW1uX25hbWVdWzFd
CiAgICAgICAgCgogICAgICAgIHdpdGggc3QuZXhwYW5kZXIoZiJTZXQge3NlbGYuY29sdW1uX25h
bWV9IGNvbmRpdGlvbnM6Iik6CiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDIpOgogICAgICAg
ICAgICAgICAgY29uZGl0aW9uX3R5cGUgPSBzdC5zZWxlY3Rib3goCiAgICAgICAgICAgICAgICAg
ICAgZiJDb25kaXRpb24gVHlwZSB7aSsxfSIsCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25k
aXRpb25fb3B0aW9ucywKICAgICAgICAgICAgICAgICAgICBpbmRleD1zZWxmLmNvbmRpdGlvbl9v
cHRpb25zLmluZGV4KGNvbmRpdGlvbl9saXN0W2ldWzBdKSwgCiAgICAgICAgICAgICAgICAgICAg
a2V5PWYie3NlbGYuY29sdW1uX25hbWV9X3R5cGVfe2l9IikgCiAgICAgICAgICAgICAgICAKICAg
ICAgICAgICAgICAgIGNvbmRpdGlvbl92YWx1ZSA9IHN0LnRleHRfaW5wdXQoCiAgICAgICAgICAg
ICAgICAgICAgZiJWYWx1ZSB7aSsxfSIsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU9Y29uZGl0
aW9uX2xpc3RbaV1bMV0sIAogICAgICAgICAgICAgICAgICAgIGtleT1mIntzZWxmLmNvbHVtbl9u
YW1lfV92YWx1ZV97aX0iLAogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPWNvbmRpdGlvbl90
eXBlIGluIFsiQmxhbmsiLCAiTm90IGJsYW5rIl0pCiAgICAgICAgICAgICAgICAKICAgICAgICAg
ICAgICAgIGNvbmRpdGlvbl9saXN0W2ldID0gW2NvbmRpdGlvbl90eXBlLCBjb25kaXRpb25fdmFs
dWVdCgogICAgICAgICAgICAgICAgaWYgaSA9PSAwOgogICAgICAgICAgICAgICAgICAgIGxvZ2lj
YWxfb3BlcmF0b3IgPSBzdC5yYWRpbygKICAgICAgICAgICAgICAgICAgICAgICAgZiJMb2dpY2Fs
IE9wZXJhdG9yIHtpfSIsIFsiQU5EIiwgIk9SIl0sIAogICAgICAgICAgICAgICAgICAgICAgICBp
bmRleD1bIkFORCIsICJPUiJdLmluZGV4KGxvZ2ljYWxfb3BlcmF0b3IpLCAKICAgICAgICAgICAg
ICAgICAgICAgICAga2V5PWYie3NlbGYuY29sdW1uX25hbWV9X29wZXJhdG9yX3tpfSIpCgogICAg
ICAgICAgICBpZiBzdC5idXR0b24oZiJTdWJtaXQgLSB7c2VsZi5jb2x1bW5fbmFtZX0iKToKICAg
ICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUudGV4dF9maWx0ZXJfY29uZGl0aW9uc1tzZWxm
LmNvbHVtbl9uYW1lXSA9IFtjb25kaXRpb25fbGlzdCwgbG9naWNhbF9vcGVyYXRvcl0KICAgICAg
ICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2hvd19kaWFsb2cgPSBGYWxzZQogICAgICAgICAg
ICAgICAgc3QucmVydW4oKQogICAgICAgICAgICAKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6
CiAgICBhcHAgPSBCdWlsZENvaG9ydCgpCiAgICBhcHAucnVuKCmVMlwAAAAAAACUjBNFeGlzdGlu
Z19Db2hvcnRzLnB5lEISXAAAaW1wb3J0IHN0cmVhbWxpdCBhcyBzdAppbXBvcnQganNvbgppbXBv
cnQgYXN0CmltcG9ydCBkYXRldGltZQppbXBvcnQgbWF0aAppbXBvcnQgcGFuZGFzIGFzIHBkCmlt
cG9ydCBzcWxwYXJzZQoKCmRlZiBmb3JtYXRfc3FsKHNxbF9zdGF0ZW1lbnQpOgogICAgIiIiCiAg
ICBGb3JtYXRzIGEgU1FMIHN0YXRlbWVudCB1c2luZyBzcWxwYXJzZSBhbmQgcmV0dXJucyB0aGUg
Zm9ybWF0dGVkIFNRTC4KCiAgICBBcmdzOgogICAgc3FsX3N0YXRlbWVudCAoc3RyKTogVGhlIFNR
TCBzdGF0ZW1lbnQgdG8gZm9ybWF0LgoKICAgIFJldHVybnM6CiAgICBzdHI6IFRoZSBmb3JtYXR0
ZWQgU1FMIHN0YXRlbWVudC4KICAgICIiIgogICAgZm9ybWF0dGVkX3NxbCA9IHNxbHBhcnNlLmZv
cm1hdChzcWxfc3RhdGVtZW50LCByZWluZGVudD1UcnVlLCBrZXl3b3JkX2Nhc2U9J3VwcGVyJykK
ICAgIHJldHVybiBmb3JtYXR0ZWRfc3FsCgoKZGVmIHByb2Nlc3NfY29sdW1ucyhzZXNzaW9uLCBk
Ziwgd2hlcmVfY2xhdXNlPScnKToKICAgICIiIgogICAgUHJvY2VzcyBjb2x1bW5zIHRvIGdlbmVy
YXRlIG1pbiwgbWF4LCBhbmQgZGlzdGluY3QgdmFsdWVzIGZvciBwcmltYXJ5IGZpbHRlcnMuCgog
ICAgUGFyYW1ldGVyczoKICAgIC0gc2Vzc2lvbjogRGF0YWJhc2Ugc2Vzc2lvbi4KICAgIC0gZGYg
KHBkLkRhdGFGcmFtZSk6IERhdGFmcmFtZSB3aXRoIGNvbHVtbiBtZXRhZGF0YS4KICAgIC0gd2hl
cmVfY2xhdXNlIChzdHIpOiBBZGRpdGlvbmFsIFNRTCB3aGVyZSBjbGF1c2UuCgogICAgUmV0dXJu
czoKICAgIC0gcGQuRGF0YUZyYW1lOiBEYXRhZnJhbWUgd2l0aCBwcm9jZXNzZWQgY29sdW1uIHZh
bHVlcy4KICAgICIiIgogICAgdGFibGVfbmFtZSA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRf
dGFibGVfZnVsbAoKICAgICMgSW5pdGlhbGl6ZSBhbiBlbXB0eSBsaXN0IHRvIHN0b3JlIHRoZSBy
ZXN1bHRzCiAgICByZXN1bHRfZGZzID0gW10KCiAgICBmb3IgaW5kZXgsIHJvdyBpbiBkZi5pdGVy
cm93cygpOgogICAgICAgIGNvbHVtbl9uYW1lID0gcm93WydDT0xVTU5fTkFNRSddCiAgICAgICAg
ZGF0YV90eXBlID0gcm93WydEQVRBX1RZUEUnXQogICAgICAgIGZpbHRlcl90eXBlID0gcm93WydG
SUxURVJfVFlQRSddCgogICAgICAgICMgQ2FsbCB0aGUgc3RvcmVkIHByb2NlZHVyZSBmb3IgZWFj
aCBjb2x1bW4gYW5kIGdldCB0aGUgcmVzdWx0CiAgICAgICAgcmVzdWx0X2RmID0gc2Vzc2lvbi5j
YWxsKCdjb2hvcnRfYnVpbGRlcl9mb3Jfc25vd2ZsYWtlLmFwcC5nZXRfY29sdW1uX3N0YXRzJywg
Y29sdW1uX25hbWUsIGRhdGFfdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZmlsdGVyX3R5cGUsIHRhYmxlX25hbWUsIHdoZXJlX2NsYXVzZSkKCiAgICAgICAgIyBDb252ZXJ0
IHRoZSByZXN1bHQgdG8gYSBwYW5kYXMgRGF0YUZyYW1lIGFuZCBhcHBlbmQgdG8gdGhlIGxpc3QK
ICAgICAgICByZXN1bHRfZGZzLmFwcGVuZChyZXN1bHRfZGYudG9fcGFuZGFzKCkpCgogICAgIyBD
b25jYXRlbmF0ZSBhbGwgdGhlIHJlc3VsdCBEYXRhRnJhbWVzCiAgICBjb21iaW5lZF9kZiA9IHBk
LmNvbmNhdChyZXN1bHRfZGZzLCBpZ25vcmVfaW5kZXg9VHJ1ZSkKCiAgICAjIE1lcmdlIHRoZSBy
ZXN1bHQgd2l0aCB0aGUgb3JpZ2luYWwgZGF0YWZyYW1lCiAgICBjb21iaW5lZF9kZiA9IHBkLm1l
cmdlKGRmLCBjb21iaW5lZF9kZiwgb249WydDT0xVTU5fTkFNRScsICdEQVRBX1RZUEUnLCAnRklM
VEVSX1RZUEUnXSwgaG93PSdpbm5lcicpCgogICAgcmV0dXJuIGNvbWJpbmVkX2RmCgoKZGVmIHJl
YWRfc3FsKHF1ZXJ5LCBzZXNzaW9uLCBpbmRleCk6CiAgICAiIiIKICAgIEV4ZWN1dGUgYSBTUUwg
cXVlcnkgYW5kIHJldHVybiBhIHNwZWNpZmljIGNvbHVtbiBmcm9tIHRoZSByZXN1bHQuCgogICAg
UGFyYW1ldGVyczoKICAgIHF1ZXJ5IChzdHIpOiBUaGUgU1FMIHF1ZXJ5IHRvIGJlIGV4ZWN1dGVk
LgogICAgc2Vzc2lvbiAob2JqZWN0KTogVGhlIHNlc3Npb24gb2JqZWN0IHRvIGludGVyYWN0IHdp
dGggdGhlIGRhdGFiYXNlLgogICAgaW5kZXggKGludCk6IFRoZSBpbmRleCBvZiB0aGUgY29sdW1u
IHRvIGJlIHJldHVybmVkIGZyb20gdGhlIHF1ZXJ5IHJlc3VsdC4KCiAgICBSZXR1cm5zOgogICAg
bGlzdDogQSBsaXN0IGNvbnRhaW5pbmcgdGhlIHZhbHVlcyBvZiB0aGUgc3BlY2lmaWVkIGNvbHVt
biBmcm9tIHRoZSBxdWVyeSByZXN1bHQuCiAgICAiIiIKICAgIHJlc3VsdCA9IHNlc3Npb24uc3Fs
KHF1ZXJ5KS5jb2xsZWN0KCkKICAgIHJldHVybiBbcm93W2luZGV4XSBmb3Igcm93IGluIHJlc3Vs
dF0KCgpkZWYgY2hlY2tfaGFzX2RhdGEodmFyaWFibGUpOgogICAgIiIiCiAgICBDaGVjayBpZiBh
IHZhcmlhYmxlIGhhcyBkYXRhLCBpLmUuLCBpdCBpcyBub3QgYW4gZW1wdHkgc3RyaW5nIGFuZCBu
b3QgTm9uZS4KCiAgICBQYXJhbWV0ZXJzOgogICAgdmFyaWFibGU6IFRoZSB2YXJpYWJsZSB0byBj
aGVjay4KCiAgICBSZXR1cm5zOgogICAgYm9vbDogVHJ1ZSBpZiB0aGUgdmFyaWFibGUgaGFzIGRh
dGEgKGlzIG5vdCBhbiBlbXB0eSBzdHJpbmcgYW5kIG5vdCBOb25lKSwgRmFsc2Ugb3RoZXJ3aXNl
LgogICAgIiIiCiAgICByZXR1cm4gdmFyaWFibGUgIT0gJycgYW5kIHZhcmlhYmxlIGlzIG5vdCBO
b25lCgoKZGVmIHJlYWRfdGFibGUocXVlcnksIHNlc3Npb24pOgogICAgIiIiCiAgICBFeGVjdXRl
IGEgU1FMIHF1ZXJ5IGFuZCByZXR1cm4gdGhlIHJlc3VsdCBhcyBhIHBhbmRhcyBEYXRhRnJhbWUu
CgogICAgUGFyYW1ldGVyczoKICAgIHF1ZXJ5IChzdHIpOiBUaGUgU1FMIHF1ZXJ5IHRvIGJlIGV4
ZWN1dGVkLgogICAgc2Vzc2lvbiAob2JqZWN0KTogVGhlIHNlc3Npb24gb2JqZWN0IHRvIGludGVy
YWN0IHdpdGggdGhlIGRhdGFiYXNlLgoKICAgIFJldHVybnM6CiAgICBwYW5kYXMuRGF0YUZyYW1l
OiBUaGUgcXVlcnkgcmVzdWx0IGFzIGEgcGFuZGFzIERhdGFGcmFtZS4KICAgICIiIgogICAgcmV0
dXJuIHNlc3Npb24uc3FsKHF1ZXJ5KS50b19wYW5kYXMoKQoKCkBzdC5jYWNoZV9kYXRhCmRlZiBm
ZXRjaF90YWJsZV9kYXRhKF9zZXNzaW9uLCB0YWJsZV9uYW1lKToKICAgICIiIgogICAgRmV0Y2gg
ZGF0YSBmcm9tIHRoZSBzcGVjaWZpZWQgdGFibGUgdXNpbmcgdGhlIHByb3ZpZGVkIHNlc3Npb24g
b2JqZWN0LgoKICAgIFBhcmFtZXRlcnM6CiAgICBfc2Vzc2lvbiAob2JqZWN0KTogVGhlIHNlc3Np
b24gb2JqZWN0IHVzZWQgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZGF0YWJhc2UuCiAgICB0YWJsZV9u
YW1lIChzdHIpOiBUaGUgbmFtZSBvZiB0aGUgdGFibGUgZnJvbSB3aGljaCB0byBmZXRjaCBkYXRh
LgoKICAgIFJldHVybnM6CiAgICBwZC5EYXRhRnJhbWU6IEEgcGFuZGFzIERhdGFGcmFtZSBjb250
YWluaW5nIHRoZSBkYXRhIGZyb20gdGhlIHNwZWNpZmllZCB0YWJsZS4KICAgICIiIgogICAgcmV0
dXJuIGxvYWRfdGFibGVfZGF0YShfc2Vzc2lvbiwgdGFibGVfbmFtZSkKCgpkZWYgbG9hZF90YWJs
ZV9kYXRhKHNlc3Npb24sIHRhYmxlKToKICAgICIiIgogICAgTG9hZCBkYXRhIGZyb20gdGhlIHNw
ZWNpZmllZCB0YWJsZSB1c2luZyB0aGUgcHJvdmlkZWQgc2Vzc2lvbiBvYmplY3QuCgogICAgUGFy
YW1ldGVyczoKICAgIHNlc3Npb24gKG9iamVjdCk6IFRoZSBzZXNzaW9uIG9iamVjdCB1c2VkIHRv
IGludGVyYWN0IHdpdGggdGhlIGRhdGFiYXNlLgogICAgdGFibGUgKHN0cik6IFRoZSBuYW1lIG9m
IHRoZSB0YWJsZSBmcm9tIHdoaWNoIHRvIGxvYWQgZGF0YS4KCiAgICBSZXR1cm5zOgogICAgdHVw
bGU6IEEgdHVwbGUgY29udGFpbmluZzoKICAgICAgICAtIHBkLkRhdGFGcmFtZTogQSBwYW5kYXMg
RGF0YUZyYW1lIGNvbnRhaW5pbmcgYSBzYW1wbGUgb2Ygcm93cyBmcm9tIHRoZSBzcGVjaWZpZWQg
dGFibGUuCiAgICAgICAgLSBpbnQ6IFRoZSB0b3RhbCBudW1iZXIgb2Ygcm93cyBpbiB0aGUgc3Bl
Y2lmaWVkIHRhYmxlLgogICAgIiIiCiAgICAjIFNRTCBxdWVyeSB0byBmZXRjaCBhIHNhbXBsZSBv
ZiByb3dzIGZyb20gdGhlIHRhYmxlCiAgICBxdWVyeSA9IGYiU0VMRUNUICogRlJPTSB7dGFibGV9
IFNBTVBMRSAoMTAgUk9XUykiCgogICAgIyBTUUwgcXVlcnkgdG8gY291bnQgdGhlIHRvdGFsIG51
bWJlciBvZiByb3dzIGluIHRoZSB0YWJsZQogICAgcm93X2NvdW50X3F1ZXJ5ID0gZiJTRUxFQ1Qg
Y291bnQoKikgRlJPTSB7dGFibGV9IgoKICAgICMgRXhlY3V0ZSB0aGUgcXVlcmllcyBhbmQgcmV0
dXJuIHRoZSByZXN1bHRzIGFzIGEgdHVwbGUKICAgIHJldHVybiByZWFkX3RhYmxlKHF1ZXJ5LCBz
ZXNzaW9uKSwgcmVhZF9zcWwocm93X2NvdW50X3F1ZXJ5LCBzZXNzaW9uLCAwKQoKCmRlZiBnZXRf
dGFibGVfbWV0YWRhdGEoc2Vzc2lvbiwgdGFibGVfbmFtZSk6CiAgICAiIiIKICAgIFJldHJpZXZl
IG1ldGFkYXRhIGZvciBjb2x1bW5zIGluIHRoZSBzcGVjaWZpZWQgdGFibGUuCgogICAgUGFyYW1l
dGVyczoKICAgIHNlc3Npb24gKG9iamVjdCk6IFRoZSBzZXNzaW9uIG9iamVjdCB1c2VkIHRvIGlu
dGVyYWN0IHdpdGggdGhlIGRhdGFiYXNlLgogICAgdGFibGVfbmFtZSAoc3RyKTogVGhlIGZ1bGx5
IHF1YWxpZmllZCBuYW1lIG9mIHRoZSB0YWJsZSAoaW4gdGhlIGZvcm1hdCAnZGF0YWJhc2Uuc2No
ZW1hLnRhYmxlJykuCgogICAgUmV0dXJuczoKICAgIHBkLkRhdGFGcmFtZTogQSBwYW5kYXMgRGF0
YUZyYW1lIGNvbnRhaW5pbmcgbWV0YWRhdGEgZm9yIHRoZSBjb2x1bW5zIGluIHRoZSBzcGVjaWZp
ZWQgdGFibGUuCiAgICAiIiIKICAgICMgU3BsaXQgdGhlIGZ1bGx5IHF1YWxpZmllZCB0YWJsZSBu
YW1lIGludG8gZGF0YWJhc2UsIHNjaGVtYSwgYW5kIHRhYmxlIHBhcnRzCiAgICBwYXJ0cyA9IHRh
YmxlX25hbWUuc3BsaXQoIi4iKQogICAgaWYgbGVuKHBhcnRzKSA9PSAzOgogICAgICAgIGRhdGFi
YXNlX25hbWUsIHNjaGVtYV9uYW1lLCB0YWJsZV9uYW1lID0gcGFydHMKCiAgICAjIFNRTCBxdWVy
eSB0byByZXRyaWV2ZSBjb2x1bW4gbWV0YWRhdGEgZnJvbSB0aGUgaW5mb3JtYXRpb24gc2NoZW1h
CiAgICBxdWVyeSA9IGYiIiIKICAgICAgICBTRUxFQ1QgQ09MVU1OX05BTUUsCiAgICAgICAgICAg
ICAgIERBVEFfVFlQRSwKICAgICAgICAgICAgICAgSUZOVUxMKENPTU1FTlQsICcnKSBBUyBERVND
UklQVElPTiwKICAgICAgICAgICAgICAgJycgQVMgRklMVEVSX1RZUEUgCiAgICAgICAgRlJPTSB7
ZGF0YWJhc2VfbmFtZX0uSU5GT1JNQVRJT05fU0NIRU1BLkNPTFVNTlMKICAgICAgICBXSEVSRSBU
QUJMRV9OQU1FID0gJ3t0YWJsZV9uYW1lfScgQU5EIFRBQkxFX1NDSEVNQSA9ICd7c2NoZW1hX25h
bWV9JwogICAgIiIiCgogICAgIyBFeGVjdXRlIHRoZSBxdWVyeSBhbmQgcmV0dXJuIHRoZSByZXN1
bHQgYXMgYSBwYW5kYXMgRGF0YUZyYW1lCiAgICByZXR1cm4gcmVhZF90YWJsZShxdWVyeSwgc2Vz
c2lvbikKCgpkZWYgZmV0Y2hfdGFibGVfc2l6ZShzZXNzaW9uLCBkYXRhYmFzZSwgc2NoZW1hLCB0
YWJsZSk6CiAgICAiIiIKICAgIEZldGNoIHRoZSBzaXplIG9mIHRoZSBzcGVjaWZpZWQgdGFibGUg
aW4gYSBodW1hbi1yZWFkYWJsZSBmb3JtYXQuCgogICAgUGFyYW1ldGVyczoKICAgIHNlc3Npb24g
KG9iamVjdCk6IFRoZSBzZXNzaW9uIG9iamVjdCB1c2VkIHRvIGludGVyYWN0IHdpdGggdGhlIGRh
dGFiYXNlLgogICAgZGF0YWJhc2UgKHN0cik6IFRoZSBuYW1lIG9mIHRoZSBkYXRhYmFzZSBjb250
YWluaW5nIHRoZSB0YWJsZS4KICAgIHNjaGVtYSAoc3RyKTogVGhlIG5hbWUgb2YgdGhlIHNjaGVt
YSBjb250YWluaW5nIHRoZSB0YWJsZS4KICAgIHRhYmxlIChzdHIpOiBUaGUgbmFtZSBvZiB0aGUg
dGFibGUgZm9yIHdoaWNoIHRvIGZldGNoIHRoZSBzaXplLgoKICAgIFJldHVybnM6CiAgICBzdHI6
IFRoZSBzaXplIG9mIHRoZSB0YWJsZSBpbiBhIGh1bWFuLXJlYWRhYmxlIGZvcm1hdCAoQiwgS0Is
IE1CLCBHQiwgVEIpLgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgIyBTUUwgcXVlcnkgdG8gZmV0
Y2ggdGhlIGFjdGl2ZSBieXRlcyBvZiB0aGUgc3BlY2lmaWVkIHRhYmxlIGZyb20gdGhlIGluZm9y
bWF0aW9uIHNjaGVtYQogICAgICAgIHF1ZXJ5ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAg
ICAgICAgICAgICAgICJBQ1RJVkVfQllURVMiCiAgICAgICAgICAgIEZST00ge2RhdGFiYXNlfS5J
TkZPUk1BVElPTl9TQ0hFTUEuVEFCTEVfU1RPUkFHRV9NRVRSSUNTCiAgICAgICAgICAgIFdIRVJF
IHRhYmxlX2NhdGFsb2cgPSAne2RhdGFiYXNlfScKICAgICAgICAgICAgQU5EIHRhYmxlX3NjaGVt
YSA9ICd7c2NoZW1hfScKICAgICAgICAgICAgQU5EIHRhYmxlX25hbWUgPSAne3RhYmxlfScKICAg
ICAgICAiIiIKCiAgICAgICAgIyBFeGVjdXRlIHRoZSBxdWVyeSBhbmQgZ2V0IHRoZSByZXN1bHQK
ICAgICAgICByZXN1bHQgPSByZWFkX3NxbChxdWVyeSwgc2Vzc2lvbiwgMClbMF0KCiAgICAgICAg
IyBJZiB0aGUgcmVzdWx0IGlzIDAsIHJldHVybiAiMEIiCiAgICAgICAgaWYgcmVzdWx0ID09IDA6
CiAgICAgICAgICAgIHJldHVybiAiMEIiCgogICAgICAgICMgRGVmaW5lIHNpemUgdW5pdHMKICAg
ICAgICBzaXplX3VuaXRzID0gKCJCIiwgIktCIiwgIk1CIiwgIkdCIiwgIlRCIikKCiAgICAgICAg
IyBDYWxjdWxhdGUgdGhlIGFwcHJvcHJpYXRlIHVuaXQKICAgICAgICBpID0gaW50KG1hdGguZmxv
b3IobWF0aC5sb2coZmxvYXQocmVzdWx0KSwgMTAyNCkpKQogICAgICAgIHAgPSBtYXRoLnBvdygx
MDI0LCBpKQogICAgICAgIHMgPSByb3VuZChmbG9hdChyZXN1bHQpIC8gcCwgMCkKCiAgICAgICAg
IyBSZXR1cm4gdGhlIHNpemUgaW4gYSBodW1hbi1yZWFkYWJsZSBmb3JtYXQKICAgICAgICByZXR1
cm4gZiJ7c30ge3NpemVfdW5pdHNbaV19IgoKICAgIGV4Y2VwdDoKCiAgICAgICAgcmV0dXJuIGYi
MCBNQiIKCgpkZWYgZ2VuX3doZXJlX2NsYXVzZV9mb3Jfbm9uX3RleHRfZmlsdGVycyhkZiwgZmls
dGVyX3ZhbHVlcyk6CiAgICAiIiIKICAgIEdlbmVyYXRlIFdIRVJFIGNsYXVzZSBmb3Igbm9uLXRl
eHQgZmlsdGVycy4KCiAgICBQYXJhbWV0ZXJzOgogICAgLSBkZiAocGQuRGF0YUZyYW1lKTogRGF0
YUZyYW1lIGNvbnRhaW5pbmcgY29sdW1uIG1ldGFkYXRhLgogICAgLSBmaWx0ZXJfdmFsdWVzIChk
aWN0KTogRGljdGlvbmFyeSB3aXRoIGZpbHRlciB2YWx1ZXMgZm9yIGNvbHVtbnMuCgogICAgUmV0
dXJuczoKICAgIC0gc3RyOiBXSEVSRSBjbGF1c2UgZm9yIG5vbi10ZXh0IGZpbHRlcnMuCiAgICAi
IiIKICAgIGNsYXVzZXMgPSBbXQogICAgZm9yIGNvbHVtbl9uYW1lLCB2YWx1ZSBpbiBmaWx0ZXJf
dmFsdWVzLml0ZW1zKCk6CgogICAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgICAgIGNv
bnRpbnVlCgogICAgICAgICMgR2V0dGluZyB0aGUgY29sdW1uIGZyb20gdGhlIGRhdGFmcmFtZQog
ICAgICAgIGNvbHVtbl9kZiA9IGRmW2RmWydDT0xVTU5fTkFNRSddID09IGNvbHVtbl9uYW1lXQoK
ICAgICAgICBpZiBub3QgY29sdW1uX2RmLmVtcHR5OgogICAgICAgICAgICByb3cgPSBjb2x1bW5f
ZGYuaWxvY1swXQogICAgICAgICAgICBmaWx0ZXJfdHlwZSA9IHJvd1snRklMVEVSX1RZUEUnXQoK
ICAgICAgICAgICAgaWYgZmlsdGVyX3R5cGUgPT0gImRyb3Bkb3duIjoKICAgICAgICAgICAgICAg
IGlmIHZhbHVlICE9ICIiOgogICAgICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2Nv
bHVtbl9uYW1lfSA9ICd7dmFsdWV9JyIpCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09
ICJtdWx0aS1zZWxlY3QgZHJvcGRvd24iOgogICAgICAgICAgICAgICAgaWYgdmFsdWU6CiAgICAg
ICAgICAgICAgICAgICAgIyBGaWx0ZXIgb3V0IGVtcHR5IHN0cmluZ3MKICAgICAgICAgICAgICAg
ICAgICBmaWx0ZXJlZF92YWx1ZXMgPSBbdiBmb3IgdiBpbiB2YWx1ZSBpZiB2ICE9ICIiXQogICAg
ICAgICAgICAgICAgICAgIGlmIGZpbHRlcmVkX3ZhbHVlczoKICAgICAgICAgICAgICAgICAgICAg
ICAgdmFsdWVzX3N0ciA9ICcsICcuam9pbihbZiIne3Z9JyIgZm9yIHYgaW4gZmlsdGVyZWRfdmFs
dWVzXSkKICAgICAgICAgICAgICAgICAgICAgICAgY2xhdXNlID0gZiJ7Y29sdW1uX25hbWV9IElO
ICh7dmFsdWVzX3N0cn0pIgogICAgICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChj
bGF1c2UpCgogICAgICAgICAgICBlbGlmIGZpbHRlcl90eXBlID09ICJib29sZWFuIGZpbHRlciI6
CiAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0gPSB7dmFsdWV9
IikKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5cGUgPT0gInNsaWRlciIgb3IgZmlsdGVyX3R5
cGUgPT0gInJhbmdlIGZpbHRlciI6CiAgICAgICAgICAgICAgICBtaW5fdmFsLCBtYXhfdmFsID0g
dmFsdWUKICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbl9uYW1lfSBCRVRX
RUVOIHttaW5fdmFsfSBBTkQge21heF92YWx9IikKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5
cGUgPT0gImFkdmFuY2VkIGRhdGUgZmlsdGVyIjoKICAgICAgICAgICAgICAgIGNvbmRpdGlvbiA9
IHZhbHVlLmdldCgiY29uZGl0aW9uIikKICAgICAgICAgICAgICAgIGlmIGNvbmRpdGlvbiA9PSAi
YmV0d2VlbiI6CiAgICAgICAgICAgICAgICAgICAgc3RhcnRfZGF0ZSwgZW5kX2RhdGUgPSB2YWx1
ZS5nZXQoInZhbHVlMSIpLCB2YWx1ZS5nZXQoInZhbHVlMiIpCiAgICAgICAgICAgICAgICAgICAg
Y2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9IEJFVFdFRU4gJ3tzdGFydF9kYXRlfScgQU5E
ICd7ZW5kX2RhdGV9JyIpCiAgICAgICAgICAgICAgICBlbGlmIGNvbmRpdGlvbiA9PSAiZ3JlYXRl
ciB0aGFuIG9yIGVxdWFsIjoKICAgICAgICAgICAgICAgICAgICBkYXRlX3ZhbCA9IHZhbHVlLmdl
dCgidmFsdWUiKQogICAgICAgICAgICAgICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbl9u
YW1lfSA+PSAne2RhdGVfdmFsfSciKQogICAgICAgICAgICAgICAgZWxpZiBjb25kaXRpb24gPT0g
Imxlc3MgdGhhbiBvciBlcXVhbCI6CiAgICAgICAgICAgICAgICAgICAgZGF0ZV92YWwgPSB2YWx1
ZS5nZXQoInZhbHVlIikKICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1
bW5fbmFtZX0gPD0gJ3tkYXRlX3ZhbH0nIikKCiAgICAgICAgICAgIGVsaWYgZmlsdGVyX3R5cGUg
PT0gJ2RhdGUgZmlsdGVyJzoKICAgICAgICAgICAgICAgIG1pbl9kYXRlLCBtYXhfZGF0ZSA9IHZh
bHVlCiAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5fbmFtZX0gQkVUV0VF
TiAne21pbl9kYXRlfScgQU5EICd7bWF4X2RhdGV9JyIpCgogICAgICAgICAgICBlbGlmIGZpbHRl
cl90eXBlID09ICJhZHZhbmNlZCBudW1lcmljIGZpbHRlciI6CiAgICAgICAgICAgICAgICBjb25k
aXRpb24gPSB2YWx1ZS5nZXQoImNvbmRpdGlvbiIpCiAgICAgICAgICAgICAgICBpZiBjb25kaXRp
b24gPT0gImJldHdlZW4iOgogICAgICAgICAgICAgICAgICAgIG1pbl92YWwsIG1heF92YWwgPSB2
YWx1ZS5nZXQoInZhbHVlMSIpLCB2YWx1ZS5nZXQoInZhbHVlMiIpCiAgICAgICAgICAgICAgICAg
ICAgY2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9IEJFVFdFRU4ge21pbl92YWx9IEFORCB7
bWF4X3ZhbH0iKQogICAgICAgICAgICAgICAgZWxpZiBjb25kaXRpb24gPT0gImdyZWF0ZXIgdGhh
biI6CiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsdWUuZ2V0KCJ2YWx1ZSIpCiAgICAgICAg
ICAgICAgICAgICAgY2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9ID4ge3ZhbH0iKQogICAg
ICAgICAgICAgICAgZWxpZiBjb25kaXRpb24gPT0gImxlc3MgdGhhbiI6CiAgICAgICAgICAgICAg
ICAgICAgdmFsID0gdmFsdWUuZ2V0KCJ2YWx1ZSIpCiAgICAgICAgICAgICAgICAgICAgY2xhdXNl
cy5hcHBlbmQoZiJ7Y29sdW1uX25hbWV9IDwge3ZhbH0iKQogICAgICAgICAgICAgICAgZWxpZiBj
b25kaXRpb24gPT0gImVxdWFsIHRvIjoKICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWx1ZS5n
ZXQoInZhbHVlIikKICAgICAgICAgICAgICAgICAgICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW5f
bmFtZX0gPSB7dmFsfSIpCgogICAgcmV0dXJuICIgQU5EICIuam9pbihjbGF1c2VzKQoKCmRlZiBn
ZW5fd2hlcmVfY2xhdXNlX2Zvcl90ZXh0X2ZpbHRlcihjb25kaXRpb25zKToKICAgICIiIgogICAg
R2VuZXJhdGUgV0hFUkUgY2xhdXNlIGZvciB0ZXh0IGZpbHRlcnMuCgogICAgUGFyYW1ldGVyczoK
ICAgIC0gY29uZGl0aW9ucyAoZGljdCk6IERpY3Rpb25hcnkgd2l0aCB0ZXh0IGZpbHRlciBjb25k
aXRpb25zLgoKICAgIFJldHVybnM6CiAgICAtIHN0cjogV0hFUkUgY2xhdXNlIGZvciB0ZXh0IGZp
bHRlcnMuCiAgICAiIiIKICAgIHdoZXJlX2NsYXVzZXMgPSBbXQogICAgZm9yIGNvbHVtbiwgKGNv
bmRpdGlvbl90dXBsZXMsIGxvZ2ljYWxfb3BlcmF0b3IpIGluIGNvbmRpdGlvbnMuaXRlbXMoKToK
ICAgICAgICBjbGF1c2VzID0gW10KICAgICAgICBmb3IgY29uZGl0aW9uX3R5cGUsIGNvbmRpdGlv
bl92YWx1ZSBpbiBjb25kaXRpb25fdHVwbGVzOgogICAgICAgICAgICBpZiBjb25kaXRpb25fdHlw
ZSA9PSAiQ29udGFpbnMiOgogICAgICAgICAgICAgICAgY2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1u
fSBMSUtFICcle2NvbmRpdGlvbl92YWx1ZX0lJyIpCiAgICAgICAgICAgIGVsaWYgY29uZGl0aW9u
X3R5cGUgPT0gIkRvZXMgbm90IGNvbnRhaW4iOgogICAgICAgICAgICAgICAgY2xhdXNlcy5hcHBl
bmQoZiJ7Y29sdW1ufSBOT1QgTElLRSAnJXtjb25kaXRpb25fdmFsdWV9JSciKQogICAgICAgICAg
ICBlbGlmIGNvbmRpdGlvbl90eXBlID09ICJFcXVhbHMiOgogICAgICAgICAgICAgICAgY2xhdXNl
cy5hcHBlbmQoZiJ7Y29sdW1ufSA9ICd7Y29uZGl0aW9uX3ZhbHVlfSciKQogICAgICAgICAgICBl
bGlmIGNvbmRpdGlvbl90eXBlID09ICJEb2VzIG5vdCBlcXVhbCI6CiAgICAgICAgICAgICAgICBj
bGF1c2VzLmFwcGVuZChmIntjb2x1bW59ICE9ICd7Y29uZGl0aW9uX3ZhbHVlfSciKQogICAgICAg
ICAgICBlbGlmIGNvbmRpdGlvbl90eXBlID09ICJCZWdpbnMgd2l0aCI6CiAgICAgICAgICAgICAg
ICBjbGF1c2VzLmFwcGVuZChmIntjb2x1bW59IExJS0UgJ3tjb25kaXRpb25fdmFsdWV9JSciKQog
ICAgICAgICAgICBlbGlmIGNvbmRpdGlvbl90eXBlID09ICJFbmRzIHdpdGgiOgogICAgICAgICAg
ICAgICAgY2xhdXNlcy5hcHBlbmQoZiJ7Y29sdW1ufSBMSUtFICcle2NvbmRpdGlvbl92YWx1ZX0l
JyIpCiAgICAgICAgICAgIGVsaWYgY29uZGl0aW9uX3R5cGUgPT0gIkJsYW5rIjoKICAgICAgICAg
ICAgICAgIGNsYXVzZXMuYXBwZW5kKGYie2NvbHVtbn0gSVMgTlVMTCIpCiAgICAgICAgICAgIGVs
aWYgY29uZGl0aW9uX3R5cGUgPT0gIk5vdCBibGFuayI6CiAgICAgICAgICAgICAgICBjbGF1c2Vz
LmFwcGVuZChmIntjb2x1bW59IElTIE5PVCBOVUxMIikKCiAgICAgICAgaWYgY2xhdXNlczoKICAg
ICAgICAgICAgd2hlcmVfY2xhdXNlcy5hcHBlbmQoZiIgKHtmJyB7bG9naWNhbF9vcGVyYXRvcn0g
Jy5qb2luKGNsYXVzZXMpfSkgIikKCiAgICB3aGVyZV9jbGF1c2UgPSAiIEFORCAiLmpvaW4od2hl
cmVfY2xhdXNlcykgaWYgd2hlcmVfY2xhdXNlcyBlbHNlICIiCgogICAgcmV0dXJuIHdoZXJlX2Ns
YXVzZSBpZiB3aGVyZV9jbGF1c2UgZWxzZSAidHJ1ZSIKCgpjbGFzcyBFeGlzdGluZ0NvaG9ydHM6
CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5oZWFkZXJfYmdfY29sb3IgPSAi
IzM3NDc0ZiIKICAgICAgICBzZWxmLmNhcmRfYmdfY29sb3IgPSAiI2VjZWZmMSIKICAgICAgICBz
ZWxmLnNldHVwX3BhZ2UoKQoKICAgIGRlZiBzZXR1cF9wYWdlKHNlbGYpOgogICAgICAgICMgU2V0
IHBhZ2UgY29uZmlndXJhdGlvbgogICAgICAgIHN0LnNldF9wYWdlX2NvbmZpZygKICAgICAgICAg
ICAgcGFnZV90aXRsZT0iRXhpc3RpbmcgQ29ob3J0cyIsCiAgICAgICAgICAgIHBhZ2VfaWNvbj0i
8J+TpiIsCiAgICAgICAgICAgIGxheW91dD0id2lkZSIsCiAgICAgICAgICAgIGluaXRpYWxfc2lk
ZWJhcl9zdGF0ZT0iZXhwYW5kZWQiCiAgICAgICAgKQoKICAgIGRlZiByZW5kZXJfaGVhZGVyKHNl
bGYpOgogICAgICAgICIiIgogICAgICAgIFJlbmRlciB0aGUgaGVhZGVyIHNlY3Rpb24gb2YgdGhl
IGFwcCB3aXRoIGN1c3RvbSBzdHlsaW5nLgogICAgICAgICIiIgogICAgICAgIHN0Lm1hcmtkb3du
KCIiIgogICAgICAgICAgICA8c3R5bGU+CiAgICAgICAgICAgIC5oZWFkZXIgewogICAgICAgICAg
ICAgICAgZm9udC1zaXplOiAzMnB4OwogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsK
ICAgICAgICAgICAgICAgIGNvbG9yOiAjODdjZWViOwogICAgICAgICAgICAgICAgZGlzcGxheTog
ZmxleDsKICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIH0K
ICAgICAgICAgICAgLmhlYWRlciBpbWcgewogICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAx
MHB4OwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5kZXNjcmlwdGlvbiB7CiAgICAgICAgICAg
ICAgICBjb2xvcjogI2VkZThlODsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDsKICAg
ICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgICAgICB9CiAgICAgICAgICAg
IC5ob3Jpem9udGFsLWxpbmUgewogICAgICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAg
ICAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogI2U2ZTZm
YTsKICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDBweDsKICAgICAgICAgICAgICAgIG1hcmdp
bi1ib3R0b206IDIwcHg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGl2W2RhdGEtdGVzdGlk
PSJzdEV4cGFuZGVyIl0gIHsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNCRkM4
QUQ7ICAvKiBTZXQgeW91ciBkZXNpcmVkIGNvbG9yICovCiAgICAgICAgICAgICAgICBjb2xvcjog
d2hpdGU7ICAvKiBTZXQgdGV4dCBjb2xvciBpZiBuZWVkZWQgKi8KICAgICAgICAgICAgICAgIGJv
cmRlcjogbm9uZTsgIC8qIE9wdGlvbmFsOiByZW1vdmUgYm9yZGVyICovCiAgICAgICAgICAgIH0K
ICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAgICAgIiIiLCB1bnNhZmVfYWxsb3dfaHRtbD1U
cnVlKQoKICAgICAgICBzdC5tYXJrZG93bigiIiIKICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVh
ZGVyIj4KICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPWZvbnQtd2VpZ2h0OiBib2xkOyI+RXhp
c3RpbmcgQ29ob3J0czwvc3Bhbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxociBj
bGFzcz0iaG9yaXpvbnRhbC1saW5lIi8+CiAgICAgICAgICAgIDxwIGNsYXNzPSJkZXNjcmlwdGlv
biI+CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAiIiIsIHVu
c2FmZV9hbGxvd19odG1sPVRydWUpCgogICAgZGVmIGxvYWRfZGF0YV9tb2RlbChzZWxmKToKCiAg
ICAgICAgIyAjIFNwbGl0IHRoZSB0YWJsZSBuYW1lIGJ5IHRoZSBwZXJpb2QgY2hhcmFjdGVyCiAg
ICAgICAgcGFydHMgPSBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3RhYmxlX2Z1bGwuc3BsaXQo
Jy4nKQoKICAgICAgICAjIEFzc2lnbiB0aGUgcGFydHMgdG8gdmFyaWFibGVzCiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9kYXRhYmFzZSwgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3Rl
ZF9zY2hlbWEsIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFibGUgPSBwYXJ0cwoKICAgICAg
ICBzdC5zZXNzaW9uX3N0YXRlLnByZXZfc2VsZWN0ZWRfZGF0YWJhc2UgPSBzdC5zZXNzaW9uX3N0
YXRlLnNlbGVjdGVkX2RhdGFiYXNlCiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5wcmV2X3NlbGVj
dGVkX3NjaGVtYSA9IHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfc2NoZW1hCiAgICAgICAgc3Qu
c2Vzc2lvbl9zdGF0ZS5wcmV2X3NlbGVjdGVkX3RhYmxlID0gc3Quc2Vzc2lvbl9zdGF0ZS5zZWxl
Y3RlZF90YWJsZQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnRhYmxlX2RhdGEgPSBmZXRjaF90
YWJsZV9kYXRhKHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbiwgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxl
Y3RlZF90YWJsZV9mdWxsKQogICAgICAgIHN0LnNlc3Npb25fc3RhdGUubWV0YWRhdGFfcmF3ID0g
Z2V0X3RhYmxlX21ldGFkYXRhKHN0LnNlc3Npb25fc3RhdGUuc2Vzc2lvbiwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNzaW9u
X3N0YXRlLnNlbGVjdGVkX3RhYmxlX2Z1bGwpCiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5tZXRh
ZGF0YV9yYXdbJ0lTX1BSSU1BUlknXSA9IEZhbHNlCiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5t
ZXRhZGF0YV9yYXdbJ0lTX1NFQ09OREFSWSddID0gRmFsc2UKICAgICAgICBzdC5zZXNzaW9uX3N0
YXRlLmRhdGFzZXQgPSBzdC5zZXNzaW9uX3N0YXRlLnRhYmxlX2RhdGFbMF0KICAgICAgICBzdC5z
ZXNzaW9uX3N0YXRlLmNvbF9saXN0ID0gc3Quc2Vzc2lvbl9zdGF0ZS5kYXRhc2V0LmNvbHVtbnMK
ICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnJvd19jb3VudCA9IHN0LnNlc3Npb25fc3RhdGUudGFi
bGVfZGF0YVsxXVswXQogICAgICAgIHN0LnNlc3Npb25fc3RhdGUudGFibGVfc2l6ZV9tYiA9IGZl
dGNoX3RhYmxlX3NpemUoc3Quc2Vzc2lvbl9zdGF0ZS5zZXNzaW9uLCBzdC5zZXNzaW9uX3N0YXRl
LnNlbGVjdGVkX2RhdGFiYXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9zY2hlbWEsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3RhYmxlKQogICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
ZHluYW1pY19yb3dfY291bnQgPSBzdC5zZXNzaW9uX3N0YXRlLnJvd19jb3VudAoKICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRhID0gc3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YV9yYXcK
CiAgICBkZWYgbG9hZF9kYXRhX2RpY3Rpb25hcnkoc2VsZik6CgogICAgICAgIHN0LnNlc3Npb25f
c3RhdGUucHJpbWFyeV9maWx0ZXJzX2RmID0gcHJvY2Vzc19jb2x1bW5zKAogICAgICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLnNlc3Npb24sCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUubWV0
YWRhdGFbc3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YVsiSVNfUFJJTUFSWSJdID09IFRydWVdWwog
ICAgICAgICAgICAgICAgWyJDT0xVTU5fTkFNRSIsICJEQVRBX1RZUEUiLCAiRklMVEVSX1RZUEUi
XV0KICAgICAgICApCgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV9maWx0ZXJzX2Rm
WyJJU19QUklNQVJZIl0gPSBUcnVlCgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5
X2ZpbHRlcnNfZGYgPSBzdC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRhWwogICAgICAgICAgICAoc3Qu
c2Vzc2lvbl9zdGF0ZS5tZXRhZGF0YVsiSVNfU0VDT05EQVJZIl0gPT0gVHJ1ZSkgJiAoc3Quc2Vz
c2lvbl9zdGF0ZS5tZXRhZGF0YVsiSVNfUFJJTUFSWSJdID09IEZhbHNlKQogICAgICAgICAgICBd
W1siQ09MVU1OX05BTUUiLCAiREFUQV9UWVBFIiwgIkZJTFRFUl9UWVBFIl1dCgogICAgICAgIHN0
LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGZbIklTX1BSSU1BUlkiXSA9IEZhbHNl
CiAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5leHBhbmRlcl9vcGVuID0gRmFsc2UgICMgQ2xvc2Ug
dGhlIGV4cGFuZGVyCgogICAgICAgIHNlbGYucmVzZXRfc2Vzc2lvbl9zdGF0ZXMoKQoKICAgICAg
ICBzdC5zZXNzaW9uX3N0YXRlLnNhdmVfY2hhbmdlc19wcmVzc2VkID0gVHJ1ZQoKICAgIGRlZiBs
b2FkX2J1aWxkX2NvaG9ydChzZWxmKToKCiAgICAgICAgdGVzdF9maWx0ZXIgPSBzdC5zZXNzaW9u
X3N0YXRlLmZpbHRlcl92YWx1ZXMKCiAgICAgICAgbm9uX3RleHRfZmlsdGVyc19jbGF1c2UgPSBn
ZW5fd2hlcmVfY2xhdXNlX2Zvcl9ub25fdGV4dF9maWx0ZXJzKAogICAgICAgICAgICBzdC5zZXNz
aW9uX3N0YXRlLnByaW1hcnlfZmlsdGVyc19kZiwKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0
ZS5maWx0ZXJfdmFsdWVzKQoKICAgICAgICB0ZXh0X2ZpbHRlcnNfY2xhdXNlID0gZ2VuX3doZXJl
X2NsYXVzZV9mb3JfdGV4dF9maWx0ZXIoc3Quc2Vzc2lvbl9zdGF0ZS50ZXh0X2ZpbHRlcl9jb25k
aXRpb25zKQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlY29uZGFyeV9maWx0ZXJzX2RmID0g
cHJvY2Vzc19jb2x1bW5zKAogICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlc3Npb24sCiAg
ICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcnNfZGYsCiAgICAgICAg
ICAgICIgQU5EICIgKyBub25fdGV4dF9maWx0ZXJzX2NsYXVzZSArICIgQU5EICIgKyB0ZXh0X2Zp
bHRlcnNfY2xhdXNlCiAgICAgICAgKQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmZpbHRlcl9k
ZiA9IHBkLmNvbmNhdCgKICAgICAgICAgICAgW3N0LnNlc3Npb25fc3RhdGUuc2Vjb25kYXJ5X2Zp
bHRlcnNfZGYsIHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV9maWx0ZXJzX2RmXSwgaWdub3JlX2lu
ZGV4PVRydWUpCgogICAgICAgIG5vbl90ZXh0X2ZpbHRlcnNfY2xhdXNlID0gZ2VuX3doZXJlX2Ns
YXVzZV9mb3Jfbm9uX3RleHRfZmlsdGVycygKICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5m
aWx0ZXJfZGYsCiAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmlsdGVyX3ZhbHVlcykKCiAg
ICAgICAgdGV4dF9maWx0ZXJzX2NsYXVzZSA9IGdlbl93aGVyZV9jbGF1c2VfZm9yX3RleHRfZmls
dGVyKHN0LnNlc3Npb25fc3RhdGUudGV4dF9maWx0ZXJfY29uZGl0aW9ucykKCiAgICAgICAgZmls
dGVyX2NsYXVzZSA9ICIgQU5EICIgKyBub25fdGV4dF9maWx0ZXJzX2NsYXVzZSArICIgQU5EICIg
KyB0ZXh0X2ZpbHRlcnNfY2xhdXNlCgogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmluYWxfcXVl
cnkgPSBzdC5zZXNzaW9uX3N0YXRlLmJhc2VfZmlsdGVyX3F1ZXJ5ICsgZmlsdGVyX2NsYXVzZQoK
ICAgICAgICBzZWxlY3RlZF9jb2x1bW5zID0gc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9jb2x1
bW5fbGlzdAoKICAgICAgICBpZiBsZW4oc2VsZWN0ZWRfY29sdW1ucykgPiAwOgogICAgICAgICAg
ICBmaW5hbF9xdWVyeSA9IHN0cihzdC5zZXNzaW9uX3N0YXRlLmZpbmFsX3F1ZXJ5KS5yZXBsYWNl
KAogICAgICAgICAgICAgICAgJ0NPVU5UKCopJywKICAgICAgICAgICAgICAgICIsICIuam9pbiht
YXAoc3RyLCBzZWxlY3RlZF9jb2x1bW5zKSkKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAg
ICAgICAgICAgIGZpbmFsX3F1ZXJ5ID0gc3Quc2Vzc2lvbl9zdGF0ZS5maW5hbF9xdWVyeS5yZXBs
YWNlKAogICAgICAgICAgICAgICAgJ0NPVU5UKCopJywKICAgICAgICAgICAgICAgICcqJwogICAg
ICAgICAgICApCgogICAgICAgIHN0LmNvZGUoZm9ybWF0X3NxbChmaW5hbF9xdWVyeSkpCgogICAg
ICAgIHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X3Jvd19jb3VudCA9IHJlYWRfc3FsKAogICAgICAg
ICAgICBzdC5zZXNzaW9uX3N0YXRlLmZpbmFsX3F1ZXJ5LAogICAgICAgICAgICBzdC5zZXNzaW9u
X3N0YXRlLnNlc3Npb24sCiAgICAgICAgICAgIDAKICAgICAgICApWzBdCgogICAgICAgIHN0LnNl
c3Npb25fc3RhdGUucHJldmlld19kYXRhc2V0ID0gcmVhZF90YWJsZShmaW5hbF9xdWVyeSwgc3Qu
c2Vzc2lvbl9zdGF0ZS5zZXNzaW9uKQoKICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLmlzX2NvaG9y
dF9zYXZlZCA9IFRydWUKCiAgICBkZWYgcmVuZGVyX21haW5fY29udGVudChzZWxmKToKCiAgICAg
ICAgIyBGdW5jdGlvbiB0byBoYW5kbGUgY29udmVyc2lvbiBiYXNlZCBvbiBGSUxURVJfVFlQRQog
ICAgICAgIGRlZiBjb252ZXJ0X2ZpbHRlcl92YWx1ZXMoZmlsdGVyX3ZhbHVlLCBmaWx0ZXJfdHlw
ZSk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICMgQ29udmVydCB0byB0dXBsZSBp
ZiBGSUxURVJfVFlQRSBpcyAnZGF0ZSBmaWx0ZXInCiAgICAgICAgICAgICAgICBpZiBmaWx0ZXJf
dHlwZSA9PSAnZGF0ZSBmaWx0ZXInOgogICAgICAgICAgICAgICAgICAgICMgUmVtb3ZlIHVubmVj
ZXNzYXJ5IGNoYXJhY3RlcnMgZnJvbSB0aGUgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgY2xl
YW5fc3RyaW5nID0gZmlsdGVyX3ZhbHVlLnN0cmlwKClbMTotMV0KICAgICAgICAgICAgICAgICAg
ICAjIENvbnZlcnQgdGhlIHN0cmluZyB0byBhIHR1cGxlIG9mIGRhdGV0aW1lLmRhdGUgb2JqZWN0
cwogICAgICAgICAgICAgICAgICAgIGV2YWx1YXRlZCA9IGV2YWwoY2xlYW5fc3RyaW5nKQogICAg
ICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKGZpbHRlcl92YWx1ZSwgc3RyKToKICAgICAgICAg
ICAgICAgICAgICBldmFsdWF0ZWQgPSBhc3QubGl0ZXJhbF9ldmFsKGZpbHRlcl92YWx1ZSkKICAg
ICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgZXZhbHVhdGVkID0gZmlsdGVy
X3ZhbHVlCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXJf
dmFsdWUKICAgICAgICAgICAgcmV0dXJuIGV2YWx1YXRlZAoKICAgICAgICBxdWVyeSA9ICJTRUxF
Q1QgKiBGUk9NIENPSE9SVF9CVUlMREVSX0ZPUl9TTk9XRkxBS0UuQVBQLkNPSE9SVFM7IgogICAg
ICAgIGNvaG9ydHNfZGF0YSA9IHJlYWRfdGFibGUocXVlcnksIHN0LnNlc3Npb25fc3RhdGUuc2Vz
c2lvbikKCiAgICAgICAgZXhpc3RpbmdfY29ob3J0cyA9IGNvaG9ydHNfZGF0YVsiQ09IT1JUX05B
TUUiXS50b19saXN0KCkKCiAgICAgICAgc2VsZWN0ZWRfY29ob3J0ID0gc3Quc2VsZWN0Ym94KCJT
ZWxlY3QgQ29ob3J0OiIsIGV4aXN0aW5nX2NvaG9ydHMsIGluZGV4PU5vbmUpCgogICAgICAgIGlm
IHN0LmJ1dHRvbigiTG9hZCBDb2hvcnQiKToKCiAgICAgICAgICAgIHNlbGYucmVzZXRfc2Vzc2lv
bl9zdGF0ZXMoKQoKICAgICAgICAgICAgd2l0aCBzdC5zcGlubmVyKCJQbGVhc2Ugd2FpdC4uLiIp
OgoKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuY29ob3J0X25hbWUgPSBzZWxlY3Rl
ZF9jb2hvcnQKCiAgICAgICAgICAgICAgICBzZWxlY3RlZF9jb2hvcnRfZGF0YSA9IGNvaG9ydHNf
ZGF0YVtjb2hvcnRzX2RhdGFbIkNPSE9SVF9OQU1FIl0gPT0gc2VsZWN0ZWRfY29ob3J0XQoKICAg
ICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUuc2VsZWN0ZWRfdGFibGVfZnVsbCA9IHNlbGVj
dGVkX2NvaG9ydF9kYXRhWyJUQUJMRV9OQU1FIl0uaWxvY1swXQoKICAgICAgICAgICAgICAgIHNl
bGYubG9hZF9kYXRhX21vZGVsKCkKCiAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNl
bGVjdGVkX2NvbHVtbl9saXN0ID0gYXN0LmxpdGVyYWxfZXZhbChzZWxlY3RlZF9jb2hvcnRfZGF0
YVsiQ09MVU1OX0xJU1QiXS5pbG9jWzBdKQoKICAgICAgICAgICAgICAgIGlmIGxlbihzdC5zZXNz
aW9uX3N0YXRlLmNvbF9saXN0LnRvX2xpc3QoKSkgIT0gbGVuKHN0LnNlc3Npb25fc3RhdGUuc2Vs
ZWN0ZWRfY29sdW1uX2xpc3QpOgogICAgICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUu
c2VsZWN0ZWRfY29sdW1uX2xpc3QgPSBhc3QubGl0ZXJhbF9ldmFsKAogICAgICAgICAgICAgICAg
ICAgICAgICBzZWxlY3RlZF9jb2hvcnRfZGF0YVsiQ09MVU1OX0xJU1QiXS5pbG9jWzBdKQoKICAg
ICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5z
ZWxlY3RlZF9jb2x1bW5fbGlzdCA9IFtdCgogICAgICAgICAgICAgICAgZmlsdGVyX3ZhbHVlcyA9
IGpzb24ubG9hZHMoanNvbi5sb2FkcyhzZWxlY3RlZF9jb2hvcnRfZGF0YVsiQ09IT1JUX1NFTEVD
VElPTlNfSlNPTiJdLmlsb2NbMF0pKQoKICAgICAgICAgICAgICAgIGZvciBmaWx0ZXIgaW4gZmls
dGVyX3ZhbHVlczoKICAgICAgICAgICAgICAgICAgICBjb2x1bW5fbmFtZSA9IGZpbHRlclsiQ09M
VU1OX05BTUUiXQogICAgICAgICAgICAgICAgICAgIGlzX3ByaW1hcnkgPSBmaWx0ZXJbIklTX1BS
SU1BUlkiXQogICAgICAgICAgICAgICAgICAgIGZpbHRlcl90eXBlID0gZmlsdGVyWyJGSUxURVJf
VFlQRSJdCgogICAgICAgICAgICAgICAgICAgICMgQ2hlY2sgaWYgdGhlIGNvbHVtbiBleGlzdHMg
aW4gdGhlIERhdGFGcmFtZQogICAgICAgICAgICAgICAgICAgIGlmIGNvbHVtbl9uYW1lIGluIHN0
LnNlc3Npb25fc3RhdGUubWV0YWRhdGFbJ0NPTFVNTl9OQU1FJ10udmFsdWVzOgogICAgICAgICAg
ICAgICAgICAgICAgICBpZiBpc19wcmltYXJ5IGlzIFRydWU6CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRhLmxvY1sKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLm1ldGFkYXRhWydDT0xVTU5fTkFNRSddID09
IGNvbHVtbl9uYW1lLCAnSVNfUFJJTUFSWSddID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAg
ICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5tZXRh
ZGF0YS5sb2NbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0
ZS5tZXRhZGF0YVsnQ09MVU1OX05BTUUnXSA9PSBjb2x1bW5fbmFtZSwgJ0lTX1NFQ09OREFSWSdd
ID0gVHJ1ZQoKICAgICAgICAgICAgICAgICAgICAgICAgc3Quc2Vzc2lvbl9zdGF0ZS5tZXRhZGF0
YS5sb2NbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLm1ldGFk
YXRhWydDT0xVTU5fTkFNRSddID09IGNvbHVtbl9uYW1lLCAnRklMVEVSX1RZUEUnXSA9IGZpbHRl
cl90eXBlCgogICAgICAgICAgICAgICAgc2VsZi5sb2FkX2RhdGFfZGljdGlvbmFyeSgpCgogICAg
ICAgICAgICAgICAgIyBDcmVhdGUgdGhlIGRpY3Rpb25hcnkKICAgICAgICAgICAgICAgIGZpbHRl
cl9kaWN0ID0ge30KICAgICAgICAgICAgICAgIHRleHRfZmlsdGVyX2NvbmRpdGlvbnMgPSB7fQog
ICAgICAgICAgICAgICAgZmlsdGVyX3ZhbHVlc19kZiA9IHBkLkRhdGFGcmFtZShmaWx0ZXJfdmFs
dWVzKQogICAgICAgICAgICAgICAgZmlsdGVyX3ZhbHVlc19kZlsnSVNfUFJJTUFSWSddID0gZmls
dGVyX3ZhbHVlc19kZlsnSVNfUFJJTUFSWSddLmZpbGxuYShGYWxzZSkKICAgICAgICAgICAgICAg
IGZvciBpbmRleCwgcm93IGluIGZpbHRlcl92YWx1ZXNfZGYuaXRlcnJvd3MoKToKICAgICAgICAg
ICAgICAgICAgICBpZiByb3dbIkZJTFRFUl9UWVBFIl0gPT0gJ3RleHQgZmlsdGVyJzoKICAgICAg
ICAgICAgICAgICAgICAgICAgdGV4dF9maWx0ZXJfY29uZGl0aW9uc1tyb3dbJ0NPTFVNTl9OQU1F
J11dID0gY29udmVydF9maWx0ZXJfdmFsdWVzKHJvd1siRklMVEVSX1ZBTFVFUyJdLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93WyJGSUxURVJfVFlQRSJdKQogICAgICAgICAg
ICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcl9kaWN0W3Jvd1sn
Q09MVU1OX05BTUUnXV0gPSBjb252ZXJ0X2ZpbHRlcl92YWx1ZXMocm93WyJGSUxURVJfVkFMVUVT
Il0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93WyJGSUxURVJfVFlQRSJdKQoKICAgICAgICAg
ICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmlsdGVyX3ZhbHVlcyA9IGZpbHRlcl9kaWN0CiAgICAg
ICAgICAgICAgICBzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX2ZpbHRlcnMgPSBzdC5zZXNzaW9u
X3N0YXRlLmZpbHRlcl92YWx1ZXMKICAgICAgICAgICAgICAgIHN0LnNlc3Npb25fc3RhdGUudGV4
dF9maWx0ZXJfY29uZGl0aW9ucyA9IHRleHRfZmlsdGVyX2NvbmRpdGlvbnMKCiAgICAgICAgICAg
ICAgICBzZWxmLmxvYWRfYnVpbGRfY29ob3J0KCkKICAgICAgICAgICAgICAgIHN0LnN1Y2Nlc3Mo
Ik1ldGFkYXRhIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuIikKCiAgICBkZWYgcmVzZXRfc2Vzc2lv
bl9zdGF0ZXMoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgUmVzZXQgc3BlY2lmaWMgc2Vzc2lv
biBzdGF0ZXMgYWZ0ZXIgc2F2aW5nIGNoYW5nZXMuCiAgICAgICAgIiIiCiAgICAgICAgc3Quc2Vz
c2lvbl9zdGF0ZS5maWx0ZXJfdmFsdWVzID0ge30KICAgICAgICAjICNOb3QgYmVpbmcgdXNlZD8K
ICAgICAgICAjIHN0LnNlc3Npb25fc3RhdGUucHJpbWFyeV93aGVyZV9jbGF1c2UgPSAnJwogICAg
ICAgICMgI05vdCBiZWluZyB1c2VkPwogICAgICAgICMgc3Quc2Vzc2lvbl9zdGF0ZS5maW5hbF93
aGVyZV9jbGF1c2UgPSAnJwogICAgICAgICMgc3Quc2Vzc2lvbl9zdGF0ZS50ZXh0X2ZpbHRlcl9j
b25kaXRpb25zID0ge30KICAgICAgICAjICNOb3QgYmVpbmcgdXNlZD8KICAgICAgICAjIHN0LnNl
c3Npb25fc3RhdGUuc2Vjb25kYXJ5X2ZpbHRlcl92YWx1ZXMgPSB7fQogICAgICAgIHN0LnNlc3Np
b25fc3RhdGUuc2hvd19zZWNvbmRhcnlfZmlsdGVycyA9IFRydWUKICAgICAgICAjICNzdC5zZXNz
aW9uX3N0YXRlLmNvaG9ydF9yb3dfY291bnQgPSBzdC5zZXNzaW9uX3N0YXRlLnJvd19jb3VudAog
ICAgICAgIHN0LnNlc3Npb25fc3RhdGUuYmFzZV9maWx0ZXJfcXVlcnkgPSBmJ1NFTEVDVCBDT1VO
VCgqKSBGUk9NIHtzdC5zZXNzaW9uX3N0YXRlLnNlbGVjdGVkX3RhYmxlX2Z1bGx9IFdIRVJFIHRy
dWUgJwogICAgICAgIHN0LnNlc3Npb25fc3RhdGUuZmluYWxfcXVlcnkgPSAnJywKICAgICAgICBz
dC5zZXNzaW9uX3N0YXRlLnNhdmVfY2hhbmdlc19wcmVzc2VkID0gVHJ1ZQogICAgICAgICNzdC5z
ZXNzaW9uX3N0YXRlLmNvbF9saXN0ID0gc3Quc2Vzc2lvbl9zdGF0ZS5kYXRhc2V0LmNvbHVtbnMK
ICAgICAgICAjc3Quc2Vzc2lvbl9zdGF0ZS5zZWxlY3RlZF9jb2x1bW5fbGlzdCA9ICBzdC5zZXNz
aW9uX3N0YXRlLmNvbF9saXN0ICMgVHJhY2sgaWYgc2F2ZSBjaGFuZ2VzIGlzIHByZXNzZWQKCiAg
ICAgICAgI3NlbGYucmVzZXRfc2Vzc2lvbl9zdGF0ZXNfZm9yX2J1aWxkX2NvaG9ydCgpCgogICAg
ZGVmIHJ1bihzZWxmKToKICAgICAgICAiIiIKICAgICAgICBNYWluIG1ldGhvZCB0byBydW4gdGhl
IGFwcGxpY2F0aW9uLgogICAgICAgICIiIgogICAgICAgIHNlbGYucmVuZGVyX2hlYWRlcigpCiAg
ICAgICAgc2VsZi5yZW5kZXJfbWFpbl9jb250ZW50KCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWlu
X18iOgogICAgYXBwID0gRXhpc3RpbmdDb2hvcnRzKCkKICAgIGFwcC5ydW4oKQqUdXUu
